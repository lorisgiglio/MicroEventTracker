import{A as Eu,B as JC,C as eT,D as tT,E as Gr,F as Fn,a as j,b as ce,c as cm,d as x,e as qC,f as ld,g as zC,h as GC,i as WC,j as lm,k as dm,l as fm,m as KC,n as QC,o as YC,p as _u,q as hm,r as pm,s as dd,t as ZC,u as XC,v as fd,w as je,x as zi,y as kn,z as hd}from"./chunk-FSP26GKC.js";var gm;function pd(){return gm}function Vn(n){let e=gm;return gm=n,e}var nT=Symbol("NotFound");function Jo(n){return n===nT||n?.name==="\u0275NotFound"}var _t=null,gd=!1,mm=1,YO=null,Et=Symbol("SIGNAL");function ue(n){let e=_t;return _t=n,e}function _d(){return _t}var es={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ts(n){if(gd)throw new Error("");if(_t===null)return;_t.consumerOnSignalRead(n);let e=_t.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=_t.recomputing;if(r&&(t=e!==void 0?e.nextProducer:_t.producers,t!==void 0&&t.producer===n)){_t.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===_t&&(!r||XO(i,_t)))return;let o=rs(_t),s={producer:n,consumer:_t,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};_t.producersTail=s,e!==void 0?e.nextProducer=s:_t.producers=s,o&&sT(n,s)}function rT(){mm++}function Ed(n){if(!(rs(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===mm)){if(!n.producerMustRecompute(n)&&!Du(n)){vd(n);return}n.producerRecomputeValue(n),vd(n)}}function ym(n){if(n.consumers===void 0)return;let e=gd;gd=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||ZO(r)}}finally{gd=e}}function vm(){return _t?.consumerAllowSignalWrites!==!1}function ZO(n){n.dirty=!0,ym(n),n.consumerMarkedDirty?.(n)}function vd(n){n.dirty=!1,n.lastCleanEpoch=mm}function ns(n){return n&&iT(n),ue(n)}function iT(n){n.producersTail=void 0,n.recomputing=!0}function wu(n,e){ue(e),n&&oT(n)}function oT(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(rs(n))do t=_m(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Du(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(Ed(t),r!==t.version))return!0}return!1}function Cu(n){if(rs(n)){let e=n.producers;for(;e!==void 0;)e=_m(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function sT(n,e){let t=n.consumersTail,r=rs(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)sT(i.producer,i)}function _m(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!rs(e)){let o=e.producers;for(;o!==void 0;)o=_m(o)}return t}function rs(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function Id(n){YO?.(n)}function XO(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function wd(n,e){return Object.is(n,e)}function Dd(n,e){let t=Object.create(JO);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(Ed(t),ts(t),t.value===Iu)throw t.error;return t.value};return r[Et]=t,Id(t),r}var md=Symbol("UNSET"),yd=Symbol("COMPUTING"),Iu=Symbol("ERRORED"),JO=ce(j({},es),{value:md,dirty:!0,error:null,equal:wd,kind:"computed",producerMustRecompute(n){return n.value===md||n.value===yd},producerRecomputeValue(n){if(n.value===yd)throw new Error("");let e=n.value;n.value=yd;let t=ns(n),r,i=!1;try{r=n.computation(),ue(null),i=e!==md&&e!==Iu&&r!==Iu&&n.equal(e,r)}catch(o){r=Iu,n.error=o}finally{wu(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function ek(){throw new Error}var aT=ek;function uT(n){aT(n)}function Em(n){aT=n}var tk=null;function Im(n,e){let t=Object.create(Cd);t.value=n,e!==void 0&&(t.equal=e);let r=()=>cT(t);return r[Et]=t,Id(t),[r,s=>is(t,s),s=>wm(t,s)]}function cT(n){return ts(n),n.value}function is(n,e){vm()||uT(n),n.equal(n.value,e)||(n.value=e,nk(n))}function wm(n,e){vm()||uT(n),is(n,e(n.value))}var Cd=ce(j({},es),{equal:wd,value:void 0,kind:"signal"});function nk(n){n.version++,rT(),ym(n),tk?.(n)}function re(n){return typeof n=="function"}function os(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Td=os(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Gi(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var He=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(re(r))try{r()}catch(o){e=o instanceof Td?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{lT(o)}catch(s){e=e??[],s instanceof Td?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Td(e)}}add(e){var t;if(e&&e!==this)if(this.closed)lT(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Gi(t,e)}remove(e){let{_finalizers:t}=this;t&&Gi(t,e),e instanceof n&&e._removeParent(this)}};He.EMPTY=(()=>{let n=new He;return n.closed=!0,n})();var Dm=He.EMPTY;function bd(n){return n instanceof He||n&&"closed"in n&&re(n.remove)&&re(n.add)&&re(n.unsubscribe)}function lT(n){re(n)?n():n.unsubscribe()}var _n={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ss={setTimeout(n,e,...t){let{delegate:r}=ss;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ss;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Sd(n){ss.setTimeout(()=>{let{onUnhandledError:e}=_n;if(e)e(n);else throw n})}function Tu(){}var dT=Cm("C",void 0,void 0);function fT(n){return Cm("E",void 0,n)}function hT(n){return Cm("N",n,void 0)}function Cm(n,e,t){return{kind:n,value:e,error:t}}var Wi=null;function as(n){if(_n.useDeprecatedSynchronousErrorHandling){let e=!Wi;if(e&&(Wi={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Wi;if(Wi=null,t)throw r}}else n()}function pT(n){_n.useDeprecatedSynchronousErrorHandling&&Wi&&(Wi.errorThrown=!0,Wi.error=n)}var Ki=class extends He{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,bd(e)&&e.add(this)):this.destination=ok}static create(e,t,r){return new dr(e,t,r)}next(e){this.isStopped?bm(hT(e),this):this._next(e)}error(e){this.isStopped?bm(fT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?bm(dT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},rk=Function.prototype.bind;function Tm(n,e){return rk.call(n,e)}var Sm=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Ad(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Ad(r)}else Ad(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ad(t)}}},dr=class extends Ki{constructor(e,t,r){super();let i;if(re(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&_n.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Tm(e.next,o),error:e.error&&Tm(e.error,o),complete:e.complete&&Tm(e.complete,o)}):i=e}this.destination=new Sm(i)}};function Ad(n){_n.useDeprecatedSynchronousErrorHandling?pT(n):Sd(n)}function ik(n){throw n}function bm(n,e){let{onStoppedNotification:t}=_n;t&&ss.setTimeout(()=>t(n,e))}var ok={closed:!0,next:Tu,error:ik,complete:Tu};var us=typeof Symbol=="function"&&Symbol.observable||"@@observable";function xt(n){return n}function Am(...n){return Rm(n)}function Rm(n){return n.length===0?xt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ie=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=ak(t)?t:new dr(t,r,i);return as(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=gT(r),new r((i,o)=>{let s=new dr({next:a=>{try{t(a)}catch(u){o(u),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[us](){return this}pipe(...t){return Rm(t)(this)}toPromise(t){return t=gT(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function gT(n){var e;return(e=n??_n.Promise)!==null&&e!==void 0?e:Promise}function sk(n){return n&&re(n.next)&&re(n.error)&&re(n.complete)}function ak(n){return n&&n instanceof Ki||sk(n)&&bd(n)}function Mm(n){return re(n?.lift)}function le(n){return e=>{if(Mm(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function de(n,e,t,r,i){return new Nm(n,e,t,r,i)}var Nm=class extends Ki{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function cs(){return le((n,e)=>{let t=null;n._refCount++;let r=de(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ls=class extends ie{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Mm(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new He;let t=this.getSubject();e.add(this.source.subscribe(de(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=He.EMPTY)}return e}refCount(){return cs()(this)}};var mT=os(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var xe=(()=>{class n extends ie{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Rd(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new mT}next(t){as(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){as(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){as(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Dm:(this.currentObservers=null,o.push(t),new He(()=>{this.currentObservers=null,Gi(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ie;return t.source=this,t}}return n.create=(e,t)=>new Rd(e,t),n})(),Rd=class extends xe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Dm}};var ut=class extends xe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var bu={now(){return(bu.delegate||Date).now()},delegate:void 0};var Su=class extends xe{constructor(e=1/0,t=1/0,r=bu){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let u=1;u<r.length&&r[u]<=s;u+=2)a=u;a&&r.splice(0,a+1)}}};var Md=class extends He{constructor(e,t){super()}schedule(e,t=0){return this}};var Au={setInterval(n,e,...t){let{delegate:r}=Au;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Au;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ds=class extends Md{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Au.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Au.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Gi(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var fs=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};fs.now=bu.now;var hs=class extends fs{constructor(e,t=fs.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Ru=new hs(ds);var Nd=class extends ds{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var xd=class extends hs{};var xm=new xd(Nd);var It=new ie(n=>n.complete());function yT(n){return n&&re(n.schedule)}function Pm(n){return n[n.length-1]}function Pd(n){return re(Pm(n))?n.pop():void 0}function Ln(n){return yT(Pm(n))?n.pop():void 0}function vT(n,e){return typeof Pm(n)=="number"?n.pop():e}var Od=n=>n&&typeof n.length=="number"&&typeof n!="function";function kd(n){return re(n?.then)}function Fd(n){return re(n[us])}function Vd(n){return Symbol.asyncIterator&&re(n?.[Symbol.asyncIterator])}function Ld(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function uk(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var jd=uk();function Bd(n){return re(n?.[jd])}function Ud(n){return zC(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ld(t.read());if(i)return yield ld(void 0);yield yield ld(r)}}finally{t.releaseLock()}})}function $d(n){return re(n?.getReader)}function Pe(n){if(n instanceof ie)return n;if(n!=null){if(Fd(n))return ck(n);if(Od(n))return lk(n);if(kd(n))return dk(n);if(Vd(n))return _T(n);if(Bd(n))return fk(n);if($d(n))return hk(n)}throw Ld(n)}function ck(n){return new ie(e=>{let t=n[us]();if(re(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lk(n){return new ie(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function dk(n){return new ie(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Sd)})}function fk(n){return new ie(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function _T(n){return new ie(e=>{pk(n,e).catch(t=>e.error(t))})}function hk(n){return _T(Ud(n))}function pk(n,e){var t,r,i,o;return qC(this,void 0,void 0,function*(){try{for(t=GC(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function Lt(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function jn(n,e=0){return le((t,r)=>{t.subscribe(de(r,i=>Lt(r,n,()=>r.next(i),e),()=>Lt(r,n,()=>r.complete(),e),i=>Lt(r,n,()=>r.error(i),e)))})}function fr(n,e=0){return le((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function ET(n,e){return Pe(n).pipe(fr(e),jn(e))}function IT(n,e){return Pe(n).pipe(fr(e),jn(e))}function wT(n,e){return new ie(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function DT(n,e){return new ie(t=>{let r;return Lt(t,e,()=>{r=n[jd](),Lt(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>re(r?.return)&&r.return()})}function Hd(n,e){if(!n)throw new Error("Iterable cannot be null");return new ie(t=>{Lt(t,e,()=>{let r=n[Symbol.asyncIterator]();Lt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function CT(n,e){return Hd(Ud(n),e)}function TT(n,e){if(n!=null){if(Fd(n))return ET(n,e);if(Od(n))return wT(n,e);if(kd(n))return IT(n,e);if(Vd(n))return Hd(n,e);if(Bd(n))return DT(n,e);if($d(n))return CT(n,e)}throw Ld(n)}function ve(n,e){return e?TT(n,e):Pe(n)}function Z(...n){let e=Ln(n);return ve(n,e)}function ps(n,e){let t=re(n)?n:()=>n,r=i=>i.error(t());return new ie(e?i=>e.schedule(r,0,i):r)}function Om(n){return!!n&&(n instanceof ie||re(n.lift)&&re(n.subscribe))}var hr=os(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function X(n,e){return le((t,r)=>{let i=0;t.subscribe(de(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:gk}=Array;function mk(n,e){return gk(e)?n(...e):n(e)}function qd(n){return X(e=>mk(n,e))}var{isArray:yk}=Array,{getPrototypeOf:vk,prototype:_k,keys:Ek}=Object;function zd(n){if(n.length===1){let e=n[0];if(yk(e))return{args:e,keys:null};if(Ik(e)){let t=Ek(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Ik(n){return n&&typeof n=="object"&&vk(n)===_k}function Gd(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Wd(...n){let e=Ln(n),t=Pd(n),{args:r,keys:i}=zd(n);if(r.length===0)return ve([],e);let o=new ie(wk(r,e,i?s=>Gd(i,s):xt));return t?o.pipe(qd(t)):o}function wk(n,e,t=xt){return r=>{bT(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let u=0;u<i;u++)bT(e,()=>{let l=ve(n[u],e),d=!1;l.subscribe(de(r,h=>{o[u]=h,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function bT(n,e,t){n?Lt(t,n,e):e()}function ST(n,e,t,r,i,o,s,a){let u=[],l=0,d=0,h=!1,g=()=>{h&&!u.length&&!l&&e.complete()},y=b=>l<r?I(b):u.push(b),I=b=>{o&&e.next(b),l++;let S=!1;Pe(t(b,d++)).subscribe(de(e,O=>{i?.(O),o?y(O):e.next(O)},()=>{S=!0},void 0,()=>{if(S)try{for(l--;u.length&&l<r;){let O=u.shift();s?Lt(e,s,()=>I(O)):I(O)}g()}catch(O){e.error(O)}}))};return n.subscribe(de(e,y,()=>{h=!0,g()})),()=>{a?.()}}function tt(n,e,t=1/0){return re(e)?tt((r,i)=>X((o,s)=>e(r,o,i,s))(Pe(n(r,i))),t):(typeof e=="number"&&(t=e),le((r,i)=>ST(r,i,n,t)))}function Kd(n=1/0){return tt(xt,n)}function AT(){return Kd(1)}function gs(...n){return AT()(ve(n,Ln(n)))}function Mu(n){return new ie(e=>{Pe(n()).subscribe(e)})}function km(...n){let e=Pd(n),{args:t,keys:r}=zd(n),i=new ie(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),u=s,l=s;for(let d=0;d<s;d++){let h=!1;Pe(t[d]).subscribe(de(o,g=>{h||(h=!0,l--),a[d]=g},()=>u--,void 0,()=>{(!u||!h)&&(l||o.next(r?Gd(r,a):a),o.complete())}))}});return e?i.pipe(qd(e)):i}function Fm(...n){let e=Ln(n),t=vT(n,1/0),r=n;return r.length?r.length===1?Pe(r[0]):Kd(t)(ve(r,e)):It}function ct(n,e){return le((t,r)=>{let i=0;t.subscribe(de(r,o=>n.call(e,o,i++)&&r.next(o)))})}function Wr(n){return le((e,t)=>{let r=null,i=!1,o;r=e.subscribe(de(t,void 0,void 0,s=>{o=Pe(n(s,Wr(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function RT(n,e,t,r,i){return(o,s)=>{let a=t,u=e,l=0;o.subscribe(de(s,d=>{let h=l++;u=a?n(u,d,h):(a=!0,d),r&&s.next(u)},i&&(()=>{a&&s.next(u),s.complete()})))}}function ms(n,e){return re(e)?tt(n,e,1):tt(n,1)}function Kr(n){return le((e,t)=>{let r=!1;e.subscribe(de(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function pr(n){return n<=0?()=>It:le((e,t)=>{let r=0;e.subscribe(de(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Vm(n,e=xt){return n=n??Dk,le((t,r)=>{let i,o=!0;t.subscribe(de(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function Dk(n,e){return n===e}function Qd(n=Ck){return le((e,t)=>{let r=!1;e.subscribe(de(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Ck(){return new hr}function Nu(n){return le((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function En(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ct((i,o)=>n(i,o,r)):xt,pr(1),t?Kr(e):Qd(()=>new hr))}function ys(n){return n<=0?()=>It:le((e,t)=>{let r=[];e.subscribe(de(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Lm(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ct((i,o)=>n(i,o,r)):xt,ys(1),t?Kr(e):Qd(()=>new hr))}function xu(){return le((n,e)=>{let t,r=!1;n.subscribe(de(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Qi(n,e){return le(RT(n,e,arguments.length>=2,!0))}function MT(n={}){let{connector:e=()=>new xe,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,u,l=0,d=!1,h=!1,g=()=>{a?.unsubscribe(),a=void 0},y=()=>{g(),s=u=void 0,d=h=!1},I=()=>{let b=s;y(),b?.unsubscribe()};return le((b,S)=>{l++,!h&&!d&&g();let O=u=u??e();S.add(()=>{l--,l===0&&!h&&!d&&(a=jm(I,i))}),O.subscribe(S),!s&&l>0&&(s=new dr({next:q=>O.next(q),error:q=>{h=!0,g(),a=jm(y,t,q),O.error(q)},complete:()=>{d=!0,g(),a=jm(y,r),O.complete()}}),Pe(b).subscribe(s))})(o)}}function jm(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new dr({next:()=>{r.unsubscribe(),n()}});return Pe(e(...t)).subscribe(r)}function Yd(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,MT({connector:()=>new Su(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Yi(...n){let e=Ln(n);return le((t,r)=>{(e?gs(n,t,e):gs(n,t)).subscribe(r)})}function ke(n,e){return le((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(de(r,u=>{i?.unsubscribe();let l=0,d=o++;Pe(n(u,d)).subscribe(i=de(r,h=>r.next(e?e(u,h,d,l++):h),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Zd(n,e){return re(e)?ke(()=>n,e):ke(()=>n)}function Xd(n){return le((e,t)=>{Pe(n).subscribe(de(t,()=>t.complete(),Tu)),!t.closed&&e.subscribe(t)})}function ot(n,e,t){let r=re(n)||e||t?{next:n,error:e,complete:t}:n;return r?le((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(de(o,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),o.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),o.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):xt}function NT(n){let e=ue(null);try{return n()}finally{ue(e)}}var nf="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",K=class extends Error{code;constructor(e,t){super(Zm(e,t)),this.code=e}};function Tk(n){return`NG0${Math.abs(n)}`}function Zm(n,e){return`${Tk(n)}${e?": "+e:""}`}var Fu=globalThis;function Ie(n){for(let e in n)if(n[e]===Ie)return e;throw Error("")}function OT(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function mr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(mr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Xm(n,e){return n?e?`${n} ${e}`:n:e||""}var bk=Ie({__forward_ref__:Ie});function vr(n){return n.__forward_ref__=vr,n.toString=function(){return mr(this())},n}function lt(n){return Jm(n)?n():n}function Jm(n){return typeof n=="function"&&n.hasOwnProperty(bk)&&n.__forward_ref__===vr}function kT(n,e,t){n!=e&&FT(t,n,e,"==")}function FT(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(r==null?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}function W(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function wn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Vu(n){return Sk(n,rf)}function ey(n){return Vu(n)!==null}function Sk(n,e){return n.hasOwnProperty(e)&&n[e]||null}function Ak(n){let e=n?.[rf]??null;return e||null}function Um(n){return n&&n.hasOwnProperty(ef)?n[ef]:null}var rf=Ie({\u0275prov:Ie}),ef=Ie({\u0275inj:Ie}),z=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=W({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function ty(n){return n&&!!n.\u0275providers}var ny=Ie({\u0275cmp:Ie}),ry=Ie({\u0275dir:Ie}),iy=Ie({\u0275pipe:Ie}),oy=Ie({\u0275mod:Ie}),Ou=Ie({\u0275fac:Ie}),no=Ie({__NG_ELEMENT_ID__:Ie}),xT=Ie({__NG_ENV_ID__:Ie});function _s(n){return typeof n=="string"?n:n==null?"":String(n)}function VT(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():_s(n)}var LT=Ie({ngErrorCode:Ie}),Rk=Ie({ngErrorMessage:Ie}),Mk=Ie({ngTokenPath:Ie});function sy(n,e){return jT("",-200,e)}function of(n,e){throw new K(-201,!1)}function jT(n,e,t){let r=new K(e,n);return r[LT]=e,r[Rk]=n,t&&(r[Mk]=t),r}function Nk(n){return n[LT]}var $m;function BT(){return $m}function Yt(n){let e=$m;return $m=n,e}function ay(n,e,t){let r=Vu(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;of(n,"Injector")}var xk={},Zi=xk,Pk="__NG_DI_FLAG__",Hm=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Xi(t)||0;try{return this.injector.get(e,r&8?null:Zi,r)}catch(i){if(Jo(i))return i;throw i}}};function Ok(n,e=0){let t=pd();if(t===void 0)throw new K(-203,!1);if(t===null)return ay(n,void 0,e);{let r=kk(e),i=t.retrieve(n,r);if(Jo(i)){if(r.optional)return null;throw i}return i}}function $(n,e=0){return(BT()||Ok)(lt(n),e)}function F(n,e){return $(n,Xi(e))}function Xi(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function kk(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function qm(n){let e=[];for(let t=0;t<n.length;t++){let r=lt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new K(900,!1);let i,o=0;for(let s=0;s<r.length;s++){let a=r[s],u=Fk(a);typeof u=="number"?u===-1?i=a.token:o|=u:i=a}e.push($(i,o))}else e.push($(r))}return e}function Fk(n){return n[Pk]}function Ji(n,e){let t=n.hasOwnProperty(Ou);return t?n[Ou]:null}function sf(n,e){n.forEach(t=>Array.isArray(t)?sf(t,e):e(t))}function uy(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Lu(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function UT(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function $T(n,e,t){let r=Es(n,e);return r>=0?n[r|1]=t:(r=~r,UT(n,r,e,t)),r}function af(n,e){let t=Es(n,e);if(t>=0)return n[t|1]}function Es(n,e){return Vk(n,e,1)}function Vk(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Yr={},jt=[],Zr=new z(""),cy=new z("",-1),ly=new z(""),ku=class{get(e,t=Zi){if(t===Zi){let i=jT("",-201);throw i.name="\u0275NotFound",i}return t}};function dy(n){return n[oy]||null}function Xr(n){return n[ny]||null}function fy(n){return n[ry]||null}function HT(n){return n[iy]||null}function uf(n){return{\u0275providers:n}}function qT(...n){return{\u0275providers:hy(!0,n),\u0275fromNgModule:!0}}function hy(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return sf(e,s=>{let a=s;tf(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&zT(i,o),t}function zT(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];py(i,o=>{e(o,r)})}}function tf(n,e,t,r){if(n=lt(n),!n)return!1;let i=null,o=Um(n),s=!o&&Xr(n);if(!o&&!s){let u=n.ngModule;if(o=Um(u),o)i=u;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of u)tf(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{sf(o.imports,d=>{tf(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&zT(l,e)}if(!a){let l=Ji(i)||(()=>new i);e({provide:i,useFactory:l,deps:jt},i),e({provide:ly,useValue:i,multi:!0},i),e({provide:Zr,useValue:()=>$(i),multi:!0},i)}let u=o.providers;if(u!=null&&!a){let l=n;py(u,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function py(n,e){for(let t of n)ty(t)&&(t=t.\u0275providers),Array.isArray(t)?py(t,e):e(t)}var Lk=Ie({provide:String,useValue:Ie});function GT(n){return n!==null&&typeof n=="object"&&Lk in n}function jk(n){return!!(n&&n.useExisting)}function Bk(n){return!!(n&&n.useFactory)}function eo(n){return typeof n=="function"}function WT(n){return!!n.useClass}var ju=new z(""),Jd={},PT={},Bm;function Bu(){return Bm===void 0&&(Bm=new ku),Bm}var Fe=class{},to=class extends Fe{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,Gm(e,s=>this.processProvider(s)),this.records.set(cy,vs(void 0,this)),i.has("environment")&&this.records.set(Fe,vs(void 0,this));let o=this.records.get(ju);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(ly,jt,{self:!0}))}retrieve(e,t){let r=Xi(t)||0;try{return this.get(e,Zi,r)}catch(i){if(Jo(i))return i;throw i}}destroy(){Pu(this),this._destroyed=!0;let e=ue(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ue(e)}}onDestroy(e){return Pu(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Pu(this);let t=Vn(this),r=Yt(void 0),i;try{return e()}finally{Vn(t),Yt(r)}}get(e,t=Zi,r){if(Pu(this),e.hasOwnProperty(xT))return e[xT](this);let i=Xi(r),o,s=Vn(this),a=Yt(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let d=zk(e)&&Vu(e);d&&this.injectableDefInScope(d)?l=vs(zm(e),Jd):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let u=i&2?Bu():this.parent;return t=i&8&&t===Zi?null:t,u.get(e,t)}catch(u){let l=Nk(u);throw l===-200||l===-201?new K(l,null):u}finally{Yt(a),Vn(s)}}resolveInjectorInitializers(){let e=ue(null),t=Vn(this),r=Yt(void 0),i;try{let o=this.get(Zr,jt,{self:!0});for(let s of o)s()}finally{Vn(t),Yt(r),ue(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(mr(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=lt(e);let t=eo(e)?e:lt(e&&e.provide),r=$k(e);if(!eo(e)&&e.multi===!0){let i=this.records.get(t);i||(i=vs(void 0,Jd,!0),i.factory=()=>qm(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=ue(null);try{if(t.value===PT)throw sy(mr(e));return t.value===Jd&&(t.value=PT,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&qk(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ue(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=lt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function zm(n){let e=Vu(n),t=e!==null?e.factory:Ji(n);if(t!==null)return t;if(n instanceof z)throw new K(204,!1);if(n instanceof Function)return Uk(n);throw new K(204,!1)}function Uk(n){if(n.length>0)throw new K(204,!1);let t=Ak(n);return t!==null?()=>t.factory(n):()=>new n}function $k(n){if(GT(n))return vs(void 0,n.useValue);{let e=gy(n);return vs(e,Jd)}}function gy(n,e,t){let r;if(eo(n)){let i=lt(n);return Ji(i)||zm(i)}else if(GT(n))r=()=>lt(n.useValue);else if(Bk(n))r=()=>n.useFactory(...qm(n.deps||[]));else if(jk(n))r=(i,o)=>$(lt(n.useExisting),o!==void 0&&o&8?8:void 0);else{let i=lt(n&&(n.useClass||n.provide));if(Hk(n))r=()=>new i(...qm(n.deps));else return Ji(i)||zm(i)}return r}function Pu(n){if(n.destroyed)throw new K(205,!1)}function vs(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Hk(n){return!!n.deps}function qk(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function zk(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Gm(n,e){for(let t of n)Array.isArray(t)?Gm(t,e):t&&ty(t)?Gm(t.\u0275providers,e):e(t)}function wt(n,e){let t;n instanceof to?(Pu(n),t=n):t=new Hm(n);let r,i=Vn(t),o=Yt(void 0);try{return e()}finally{Vn(i),Yt(o)}}function KT(){return BT()!==void 0||pd()!=null}var Dn=0,oe=1,ne=2,dt=3,fn=4,Zt=5,Uu=6,Is=7,Ut=8,Jr=9,Bn=10,Be=11,ws=12,my=13,Ds=14,Xt=15,ro=16,io=17,oo=18,$u=19,yy=20,gr=21,cf=22,Hu=23,Jt=24,so=25,qu=26,Dt=27,QT=1;var ei=7,zu=8,Gu=9,$t=10;function Un(n){return Array.isArray(n)&&typeof n[QT]=="object"}function Cn(n){return Array.isArray(n)&&n[QT]===!0}function vy(n){return(n.flags&4)!==0}function ti(n){return n.componentOffset>-1}function Wu(n){return(n.flags&1)===1}function $n(n){return!!n.template}function Cs(n){return(n[ne]&512)!==0}function ao(n){return(n[ne]&256)===256}var YT="svg",ZT="math";function en(n){for(;Array.isArray(n);)n=n[Dn];return n}function _y(n,e){return en(e[n])}function Hn(n,e){return en(e[n.index])}function lf(n,e){return n.data[e]}function hn(n,e){let t=e[n];return Un(t)?t:t[Dn]}function df(n){return(n[ne]&128)===128}function XT(n){return Cn(n[dt])}function ni(n,e){return e==null?null:n[e]}function Ey(n){n[io]=0}function Iy(n){n[ne]&1024||(n[ne]|=1024,df(n)&&Ts(n))}function Ku(n){return!!(n[ne]&9216||n[Jt]?.dirty)}function ff(n){n[Bn].changeDetectionScheduler?.notify(8),n[ne]&64&&(n[ne]|=1024),Ku(n)&&Ts(n)}function Ts(n){n[Bn].changeDetectionScheduler?.notify(0);let e=Qr(n);for(;e!==null&&!(e[ne]&8192||(e[ne]|=8192,!df(e)));)e=Qr(e)}function wy(n,e){if(ao(n))throw new K(911,!1);n[gr]===null&&(n[gr]=[]),n[gr].push(e)}function JT(n,e){if(n[gr]===null)return;let t=n[gr].indexOf(e);t!==-1&&n[gr].splice(t,1)}function Qr(n){let e=n[dt];return Cn(e)?e[dt]:e}function eb(n){return n[Is]??=[]}function tb(n){return n.cleanup??=[]}var he={lFrame:pb(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Wm=!1;function nb(){return he.lFrame.elementDepthCount}function rb(){he.lFrame.elementDepthCount++}function Dy(){he.lFrame.elementDepthCount--}function Cy(){return he.bindingsEnabled}function ib(){return he.skipHydrationRootTNode!==null}function Ty(n){return he.skipHydrationRootTNode===n}function by(){he.skipHydrationRootTNode=null}function we(){return he.lFrame.lView}function tn(){return he.lFrame.tView}function Ct(){let n=Sy();for(;n!==null&&n.type===64;)n=n.parent;return n}function Sy(){return he.lFrame.currentTNode}function bs(){let n=he.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function _r(n,e){let t=he.lFrame;t.currentTNode=n,t.isParent=e}function Ay(){return he.lFrame.isParent}function ob(){he.lFrame.isParent=!1}function Ry(){return Wm}function My(n){let e=Wm;return Wm=n,e}function sb(){let n=he.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function ab(){return he.lFrame.bindingIndex}function ub(n){return he.lFrame.bindingIndex=n}function hf(){return he.lFrame.bindingIndex++}function Ny(n){let e=he.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function cb(){return he.lFrame.inI18n}function xy(n){he.lFrame.inI18n=n}function lb(n,e){let t=he.lFrame;t.bindingIndex=t.bindingRootIndex=n,pf(e)}function db(){return he.lFrame.currentDirectiveIndex}function pf(n){he.lFrame.currentDirectiveIndex=n}function fb(n){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Py(n){he.lFrame.currentQueryIndex=n}function Gk(n){let e=n[oe];return e.type===2?e.declTNode:e.type===1?n[Zt]:null}function Oy(n,e,t){if(t&4){let i=e,o=n;for(;i=i.parent,i===null&&!(t&1);)if(i=Gk(o),i===null||(o=o[Ds],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=he.lFrame=hb();return r.currentTNode=e,r.lView=n,!0}function gf(n){let e=hb(),t=n[oe];he.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function hb(){let n=he.lFrame,e=n===null?null:n.child;return e===null?pb(n):e}function pb(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function gb(){let n=he.lFrame;return he.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var ky=gb;function mf(){let n=gb();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ri(){return he.lFrame.selectedIndex}function ii(n){he.lFrame.selectedIndex=n}function Fy(){let n=he.lFrame;return lf(n.tView,n.selectedIndex)}function mb(){return he.lFrame.currentNamespace}var yb=!0;function Qu(){return yb}function Yu(n){yb=n}function Km(n,e=null,t=null,r){let i=Vy(n,e,t,r);return i.resolveInjectorInitializers(),i}function Vy(n,e=null,t=null,r,i=new Set){let o=[t||jt,qT(n)];return r=r||(typeof n=="object"?void 0:mr(n)),new to(o,e||Bu(),r||null,i)}var Bt=class n{static THROW_IF_NOT_FOUND=Zi;static NULL=new ku;static create(e,t){if(Array.isArray(e))return Km({name:""},t,e,"");{let r=e.name??"";return Km({name:r},e.parent,e.providers,r)}}static \u0275prov=W({token:n,providedIn:"any",factory:()=>$(cy)});static __NG_ELEMENT_ID__=-1},ft=new z(""),qn=(()=>{class n{static __NG_ELEMENT_ID__=Wk;static __NG_ENV_ID__=t=>t}return n})(),Qm=class extends qn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return ao(this._lView)}onDestroy(e){let t=this._lView;return wy(t,e),()=>JT(t,e)}};function Wk(){return new Qm(we())}var In=class{_console=console;handleError(e){this._console.error("ERROR",e)}},pn=new z("",{providedIn:"root",factory:()=>{let n=F(Fe),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(In),e.handleError(t))}}}),vb={provide:Zr,useValue:()=>void F(In),multi:!0};function Ly(n){return typeof n=="function"&&n[Et]!==void 0}function zn(n,e){let[t,r,i]=Im(n,e?.equal),o=t,s=o[Et];return o.set=r,o.update=i,o.asReadonly=_b.bind(o),o}function _b(){let n=this[Et];if(n.readonlyFn===void 0){let e=()=>this();e[Et]=n,n.readonlyFn=e}return n.readonlyFn}function jy(n){return Ly(n)&&typeof n.set=="function"}var yf=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=Kk}return n})();function Kk(){return new yf(we(),Ct())}var yr=class{},vf=new z("",{providedIn:"root",factory:()=>!1});var By=new z(""),Uy=new z(""),Gn=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new ut(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ie(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}return n})(),Zu=(()=>{class n{internalPendingTasks=F(Gn);scheduler=F(yr);errorHandler=F(pn);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}return n})();function Xu(...n){}var $y=(()=>{class n{static \u0275prov=W({token:n,providedIn:"root",factory:()=>new Ym})}return n})(),Ym=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}};function oc(n){return{toString:n}.toString()}function o1(n){return typeof n=="function"}var Tf=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function Zb(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Fs=(()=>{let n=()=>Xb;return n.ngInherit=!0,n})();function Xb(n){return n.type.prototype.ngOnChanges&&(n.setInput=a1),s1}function s1(){let n=eS(this),e=n?.current;if(e){let t=n.previous;if(t===Yr)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function a1(n,e,t,r,i){let o=this.declaredInputs[r],s=eS(n)||u1(n,{previous:Yr,current:null}),a=s.current||(s.current={}),u=s.previous,l=u[o];a[o]=new Tf(l&&l.currentValue,t,u===Yr),Zb(n,e,i,t)}var Jb="__ngSimpleChanges__";function eS(n){return n[Jb]||null}function u1(n,e){return n[Jb]=e}var Eb=[];var De=function(n,e=null,t){for(let r=0;r<Eb.length;r++){let i=Eb[r];i(n,e,t)}};function c1(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=Xb(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function tS(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function If(n,e,t){nS(n,e,3,t)}function wf(n,e,t,r){(n[ne]&3)===t&&nS(n,e,t,r)}function Hy(n,e){let t=n[ne];(t&3)===e&&(t&=16383,t+=1,n[ne]=t)}function nS(n,e,t,r){let i=r!==void 0?n[io]&65535:0,o=r??-1,s=e.length-1,a=0;for(let u=i;u<s;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[io]+=65536),(a<o||o==-1)&&(l1(n,t,e,u),n[io]=(n[io]&4294901760)+u+2),u++}function Ib(n,e){De(4,n,e);let t=ue(null);try{e.call(n)}finally{ue(t),De(5,n,e)}}function l1(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ne]>>14<n[io]>>16&&(n[ne]&3)===e&&(n[ne]+=16384,Ib(a,o)):Ib(a,o)}var As=-1,co=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function d1(n){return(n.flags&8)!==0}function f1(n){return(n.flags&16)!==0}function h1(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];g1(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function p1(n){return n===3||n===4||n===6}function g1(n){return n.charCodeAt(0)===64}function Rs(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?wb(n,t,i,null,e[++r]):wb(n,t,i,null,null))}}return n}function wb(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function rS(n){return n!==As}function bf(n){return n&32767}function m1(n){return n>>16}function Sf(n,e){let t=m1(n),r=e;for(;t>0;)r=r[Ds],t--;return r}var ev=!0;function Db(n){let e=ev;return ev=n,e}var y1=256,iS=y1-1,oS=5,v1=0,Wn={};function _1(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(no)&&(r=t[no]),r==null&&(r=t[no]=v1++);let i=r&iS,o=1<<i;e.data[n+(i>>oS)]|=o}function Af(n,e){let t=sS(n,e);if(t!==-1)return t;let r=e[oe];r.firstCreatePass&&(n.injectorIndex=e.length,qy(r.data,n),qy(e,null),qy(r.blueprint,null));let i=Tv(n,e),o=n.injectorIndex;if(rS(i)){let s=bf(i),a=Sf(i,e),u=a[oe].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|u[s+l]}return e[o+8]=i,o}function qy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function sS(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Tv(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=dS(i),r===null)return As;if(t++,i=i[Ds],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return As}function tv(n,e,t){_1(n,e,t)}function aS(n,e,t){if(t&8||n!==void 0)return n;of(e,"NodeInjector")}function uS(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[Jr],o=Yt(void 0);try{return i?i.get(e,r,t&8):ay(e,r,t&8)}finally{Yt(o)}}return aS(r,e,t)}function cS(n,e,t,r=0,i){if(n!==null){if(e[ne]&2048&&!(r&2)){let s=C1(n,e,t,r,Wn);if(s!==Wn)return s}let o=lS(n,e,t,r,Wn);if(o!==Wn)return o}return uS(e,t,r,i)}function lS(n,e,t,r,i){let o=w1(t);if(typeof o=="function"){if(!Oy(e,n,r))return r&1?aS(i,t,r):uS(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&8))of(t);else return s}finally{ky()}}else if(typeof o=="number"){let s=null,a=sS(n,e),u=As,l=r&1?e[Xt][Zt]:null;for((a===-1||r&4)&&(u=a===-1?Tv(n,e):e[a+8],u===As||!Tb(r,!1)?a=-1:(s=e[oe],a=bf(u),e=Sf(u,e)));a!==-1;){let d=e[oe];if(Cb(o,a,d.data)){let h=E1(a,e,t,s,r,l);if(h!==Wn)return h}u=e[a+8],u!==As&&Tb(r,e[oe].data[a+8]===l)&&Cb(o,a,e)?(s=d,a=bf(u),e=Sf(u,e)):a=-1}}return i}function E1(n,e,t,r,i,o){let s=e[oe],a=s.data[n+8],u=r==null?ti(a)&&ev:r!=s&&(a.type&3)!==0,l=i&1&&o===a,d=I1(a,s,t,u,l);return d!==null?Rf(e,s,d,a,i):Wn}function I1(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,u=n.directiveStart,l=n.directiveEnd,d=o>>20,h=r?a:a+d,g=i?a+d:l;for(let y=h;y<g;y++){let I=s[y];if(y<u&&t===I||y>=u&&I.type===t)return y}if(i){let y=s[u];if(y&&$n(y)&&y.type===t)return u}return null}function Rf(n,e,t,r,i){let o=n[t],s=e.data;if(o instanceof co){let a=o;if(a.resolving){let y=VT(s[t]);throw sy(y)}let u=Db(a.canSeeViewProviders);a.resolving=!0;let l=s[t].type||s[t],d,h=a.injectImpl?Yt(a.injectImpl):null,g=Oy(n,r,0);try{o=n[t]=a.factory(void 0,i,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&c1(t,s[t],e)}finally{h!==null&&Yt(h),Db(u),a.resolving=!1,ky()}}return o}function w1(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(no)?n[no]:void 0;return typeof e=="number"?e>=0?e&iS:D1:e}function Cb(n,e,t){let r=1<<n;return!!(t[e+(n>>oS)]&r)}function Tb(n,e){return!(n&2)&&!(n&1&&e)}var uo=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return cS(this._tNode,this._lView,e,Xi(r),t)}};function D1(){return new uo(Ct(),we())}function si(n){return oc(()=>{let e=n.prototype.constructor,t=e[Ou]||nv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Ou]||nv(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function nv(n){return Jm(n)?()=>{let e=nv(lt(n));return e&&e()}:Ji(n)}function C1(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ne]&2048&&!Cs(s);){let a=lS(o,s,t,r|2,Wn);if(a!==Wn)return a;let u=o.parent;if(!u){let l=s[yy];if(l){let d=l.get(t,Wn,r);if(d!==Wn)return d}u=dS(s),s=s[Ds]}o=u}return i}function dS(n){let e=n[oe],t=e.type;return t===2?e.declTNode:t===1?n[Zt]:null}function T1(){return $f(Ct(),we())}function $f(n,e){return new Dr(Hn(n,e))}var Dr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=T1}return n})();function fS(n){return(n.flags&128)===128}var bv=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(bv||{}),hS=new Map,b1=0;function S1(){return b1++}function A1(n){hS.set(n[$u],n)}function rv(n){hS.delete(n[$u])}var bb="__ngContext__";function Ms(n,e){Un(e)?(n[bb]=e[$u],A1(e)):n[bb]=e}function pS(n){return mS(n[ws])}function gS(n){return mS(n[fn])}function mS(n){for(;n!==null&&!Cn(n);)n=n[fn];return n}var iv;function Sv(n){iv=n}function Av(){if(iv!==void 0)return iv;if(typeof document<"u")return document;throw new K(210,!1)}var Hf=new z("",{providedIn:"root",factory:()=>R1}),R1="ng",qf=new z(""),bn=new z("",{providedIn:"platform",factory:()=>"unknown"});var zf=new z("",{providedIn:"root",factory:()=>Av().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var M1="h",N1="b";var yS=!1,vS=new z("",{providedIn:"root",factory:()=>yS});var x1=(n,e,t,r)=>{};function P1(n,e,t,r){x1(n,e,t,r)}function Rv(n){return(n.flags&32)===32}var O1=()=>null;function _S(n,e,t=!1){return O1(n,e,t)}function ES(n,e){let t=n.contentQueries;if(t!==null){let r=ue(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];Py(o),a.contentQueries(2,e[s],s)}}}finally{ue(r)}}}function ov(n,e,t){Py(0);let r=ue(null);try{e(n,t)}finally{ue(r)}}function IS(n,e,t){if(vy(e)){let r=ue(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let u=t[s];a.contentQueries(1,u,s)}}}finally{ue(r)}}}var Ir=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(Ir||{}),_f;function k1(){if(_f===void 0&&(_f=null,Fu.trustedTypes))try{_f=Fu.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return _f}function Mv(n){return k1()?.createHTML(n)||n}var Mf=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${nf})`}};function Nv(n){return n instanceof Mf?n.changingThisBreaksApplicationSecurity:n}function wS(n,e){let t=DS(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${nf})`)}return t===e}function DS(n){return n instanceof Mf&&n.getTypeName()||null}function F1(n){let e=new av(n);return V1()?new sv(e):e}var sv=class{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(Mv(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},av=class{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=Mv(e),t}};function V1(){try{return!!new window.DOMParser().parseFromString(Mv(""),"text/html")}catch{return!1}}var L1=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function xv(n){return n=String(n),n.match(L1)?n:"unsafe:"+n}function ai(n){let e={};for(let t of n.split(","))e[t]=!0;return e}function sc(...n){let e={};for(let t of n)for(let r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}var j1=ai("area,br,col,hr,img,wbr"),CS=ai("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),TS=ai("rp,rt"),B1=sc(TS,CS),U1=sc(CS,ai("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$1=sc(TS,ai("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),H1=sc(j1,U1,$1,B1),bS=ai("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),q1=ai("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),z1=ai("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),G1=sc(bS,q1,z1);function W1(n){return"content"in n&&K1(n)?n.content:null}function K1(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName==="TEMPLATE"}var Pv=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Pv||{});function Gf(n){let e=Q1();return e?e.sanitize(Pv.URL,n)||"":wS(n,"URL")?Nv(n):xv(_s(n))}function Q1(){let n=we();return n&&n[Bn].sanitizer}var Y1=/^>|^->|<!--|-->|--!>|<!-$/g,Z1=/(<|>)/g,X1="\u200B$1\u200B";function J1(n){return n.replace(Y1,e=>e.replace(Z1,X1))}function SS(n){return n instanceof Function?n():n}function eF(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var AS="ng-template";function tF(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&eF(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Ov(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Ov(n){return n.type===4&&n.value!==AS}function nF(n,e,t){let r=n.type===4&&!t?AS:n.value;return e===r}function rF(n,e,t){let r=4,i=n.attrs,o=i!==null?sF(i):0,s=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!s&&!Tn(r)&&!Tn(u))return!1;if(s&&Tn(u))continue;s=!1,r=u|r&1;continue}if(!s)if(r&4){if(r=2|r&1,u!==""&&!nF(n,u,t)||u===""&&e.length===1){if(Tn(r))return!1;s=!0}}else if(r&8){if(i===null||!tF(n,i,u,t)){if(Tn(r))return!1;s=!0}}else{let l=e[++a],d=iF(u,i,Ov(n),t);if(d===-1){if(Tn(r))return!1;s=!0;continue}if(l!==""){let h;if(d>o?h="":h=i[d+1].toLowerCase(),r&2&&l!==h){if(Tn(r))return!1;s=!0}}}}return Tn(r)||s}function Tn(n){return(n&1)===0}function iF(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return aF(e,n)}function oF(n,e,t=!1){for(let r=0;r<e.length;r++)if(rF(n,e[r],t))return!0;return!1}function sF(n){for(let e=0;e<n.length;e++){let t=n[e];if(p1(t))return e}return n.length}function aF(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Sb(n,e){return n?":not("+e.trim()+")":e}function uF(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Tn(s)&&(e+=Sb(o,i),i=""),r=s,o=o||!Tn(r);t++}return i!==""&&(e+=Sb(o,i)),e}function cF(n){return n.map(uF).join(",")}function lF(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Tn(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var Sn={};function RS(n,e){return n.createText(e)}function dF(n,e,t){n.setValue(e,t)}function fF(n,e){return n.createComment(J1(e))}function kv(n,e,t){return n.createElement(e,t)}function Ns(n,e,t,r,i){n.insertBefore(e,t,r,i)}function MS(n,e,t){n.appendChild(e,t)}function Ab(n,e,t,r,i){r!==null?Ns(n,e,t,r,i):MS(n,e,t)}function hF(n,e,t,r){n.removeChild(null,e,t,r)}function pF(n,e,t){n.setAttribute(e,"style",t)}function gF(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function NS(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&h1(n,e,r),i!==null&&gF(n,e,i),o!==null&&pF(n,e,o)}function Fv(n,e,t,r,i,o,s,a,u,l,d){let h=Dt+r,g=h+i,y=mF(h,g),I=typeof l=="function"?l():l;return y[oe]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:I,incompleteFirstPass:!1,ssrId:d}}function mF(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Sn);return t}function yF(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Fv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Vv(n,e,t,r,i,o,s,a,u,l,d){let h=e.blueprint.slice();return h[Dn]=i,h[ne]=r|4|128|8|64|1024,(l!==null||n&&n[ne]&2048)&&(h[ne]|=2048),Ey(h),h[dt]=h[Ds]=n,h[Ut]=t,h[Bn]=s||n&&n[Bn],h[Be]=a||n&&n[Be],h[Jr]=u||n&&n[Jr]||null,h[Zt]=o,h[$u]=S1(),h[Uu]=d,h[yy]=l,h[Xt]=e.type==2?n[Xt]:h,h}function vF(n,e,t){let r=Hn(e,n),i=yF(t),o=n[Bn].rendererFactory,s=Lv(n,Vv(n,i,null,xS(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function xS(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function ac(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Lv(n,e){return n[ws]?n[my][fn]=e:n[ws]=e,n[my]=e,e}function Qe(n=1){PS(tn(),we(),ri()+n,!1)}function PS(n,e,t,r){if(!r)if((e[ne]&3)===3){let o=n.preOrderCheckHooks;o!==null&&If(e,o,t)}else{let o=n.preOrderHooks;o!==null&&wf(e,o,0,t)}ii(t)}var Wf=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Wf||{});function uv(n,e,t,r){let i=ue(null);try{let[o,s,a]=n.inputs[t],u=null;(s&Wf.SignalBased)!==0&&(u=e[o][Et]),u!==null&&u.transformFn!==void 0?r=u.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,u,r,t,o):Zb(e,u,o,r)}finally{ue(i)}}var wr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(wr||{}),cv;function jv(n,e){return cv(n,e)}function _F(n){cv===void 0&&(cv=n())}var xs=new Set,Kf=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Kf||{}),po=new z(""),Rb=new Set;function Qf(n){Rb.has(n)||(Rb.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var OS=!1,lv=class extends xe{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,KT()&&(this.destroyRef=F(qn,{optional:!0})??void 0,this.pendingTasks=F(Gn,{optional:!0})??void 0)}emit(e){let t=ue(null);try{super.next(e)}finally{ue(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),o=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof He&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},nt=lv;function kS(n){let e,t;function r(){n=Xu;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function Mb(n){return queueMicrotask(()=>n()),()=>{n=Xu}}var Bv="isAngularZone",Nf=Bv+"_ID",EF=0,be=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new nt(!1);onMicrotaskEmpty=new nt(!1);onStable=new nt(!1);onError=new nt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=OS}=e;if(typeof Zone>"u")throw new K(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,DF(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Bv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new K(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new K(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,IF,Xu,Xu);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},IF={};function Uv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function wF(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){kS(()=>{n.callbackScheduled=!1,dv(n),n.isCheckStableRunning=!0,Uv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),dv(n)}function DF(n){let e=()=>{wF(n)},t=EF++;n._inner=n._inner.fork({name:"angular",properties:{[Bv]:!0,[Nf]:t,[Nf+t]:!0},onInvokeTask:(r,i,o,s,a,u)=>{if(CF(u))return r.invokeTask(o,s,a,u);try{return Nb(n),r.invokeTask(o,s,a,u)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),xb(n)}},onInvoke:(r,i,o,s,a,u,l)=>{try{return Nb(n),r.invoke(o,s,a,u,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!TF(u)&&e(),xb(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,dv(n),Uv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function dv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Nb(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function xb(n){n._nesting--,Uv(n)}var xf=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new nt;onMicrotaskEmpty=new nt;onStable=new nt;onError=new nt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function CF(n){return FS(n,"__ignore_ng_zone__")}function TF(n){return FS(n,"__scheduler_tick__")}function FS(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var $v=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}return n})(),VS=[0,1,2,3],LS=(()=>{class n{ngZone=F(be);scheduler=F(yr);errorHandler=F(In,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){F(po,{optional:!0})}execute(){let t=this.sequences.size>0;t&&De(16),this.executing=!0;for(let r of VS)for(let i of this.sequences)if(!(i.erroredOrDestroyed||!i.hooks[r]))try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=i.hooks[r];return o(i.pipelinedValue)},i.snapshot))}catch(o){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&De(17)}register(t){let{view:r}=t;r!==void 0?((r[so]??=[]).push(t),Ts(r),r[ne]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(Kf.AFTER_NEXT_RENDER,t):t()}static \u0275prov=W({token:n,providedIn:"root",factory:()=>new n})}return n})(),Pf=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,i,o,s=null){this.impl=e,this.hooks=t,this.view=r,this.once=i,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[so];e&&(this.view[so]=e.filter(t=>t!==this))}};function Yf(n,e){let t=e?.injector??F(Bt);return Qf("NgAfterNextRender"),SF(n,t,e,!0)}function bF(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function SF(n,e,t,r){let i=e.get($v);i.impl??=e.get(LS);let o=e.get(po,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(qn):null,a=e.get(yf,null,{optional:!0}),u=new Pf(i.impl,bF(n),a?.view,r,s,o?.snapshot(null));return i.impl.register(u),u}var AF=new z("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function jS(n,e){let t=n.get(AF);if(Array.isArray(e))for(let r of e)t.queue.add(r);else t.queue.add(e);t.scheduler&&t.scheduler(n)}function RF(n,e){for(let[t,r]of e)jS(n,r.animateFns)}function Pb(n,e,t,r){let i=n?.[qu]?.enter;e!==null&&i&&i.has(t.index)&&RF(r,i)}function Ss(n,e,t,r,i,o,s,a){if(i!=null){let u,l=!1;Cn(i)?u=i:Un(i)&&(l=!0,i=i[Dn]);let d=en(i);n===0&&r!==null?(Pb(a,r,o,t),s==null?MS(e,r,d):Ns(e,r,d,s||null,!0)):n===1&&r!==null?(Pb(a,r,o,t),Ns(e,r,d,s||null,!0)):n===2?Ob(a,o,t,h=>{hF(e,d,l,h)}):n===3&&Ob(a,o,t,()=>{e.destroyNode(d)}),u!=null&&jF(e,n,t,u,o,r,s)}}function MF(n,e){BS(n,e),e[Dn]=null,e[Zt]=null}function NF(n,e,t,r,i,o){r[Dn]=i,r[Zt]=e,Zf(n,r,t,1,i,o)}function BS(n,e){e[Bn].changeDetectionScheduler?.notify(9),Zf(n,e,e[Be],2,null,null)}function xF(n){let e=n[ws];if(!e)return zy(n[oe],n);for(;e;){let t=null;if(Un(e))t=e[ws];else{let r=e[$t];r&&(t=r)}if(!t){for(;e&&!e[fn]&&e!==n;)Un(e)&&zy(e[oe],e),e=e[dt];e===null&&(e=n),Un(e)&&zy(e[oe],e),t=e&&e[fn]}e=t}}function Hv(n,e){let t=n[Gu],r=t.indexOf(e);t.splice(r,1)}function US(n,e){if(ao(e))return;let t=e[Be];t.destroyNode&&Zf(n,e,t,3,null,null),xF(e)}function zy(n,e){if(ao(e))return;let t=ue(null);try{e[ne]&=-129,e[ne]|=256,e[Jt]&&Cu(e[Jt]),kF(n,e),OF(n,e),e[oe].type===1&&e[Be].destroy();let r=e[ro];if(r!==null&&Cn(e[dt])){r!==e[dt]&&Hv(r,e);let i=e[oo];i!==null&&i.detachView(n)}rv(e)}finally{ue(t)}}function Ob(n,e,t,r){let i=n?.[qu];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);if(i.skipLeaveAnimations)return i.skipLeaveAnimations=!1,r(!1);n&&xs.add(n),jS(t,()=>{if(i.leave&&i.leave.has(e.index)){let s=i.leave.get(e.index),a=[];if(s)for(let u=0;u<s.animateFns.length;u++){let l=s.animateFns[u],{promise:d}=l();a.push(d)}i.running=Promise.allSettled(a),PF(n,r)}else n&&xs.delete(n),r(!1)})}function PF(n,e){let t=n[qu]?.running;if(t){t.then(()=>{n[qu].running=void 0,xs.delete(n),e(!0)});return}e(!1)}function OF(n,e){let t=n.cleanup,r=e[Is];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[Is]=null);let i=e[gr];if(i!==null){e[gr]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[Hu];if(o!==null){e[Hu]=null;for(let s of o)s.destroy()}}function kF(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof co)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],u=o[s+1];De(4,a,u);try{u.call(a)}finally{De(5,a,u)}}else{De(4,i,o);try{o.call(i)}finally{De(5,i,o)}}}}}function FF(n,e,t){return $S(n,e.parent,t)}function $S(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Dn];if(ti(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Ir.None||i===Ir.Emulated)return null}return Hn(r,t)}function VF(n,e,t){return qS(n,e,t)}function HS(n,e,t){return n.type&40?Hn(n,t):null}var qS=HS,fv;function zS(n,e){qS=n,fv=e}function qv(n,e,t,r){let i=FF(n,r,e),o=e[Be],s=r.parent||e[Zt],a=VF(s,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)Ab(o,i,t[u],a,!1);else Ab(o,i,t,a,!1);fv!==void 0&&fv(o,r,e,t,i)}function Ju(n,e){if(e!==null){let t=e.type;if(t&3)return Hn(e,n);if(t&4)return hv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Ju(n,r);{let i=n[e.index];return Cn(i)?hv(-1,i):en(i)}}else{if(t&128)return Ju(n,e.next);if(t&32)return jv(e,n)()||en(n[e.index]);{let r=GS(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Qr(n[Xt]);return Ju(i,r)}else return Ju(n,e.next)}}}return null}function GS(n,e){if(e!==null){let r=n[Xt][Zt],i=e.projection;return r.projection[i]}return null}function hv(n,e){let t=$t+n+1;if(t<e.length){let r=e[t],i=r[oe].firstChild;if(i!==null)return Ju(r,i)}return e[ei]}function zv(n,e,t,r,i,o,s){for(;t!=null;){let a=r[Jr];if(t.type===128){t=t.next;continue}let u=r[t.index],l=t.type;if(s&&e===0&&(u&&Ms(en(u),r),t.flags|=2),!Rv(t))if(l&8)zv(n,e,t.child,r,i,o,!1),Ss(e,n,a,i,u,t,o,r);else if(l&32){let d=jv(t,r),h;for(;h=d();)Ss(e,n,a,i,h,t,o,r);Ss(e,n,a,i,u,t,o,r)}else l&16?LF(n,e,r,t,i,o):Ss(e,n,a,i,u,t,o,r);t=s?t.projectionNext:t.next}}function Zf(n,e,t,r,i,o){zv(t,r,n.firstChild,e,i,o,!1)}function LF(n,e,t,r,i,o){let s=t[Xt],u=s[Zt].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let d=u[l];Ss(e,n,t[Jr],i,d,r,o,t)}else{let l=u,d=s[dt];fS(r)&&(l.flags|=128),zv(n,e,l,d,i,o,!0)}}function jF(n,e,t,r,i,o,s){let a=r[ei],u=en(r);a!==u&&Ss(e,n,t,o,a,i,s);for(let l=$t;l<r.length;l++){let d=r[l];Zf(d[oe],d,n,e,o,a)}}function BF(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:wr.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=wr.Important),n.setStyle(t,r,i,o))}}function WS(n,e,t,r,i){let o=ri(),s=r&2;try{ii(-1),s&&e.length>Dt&&PS(n,e,Dt,!1),De(s?2:0,i,t),t(r,i)}finally{ii(o),De(s?3:1,i,t)}}function Gv(n,e,t){WF(n,e,t),(t.flags&64)===64&&KF(n,e,t)}function Wv(n,e,t=Hn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function UF(n,e,t,r){let o=r.get(vS,yS)||t===Ir.ShadowDom,s=n.selectRootElement(e,o);return $F(s),s}function $F(n){HF(n)}var HF=()=>null;function qF(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function KS(n,e,t,r,i,o){let s=e[oe];if(Kv(n,s,e,t,r)){ti(n)&&GF(e,n.index);return}n.type&3&&(t=qF(t)),zF(n,e,t,r,i,o)}function zF(n,e,t,r,i,o){if(n.type&3){let s=Hn(n,e);r=o!=null?o(r,n.value||"",t):r,i.setProperty(s,t,r)}else n.type&12}function GF(n,e){let t=hn(e,n);t[ne]&16||(t[ne]|=64)}function WF(n,e,t){let r=t.directiveStart,i=t.directiveEnd;ti(t)&&vF(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Af(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],u=Rf(e,n,s,t);if(Ms(u,e),o!==null&&YF(e,s-r,u,a,t,o),$n(a)){let l=hn(t.index,e);l[Ut]=Rf(e,n,s,t)}}}function KF(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=db();try{ii(o);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];pf(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&QF(u,l)}}finally{ii(-1),pf(s)}}function QF(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function QS(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];oF(e,o.selectors,!1)&&(r??=[],$n(o)?r.unshift(o):r.push(o))}return r}function YF(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let u=s[a],l=s[a+1];uv(r,t,u,l)}}function YS(n,e,t,r,i){let o=Dt+t,s=e[oe],a=i(s,e,n,r,t);e[o]=a,_r(n,!0);let u=n.type===2;return u?(NS(e[Be],a,n),(nb()===0||Wu(n))&&Ms(a,e),rb()):Ms(a,e),Qu()&&(!u||!Rv(n))&&qv(s,e,a,n),n}function ZS(n){let e=n;return Ay()?ob():(e=e.parent,_r(e,!1)),e}function ZF(n,e){let t=n[Jr];if(!t)return;let r;try{r=t.get(pn,null)}catch{r=null}r?.(e)}function Kv(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let u=0;u<s.length;u+=2){let l=s[u],d=s[u+1],h=e.data[l];uv(h,t[l],d,i),a=!0}if(o)for(let u of o){let l=t[u],d=e.data[u];uv(d,l,r,i),a=!0}return a}function XF(n,e){let t=hn(e,n),r=t[oe];JF(r,t);let i=t[Dn];i!==null&&t[Uu]===null&&(t[Uu]=_S(i,t[Jr])),De(18),Qv(r,t,t[Ut]),De(19,t[Ut])}function JF(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Qv(n,e,t){gf(e);try{let r=n.viewQuery;r!==null&&ov(1,r,t);let i=n.template;i!==null&&WS(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[oo]?.finishViewCreation(n),n.staticContentQueries&&ES(n,e),n.staticViewQueries&&ov(2,n.viewQuery,t);let o=n.components;o!==null&&eV(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ne]&=-5,mf()}}function eV(n,e){for(let t=0;t<e.length;t++)XF(n,e[t])}function tV(n,e,t,r){let i=ue(null);try{let o=e.tView,a=n[ne]&4096?4096:16,u=Vv(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[ro]=l;let d=n[oo];return d!==null&&(u[oo]=d.createEmbeddedView(o)),Qv(o,u,t),u}finally{ue(i)}}function kb(n,e){return!e||e.firstChild===null||fS(n)}function nc(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(en(o)),Cn(o)&&XS(o,r);let s=t.type;if(s&8)nc(n,e,t.child,r);else if(s&32){let a=jv(t,e),u;for(;u=a();)r.push(u)}else if(s&16){let a=GS(e,t);if(Array.isArray(a))r.push(...a);else{let u=Qr(e[Xt]);nc(u[oe],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function XS(n,e){for(let t=$t;t<n.length;t++){let r=n[t],i=r[oe].firstChild;i!==null&&nc(r[oe],r,i,e)}n[ei]!==n[Dn]&&e.push(n[ei])}function JS(n){if(n[so]!==null){for(let e of n[so])e.impl.addSequence(e);n[so].length=0}}var e0=[];function nV(n){return n[Jt]??rV(n)}function rV(n){let e=e0.pop()??Object.create(oV);return e.lView=n,e}function iV(n){n.lView[Jt]!==n&&(n.lView=null,e0.push(n))}var oV=ce(j({},es),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Ts(n.lView)},consumerOnSignalRead(){this.lView[Jt]=this}});function sV(n){let e=n[Jt]??Object.create(aV);return e.lView=n,e}var aV=ce(j({},es),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Qr(n.lView);for(;e&&!t0(e[oe]);)e=Qr(e);e&&Iy(e)},consumerOnSignalRead(){this.lView[Jt]=this}});function t0(n){return n.type!==2}function n0(n){if(n[Hu]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[Hu])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ne]&8192)}}var uV=100;function r0(n,e=0){let r=n[Bn].rendererFactory,i=!1;i||r.begin?.();try{cV(n,e)}finally{i||r.end?.()}}function cV(n,e){let t=Ry();try{My(!0),pv(n,e);let r=0;for(;Ku(n);){if(r===uV)throw new K(103,!1);r++,pv(n,1)}}finally{My(t)}}function lV(n,e,t,r){if(ao(e))return;let i=e[ne],o=!1,s=!1;gf(e);let a=!0,u=null,l=null;o||(t0(n)?(l=nV(e),u=ns(l)):_d()===null?(a=!1,l=sV(e),u=ns(l)):e[Jt]&&(Cu(e[Jt]),e[Jt]=null));try{Ey(e),ub(n.bindingStartIndex),t!==null&&WS(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let y=n.preOrderCheckHooks;y!==null&&If(e,y,null)}else{let y=n.preOrderHooks;y!==null&&wf(e,y,0,null),Hy(e,0)}if(s||dV(e),n0(e),i0(e,0),n.contentQueries!==null&&ES(n,e),!o)if(d){let y=n.contentCheckHooks;y!==null&&If(e,y)}else{let y=n.contentHooks;y!==null&&wf(e,y,1),Hy(e,1)}hV(n,e);let h=n.components;h!==null&&s0(e,h,0);let g=n.viewQuery;if(g!==null&&ov(2,g,r),!o)if(d){let y=n.viewCheckHooks;y!==null&&If(e,y)}else{let y=n.viewHooks;y!==null&&wf(e,y,2),Hy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[cf]){for(let y of e[cf])y();e[cf]=null}o||(JS(e),e[ne]&=-73)}catch(d){throw o||Ts(e),d}finally{l!==null&&(wu(l,u),a&&iV(l)),mf()}}function i0(n,e){for(let t=pS(n);t!==null;t=gS(t))for(let r=$t;r<t.length;r++){let i=t[r];o0(i,e)}}function dV(n){for(let e=pS(n);e!==null;e=gS(e)){if(!(e[ne]&2))continue;let t=e[Gu];for(let r=0;r<t.length;r++){let i=t[r];Iy(i)}}}function fV(n,e,t){De(18);let r=hn(e,n);o0(r,t),De(19,r[Ut])}function o0(n,e){df(n)&&pv(n,e)}function pv(n,e){let r=n[oe],i=n[ne],o=n[Jt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Du(o)),s||=!1,o&&(o.dirty=!1),n[ne]&=-9217,s)lV(r,n,r.template,n[Ut]);else if(i&8192){let a=ue(null);try{n0(n),i0(n,1);let u=r.components;u!==null&&s0(n,u,1),JS(n)}finally{ue(a)}}}function s0(n,e,t){for(let r=0;r<e.length;r++)fV(n,e[r],t)}function hV(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ii(~i);else{let o=i,s=t[++r],a=t[++r];lb(s,o);let u=e[o];De(24,u),a(2,u),De(25,u)}}}finally{ii(-1)}}function Yv(n,e){let t=Ry()?64:1088;for(n[Bn].changeDetectionScheduler?.notify(e);n;){n[ne]|=t;let r=Qr(n);if(Cs(n)&&!r)return n;n=r}return null}function a0(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function pV(n,e,t,r=!0){let i=e[oe];if(gV(i,e,n,t),r){let s=hv(t,n),a=e[Be],u=a.parentNode(n[ei]);u!==null&&NF(i,n[Zt],a,e,u,s)}let o=e[Uu];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function gv(n,e){if(n.length<=$t)return;let t=$t+e,r=n[t];if(r){let i=r[ro];i!==null&&i!==n&&Hv(i,r),e>0&&(n[t-1][fn]=r[fn]);let o=Lu(n,$t+e);MF(r[oe],r);let s=o[oo];s!==null&&s.detachView(o[oe]),r[dt]=null,r[fn]=null,r[ne]&=-129}return r}function gV(n,e,t,r){let i=$t+r,o=t.length;r>0&&(t[i-1][fn]=e),r<o-$t?(e[fn]=t[i],uy(t,$t+r,e)):(t.push(e),e[fn]=null),e[dt]=t;let s=e[ro];s!==null&&t!==s&&u0(s,e);let a=e[oo];a!==null&&a.insertView(n),ff(e),e[ne]|=128}function u0(n,e){let t=n[Gu],r=e[dt];if(Un(r))n[ne]|=2;else{let i=r[dt][Xt];e[Xt]!==i&&(n[ne]|=2)}t===null?n[Gu]=[e]:t.push(e)}var oi=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[oe];return nc(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Ut]}set context(e){this._lView[Ut]=e}get destroyed(){return ao(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[dt];if(Cn(e)){let t=e[zu],r=t?t.indexOf(this):-1;r>-1&&(gv(e,r),Lu(t,r))}this._attachedToViewContainer=!1}US(this._lView[oe],this._lView)}onDestroy(e){wy(this._lView,e)}markForCheck(){Yv(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ne]&=-129}reattach(){ff(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,r0(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new K(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Cs(this._lView),t=this._lView[ro];t!==null&&!e&&Hv(t,this._lView),BS(this._lView[oe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new K(902,!1);this._appRef=e;let t=Cs(this._lView),r=this._lView[ro];r!==null&&!t&&u0(r,this._lView),ff(this._lView)}};var Xf=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=mV;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let o=tV(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new oi(o)}}return n})();function mV(){return yV(Ct(),we())}function yV(n,e){return n.type&4?new Xf(e,n,$f(n,e)):null}function c0(n,e,t){let r=e.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return i===null?HS(n,e,t):en(t[i])}function l0(n,e,t,r,i){let o=e.insertBeforeIndex;if(Array.isArray(o)){let s=r,a=null;if(e.type&3||(a=s,s=i),s!==null&&e.componentOffset===-1)for(let u=1;u<o.length;u++){let l=t[o[u]];Ns(n,s,l,a,!1)}}}function Jf(n,e,t,r,i){let o=n.data[e];if(o===null)o=Zv(n,e,t,r,i),cb()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=bs();o.injectorIndex=s===null?-1:s.injectorIndex}return _r(o,!0),o}function Zv(n,e,t,r,i){let o=Sy(),s=Ay(),a=s?o:o&&o.parent,u=n.data[e]=_V(n,a,t,e,r,i);return vV(n,u,o,s),u}function vV(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function _V(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return ib()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function d0(n,e){if(n.push(e),n.length>1)for(let t=n.length-2;t>=0;t--){let r=n[t];f0(r)||EV(r,e)&&IV(r)===null&&wV(r,e.index)}}function f0(n){return!(n.type&64)}function EV(n,e){return f0(e)||n.index>e.index}function IV(n){let e=n.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function wV(n,e){let t=n.insertBeforeIndex;Array.isArray(t)?t[0]=e:(zS(c0,l0),n.insertBeforeIndex=e)}function DV(n,e,t){let r=n.data[e];r===null?n.data[e]=t:r.value=t}function CV(n,e){let t=n.insertBeforeIndex;t===null?(zS(c0,l0),t=n.insertBeforeIndex=[null,e]):(kT(Array.isArray(t),!0,"Expecting array here"),t.push(e))}function TV(n,e,t){let r=Zv(n,t,64,null,null);return d0(e,r),r}function bV(n,e){let t=e[n.currentCaseLViewIndex];return t===null?t:t<0?~t:t}function SV(n,e,t){return n|e<<17|t<<1}function AV(n){return n===-1}function h0(n,e,t){n.index=0;let r=bV(e,t);r!==null?n.removes=e.remove[r]:n.removes=jt}function mv(n){if(n.index<n.removes.length){let e=n.removes[n.index++];if(e>0)return n.lView[e];{n.stack.push(n.index,n.removes);let t=~e,r=n.lView[oe].data[t];return h0(n,r,n.lView),mv(n)}}else return n.stack.length===0?null:(n.removes=n.stack.pop(),n.index=n.stack.pop(),mv(n))}function RV(){let n={stack:[],index:-1};function e(t,r){for(n.lView=r;n.stack.length;)n.stack.pop();return h0(n,t.value,r),mv.bind(null,n)}return e}var hW=new RegExp(`^(\\d+)*(${N1}|${M1})*(.*)`);var MV=()=>{};function NV(n,e,t,r){MV(n,e,t,r)}var xV=()=>null;function Fb(n,e){return xV(n,e)}var p0=class{},eh=class{},yv=class{resolveComponentFactory(e){throw new K(917,!1)}},uc=class{static NULL=new yv},lo=class{},ui=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>PV()}return n})();function PV(){let n=we(),e=Ct(),t=hn(e.index,n);return(Un(t)?t:n)[Be]}var g0=(()=>{class n{static \u0275prov=W({token:n,providedIn:"root",factory:()=>null})}return n})();var Df={},vv=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,Df,r);return i!==Df||t===Df?i:this.parentInjector.get(e,t,r)}};function Of(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=Xm(i,a);else if(o==2){let u=a,l=e[++s];r=Xm(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function _e(n,e=0){let t=we();if(t===null)return $(n,e);let r=Ct();return cS(r,t,lt(n),e)}function m0(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a=s,u=null,l=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,u,l]=d.resolveHostDirectives(s);break}FV(n,e,t,a,o,u,l)}o!==null&&r!==null&&OV(t,r,o)}function OV(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new K(-301,!1);r.push(e[i],o)}}function kV(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function FV(n,e,t,r,i,o,s){let a=r.length,u=!1;for(let g=0;g<a;g++){let y=r[g];!u&&$n(y)&&(u=!0,kV(n,t,g)),tv(Af(t,e),n,y.type)}$V(t,n.data.length,a);for(let g=0;g<a;g++){let y=r[g];y.providersResolver&&y.providersResolver(y)}let l=!1,d=!1,h=ac(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let g=0;g<a;g++){let y=r[g];if(t.mergedAttrs=Rs(t.mergedAttrs,y.hostAttrs),LV(n,t,e,h,y),UV(h,y,i),s!==null&&s.has(y)){let[b,S]=s.get(y);t.directiveToIndex.set(y.type,[h,b+t.directiveStart,S+t.directiveStart])}else(o===null||!o.has(y))&&t.directiveToIndex.set(y.type,h);y.contentQueries!==null&&(t.flags|=4),(y.hostBindings!==null||y.hostAttrs!==null||y.hostVars!==0)&&(t.flags|=64);let I=y.type.prototype;!l&&(I.ngOnChanges||I.ngOnInit||I.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!d&&(I.ngOnChanges||I.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),h++}VV(n,t,o)}function VV(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))Vb(0,e,i,r),Vb(1,e,i,r),jb(e,r,!1);else{let o=t.get(i);Lb(0,e,o,r),Lb(1,e,o,r),jb(e,r,!0)}}}function Vb(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),y0(e,o)}}function Lb(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),y0(e,s)}}function y0(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function jb(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||Ov(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let u=r[a];if(u===0){a+=4;continue}else if(u===5){a+=2;continue}else if(typeof u=="number")break;if(!t&&i.hasOwnProperty(u)){let l=i[u];for(let d of l)if(d===e){s??=[],s.push(u,r[a+1]);break}}else if(t&&o.hasOwnProperty(u)){let l=o[u];for(let d=0;d<l.length;d+=2)if(l[d]===e){s??=[],s.push(l[d+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function LV(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=Ji(i.type,!0)),s=new co(o,$n(i),_e,null);n.blueprint[r]=s,t[r]=s,jV(n,e,r,ac(n,t,i.hostVars,Sn),i)}function jV(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;BV(s)!=a&&s.push(a),s.push(t,r,o)}}function BV(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function UV(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;$n(e)&&(t[""]=n)}}function $V(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function v0(n,e,t,r,i,o,s,a){let u=e[oe],l=u.consts,d=ni(l,s),h=Jf(u,n,t,r,d);return o&&m0(u,e,h,ni(l,a),i),h.mergedAttrs=Rs(h.mergedAttrs,h.attrs),h.attrs!==null&&Of(h,h.attrs,!1),h.mergedAttrs!==null&&Of(h,h.mergedAttrs,!0),u.queries!==null&&u.queries.elementStart(u,h),h}function _0(n,e){tS(n,e),vy(e)&&n.queries.elementEnd(e)}function HV(n,e,t,r,i,o){let s=e.consts,a=ni(s,i),u=Jf(e,n,t,r,a);if(u.mergedAttrs=Rs(u.mergedAttrs,u.attrs),o!=null){let l=ni(s,o);u.localNames=[];for(let d=0;d<l.length;d+=2)u.localNames.push(l[d],-1)}return u.attrs!==null&&Of(u,u.attrs,!1),u.mergedAttrs!==null&&Of(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function Xv(n){return I0(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function E0(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function I0(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function qV(n,e,t){return n[e]=t}function fo(n,e,t){if(t===Sn)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function zV(n,e,t,r){let i=fo(n,e,t);return fo(n,e+1,r)||i}function Gy(n,e,t){return function r(i){let o=ti(n)?hn(n.index,e):e;Yv(o,5);let s=e[Ut],a=Bb(e,s,t,i),u=r.__ngNextListenerFn__;for(;u;)a=Bb(e,s,u,i)&&a,u=u.__ngNextListenerFn__;return a}}function Bb(n,e,t,r){let i=ue(null);try{return De(6,e,t),t(r)!==!1}catch(o){return ZF(n,o),!1}finally{De(7,e,t),ue(i)}}function GV(n,e,t,r,i,o,s,a){let u=Wu(n),l=!1,d=null;if(!r&&u&&(d=KV(e,t,o,n.index)),d!==null){let h=d.__ngLastListenerFn__||d;h.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,l=!0}else{let h=Hn(n,t),g=r?r(h):h;P1(t,g,o,a);let y=i.listen(g,o,a);if(!WV(o)){let I=r?b=>r(en(b[n.index])):n.index;w0(I,e,t,o,a,y,!1)}}return l}function WV(n){return n.startsWith("animation")||n.startsWith("transition")}function KV(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[Is],u=i[o+2];return a&&a.length>u?a[u]:null}typeof s=="string"&&(o+=2)}return null}function w0(n,e,t,r,i,o,s){let a=e.firstCreatePass?tb(e):null,u=eb(t),l=u.length;u.push(i,o),a&&a.push(r,n,l,(l+1)*(s?-1:1))}function Ub(n,e,t,r,i,o){let s=e[t],a=e[oe],l=a.data[t].outputs[r],h=s[l].subscribe(o);w0(n.index,a,e,i,o,h,!0)}var _v=Symbol("BINDING");var kf=class extends uc{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Xr(e);return new Ps(t,this.ngModule)}};function QV(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&Wf.SignalBased)!==0};return i&&(o.transform=i),o})}function YV(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function ZV(n,e,t){let r=e instanceof Fe?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new vv(t,r):t}function XV(n){let e=n.get(lo,null);if(e===null)throw new K(407,!1);let t=n.get(g0,null),r=n.get(yr,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function JV(n,e){let t=D0(n);return kv(e,t,t==="svg"?YT:t==="math"?ZT:null)}function D0(n){return(n.selectors[0][0]||"div").toLowerCase()}var Ps=class extends eh{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=QV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=YV(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=cF(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,o,s){De(22);let a=ue(null);try{let u=this.componentDef,l=eL(r,u,s,o),d=ZV(u,i||this.ngModule,e),h=XV(d),g=h.rendererFactory.createRenderer(null,u),y=r?UF(g,r,u.encapsulation,d):JV(u,g),I=s?.some($b)||o?.some(O=>typeof O!="function"&&O.bindings.some($b)),b=Vv(null,l,null,512|xS(u),null,null,h,g,d,null,_S(y,d,!0));b[Dt]=y,gf(b);let S=null;try{let O=v0(Dt,b,2,"#host",()=>l.directiveRegistry,!0,0);NS(g,y,O),Ms(y,b),Gv(l,b,O),IS(l,O,b),_0(l,O),t!==void 0&&nL(O,this.ngContentSelectors,t),S=hn(O.index,b),b[Ut]=S[Ut],Qv(l,b,null)}catch(O){throw S!==null&&rv(S),rv(b),O}finally{De(23),mf()}return new Ff(this.componentType,b,!!I)}finally{ue(a)}}};function eL(n,e,t,r){let i=n?["ng-version","20.3.6"]:lF(e.selectors[0]),o=null,s=null,a=0;if(t)for(let d of t)a+=d[_v].requiredVars,d.create&&(d.targetIdx=0,(o??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(r)for(let d=0;d<r.length;d++){let h=r[d];if(typeof h!="function")for(let g of h.bindings){a+=g[_v].requiredVars;let y=d+1;g.create&&(g.targetIdx=y,(o??=[]).push(g)),g.update&&(g.targetIdx=y,(s??=[]).push(g))}}let u=[e];if(r)for(let d of r){let h=typeof d=="function"?d:d.type,g=fy(h);u.push(g)}return Fv(0,null,tL(o,s),1,a,u,null,null,null,[i],null)}function tL(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function $b(n){let e=n[_v].kind;return e==="input"||e==="twoWay"}var Ff=class extends p0{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=lf(t[oe],Dt),this.location=$f(this._tNode,t),this.instance=hn(this._tNode.index,t)[Ut],this.hostView=this.changeDetectorRef=new oi(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=Kv(r,i[oe],i,e,t);this.previousInputValues.set(e,t);let s=hn(r.index,i);Yv(s,1)}get injector(){return new uo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function nL(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var Vs=(()=>{class n{static __NG_ELEMENT_ID__=rL}return n})();function rL(){let n=Ct();return oL(n,we())}var iL=Vs,C0=class extends iL{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return $f(this._hostTNode,this._hostLView)}get injector(){return new uo(this._hostTNode,this._hostLView)}get parentInjector(){let e=Tv(this._hostTNode,this._hostLView);if(rS(e)){let t=Sf(e,this._hostLView),r=bf(e),i=t[oe].data[r+8];return new uo(i,t)}else return new uo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Hb(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-$t}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=Fb(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,kb(this._hostTNode,s)),a}createComponent(e,t,r,i,o,s,a){let u=e&&!o1(e),l;if(u)l=t;else{let S=t||{};l=S.index,r=S.injector,i=S.projectableNodes,o=S.environmentInjector||S.ngModuleRef,s=S.directives,a=S.bindings}let d=u?e:new Ps(Xr(e)),h=r||this.parentInjector;if(!o&&d.ngModule==null){let O=(u?h:this.parentInjector).get(Fe,null);O&&(o=O)}let g=Xr(d.componentType??{}),y=Fb(this._lContainer,g?.id??null),I=y?.firstChild??null,b=d.create(h,i,I,o,s,a);return this.insertImpl(b.hostView,l,kb(this._hostTNode,y)),b}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(XT(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[dt],l=new C0(u,u[Zt],u[dt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return pV(s,i,o,r),e.attachToViewContainerRef(),uy(Wy(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Hb(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=gv(this._lContainer,t);r&&(Lu(Wy(this._lContainer),t),US(r[oe],r))}detach(e){let t=this._adjustIndex(e,-1),r=gv(this._lContainer,t);return r&&Lu(Wy(this._lContainer),t)!=null?new oi(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Hb(n){return n[zu]}function Wy(n){return n[zu]||(n[zu]=[])}function oL(n,e){let t,r=e[n.index];return Cn(r)?t=r:(t=a0(r,e,null,n),e[n.index]=t,Lv(e,t)),aL(t,e,n,r),new C0(t,n,e)}function sL(n,e){let t=n[Be],r=t.createComment(""),i=Hn(e,n),o=t.parentNode(i);return Ns(t,o,r,t.nextSibling(i),!1),r}var aL=lL,uL=()=>!1;function cL(n,e,t){return uL(n,e,t)}function lL(n,e,t,r){if(n[ei])return;let i;t.type&8?i=en(r):i=sL(e,t),n[ei]=i}var Os=class{},th=class{};var Vf=class extends Os{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new kf(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=dy(e);this._bootstrapComponents=SS(o.bootstrap),this._r3Injector=Vy(e,t,[{provide:Os,useValue:this},{provide:uc,useValue:this.componentFactoryResolver},...r],mr(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Lf=class extends th{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Vf(this.moduleType,e,[])}};var rc=class extends Os{injector;componentFactoryResolver=new kf(this);instance=null;constructor(e){super();let t=new to([...e.providers,{provide:Os,useValue:this},{provide:uc,useValue:this.componentFactoryResolver}],e.parent||Bu(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function cc(n,e,t=null){return new rc({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var dL=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=hy(!1,t.type),i=r.length>0?cc([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=W({token:n,providedIn:"environment",factory:()=>new n($(Fe))})}return n})();function nn(n){return oc(()=>{let e=T0(n),t=ce(j({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===bv.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(dL).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ir.Emulated,styles:n.styles||jt,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Qf("NgStandalone"),b0(t);let r=n.dependencies;return t.directiveDefs=qb(r,fL),t.pipeDefs=qb(r,HT),t.id=gL(t),t})}function fL(n){return Xr(n)||fy(n)}function Kn(n){return oc(()=>({type:n.type,bootstrap:n.bootstrap||jt,declarations:n.declarations||jt,imports:n.imports||jt,exports:n.exports||jt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function hL(n,e){if(n==null)return Yr;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,u;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,u=i[3]||null):(o=i,s=i,a=Wf.None,u=null),t[o]=[r,a,u],e[o]=s}return t}function pL(n){if(n==null)return Yr;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Tt(n){return oc(()=>{let e=T0(n);return b0(e),e})}function T0(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Yr,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||jt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:hL(n.inputs,e),outputs:pL(n.outputs),debugInfo:null}}function b0(n){n.features?.forEach(e=>e(n))}function qb(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let o=e(i);o!==null&&r.push(o)}return r}:null}function gL(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function mL(n){return Object.getPrototypeOf(n.prototype).constructor}function Cr(n){let e=mL(n.type),t=!0,r=[n];for(;e;){let i;if($n(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new K(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=Ky(n.inputs),s.declaredInputs=Ky(n.declaredInputs),s.outputs=Ky(n.outputs);let a=i.hostBindings;a&&IL(n,a);let u=i.viewQuery,l=i.contentQueries;if(u&&_L(n,u),l&&EL(n,l),yL(n,i),OT(n.outputs,i.outputs),$n(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Cr&&(t=!1)}}e=Object.getPrototypeOf(e)}vL(r)}function yL(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function vL(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Rs(i.hostAttrs,t=Rs(t,i.hostAttrs))}}function Ky(n){return n===Yr?{}:n===jt?[]:n}function _L(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function EL(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function IL(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function wL(n,e,t,r,i,o,s,a){if(t.firstCreatePass){n.mergedAttrs=Rs(n.mergedAttrs,n.attrs);let d=n.tView=Fv(2,n,i,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),d.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),_r(n,!1);let u=CL(t,e,n,r);Qu()&&qv(t,e,u,n),Ms(u,e);let l=a0(u,e,u,n);e[r+Dt]=l,Lv(e,l),cL(l,n,e)}function DL(n,e,t,r,i,o,s,a,u,l,d){let h=t+Dt,g;return e.firstCreatePass?(g=Jf(e,h,4,s||null,a||null),Cy()&&m0(e,n,g,ni(e.consts,l),QS),tS(e,g)):g=e.data[h],wL(g,n,e,t,r,i,o,u),Wu(g)&&Gv(e,n,g),l!=null&&Wv(n,g,d),g}function ci(n,e,t,r,i,o,s,a){let u=we(),l=tn(),d=ni(l.consts,o);return DL(u,l,n,e,t,r,i,d,void 0,s,a),ci}var CL=TL;function TL(n,e,t,r){return Yu(!0),e[Be].createComment("")}var Jv=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var e_=new z("");function go(n){return!!n&&typeof n.then=="function"}function S0(n){return!!n&&typeof n.subscribe=="function"}var A0=new z("");var t_=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=F(A0,{optional:!0})??[];injector=F(Bt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=wt(this.injector,i);if(go(o))t.push(o);else if(S0(o)){let s=new Promise((a,u)=>{o.subscribe({complete:a,error:u})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),nh=new z("");function R0(){Em(()=>{let n="";throw new K(600,n)})}function M0(n){return n.isBoundToModule}var bL=10;var Tr=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=F(pn);afterRenderManager=F($v);zonelessEnabled=F(vf);rootEffectScheduler=F($y);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new xe;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=F(Gn);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(X(t=>!t))}constructor(){F(po,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=F(Fe);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=Bt.NULL){return this._injector.get(be).run(()=>{De(10);let s=t instanceof eh;if(!this._injector.get(t_).done){let I="";throw new K(405,I)}let u;s?u=t:u=this._injector.get(uc).resolveComponentFactory(t),this.componentTypes.push(u.componentType);let l=M0(u)?void 0:this._injector.get(Os),d=r||u.selector,h=u.create(i,[],d,l),g=h.location.nativeElement,y=h.injector.get(e_,null);return y?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),ec(this.components,h),y?.unregisterApplication(g)}),this._loadComponent(h),De(11,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){De(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Kf.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new K(101,!1);let t=ue(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,ue(t),this.afterTick.next(),De(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(lo,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<bL;)De(14),this.synchronizeOnce(),De(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!Ku(i))continue;let o=r&&!this.zonelessEnabled?0:1;r0(i,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Ku(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;ec(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(nh,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>ec(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new K(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ec(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var EW=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function rn(n,e,t){let r=we(),i=hf();if(fo(r,i,e)){let o=tn(),s=Fy();KS(s,r,n,e,r[Be],t)}return rn}function zb(n,e,t,r,i){Kv(e,n,t,i?"class":"style",r)}function Re(n,e,t,r){let i=we(),o=i[oe],s=n+Dt,a=o.firstCreatePass?v0(s,i,2,e,QS,Cy(),t,r):o.data[s];if(YS(a,i,n,e,N0),Wu(a)){let u=i[oe];Gv(u,i,a),IS(u,a,i)}return r!=null&&Wv(i,a),Re}function Ve(){let n=tn(),e=Ct(),t=ZS(e);return n.firstCreatePass&&_0(n,t),Ty(t)&&by(),Dy(),t.classesWithoutHost!=null&&d1(t)&&zb(n,t,we(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&f1(t)&&zb(n,t,we(),t.stylesWithoutHost,!1),Ve}function gn(n,e,t,r){return Re(n,e,t,r),Ve(),gn}function Ls(n,e,t,r){let i=we(),o=i[oe],s=n+Dt,a=o.firstCreatePass?HV(s,o,2,e,t,r):o.data[s];return YS(a,i,n,e,N0),r!=null&&Wv(i,a),Ls}function js(){let n=Ct(),e=ZS(n);return Ty(e)&&by(),Dy(),js}var N0=(n,e,t,r,i)=>(Yu(!0),kv(e[Be],r,mb()));var lc="en-US";var SL={marker:"element"},AL={marker:"ICU"},Er=(function(n){return n[n.SHIFT=2]="SHIFT",n[n.APPEND_EAGERLY=1]="APPEND_EAGERLY",n[n.COMMENT=2]="COMMENT",n})(Er||{}),RL=lc;function x0(n){typeof n=="string"&&(RL=n.toLowerCase().replace(/_/g,"-"))}function ML(n,e,t){let r=n[Be];switch(t){case Node.COMMENT_NODE:return fF(r,e);case Node.TEXT_NODE:return RS(r,e);case Node.ELEMENT_NODE:return kv(r,e,null)}}var NL=(n,e,t,r)=>(Yu(!0),ML(n,t,r));function xL(n,e,t,r){let i=n[Be];for(let o=0;o<e.length;o++){let s=e[o++],a=e[o],u=(s&Er.COMMENT)===Er.COMMENT,l=(s&Er.APPEND_EAGERLY)===Er.APPEND_EAGERLY,d=s>>>Er.SHIFT,h=n[d],g=!1;h===null&&(h=n[d]=NL(n,d,a,u?Node.COMMENT_NODE:Node.TEXT_NODE),g=Qu()),l&&t!==null&&g&&Ns(i,t,h,r,!1)}}var jf=/(\d+):?\d*/gi;var PL=/(\d+)/,P0=/^\s*(\d+:?\d*)\s*,\s*(select|plural)\s*,/,tc="\uFFFD",OL=/\/?\*(\d+:\d+)/gi,kL=/(\/?[#*]\d+):?\d*/gi,FL=/\uE500/g;function VL(n){return n.replace(FL," ")}function LL(n,e,t,r,i,o){let s=bs(),a=[],u=[],l=[[]],d=[[]];i=BL(i,o);let h=VL(i).split(kL);for(let g=0;g<h.length;g++){let y=h[g];if((g&1)===0){let I=Ev(y);for(let b=0;b<I.length;b++){let S=I[b];if((b&1)===0){let O=S;O!==""&&jL(d[0],n,s,l[0],a,u,t,O)}else{let O=S;if(typeof O!="object")throw new Error(`Unable to parse ICU expression in "${i}" message.`);let V=O0(n,s,l[0],t,a,"",!0).index;F0(d[0],n,t,u,e,O,V)}}}else{let I=y.charCodeAt(0)===47,b=y.charCodeAt(I?1:0),S=Dt+Number.parseInt(y.substring(I?2:1));if(I)l.shift(),d.shift(),_r(bs(),!1);else{let O=TV(n,l[0],S);l.unshift([]),_r(O,!0);let q={kind:2,index:S,children:[],type:b===35?0:1};d[0].push(q),d.unshift(q.children)}}}n.data[r]={create:a,update:u,ast:d[0],parentTNodeIndex:e}}function O0(n,e,t,r,i,o,s){let a=ac(n,r,1,null),u=a<<Er.SHIFT,l=bs();e===l&&(l=null),l===null&&(u|=Er.APPEND_EAGERLY),s&&(u|=Er.COMMENT,_F(RV)),i.push(u,o===null?"":o);let d=Zv(n,a,s?32:1,o===null?"":o,null);d0(t,d);let h=d.index;return _r(d,!1),l!==null&&e!==l&&CV(l,h),d}function jL(n,e,t,r,i,o,s,a){let u=a.match(jf),d=O0(e,t,r,s,i,u?null:a,!1).index;u&&Cf(o,a,d,null,0,null),n.push({kind:0,index:d})}function Cf(n,e,t,r,i,o){let s=n.length,a=s+1;n.push(null,null);let u=s+2,l=e.split(jf),d=0;for(let h=0;h<l.length;h++){let g=l[h];if(h&1){let y=i+parseInt(g,10);n.push(-1-y),d=d|k0(y)}else g!==""&&n.push(g)}return n.push(t<<2|(r?1:0)),r&&n.push(r,o),n[s]=d,n[a]=n.length-u,d}function k0(n){return 1<<Math.min(n,31)}function Gb(n){let e,t="",r=0,i=!1,o;for(;(e=OL.exec(n))!==null;)i?e[0]===`${tc}/*${o}${tc}`&&(r=e.index,i=!1):(t+=n.substring(r,e.index+e[0].length),o=e[1],i=!0);return t+=n.slice(r),t}function BL(n,e){if(AV(e))return Gb(n);{let t=n.indexOf(`:${e}${tc}`)+2+e.toString().length,r=n.search(new RegExp(`${tc}\\/\\*\\d+:${e}${tc}`));return Gb(n.substring(t,r))}}function F0(n,e,t,r,i,o,s){let a=0,u={type:o.type,currentCaseLViewIndex:ac(e,t,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};qL(r,o,s),DV(e,s,u);let l=o.values,d=[];for(let h=0;h<l.length;h++){let g=l[h],y=[];for(let b=0;b<g.length;b++){let S=g[b];if(typeof S!="string"){let O=y.push(S)-1;g[b]=`<!--\uFFFD${O}\uFFFD-->`}}let I=[];d.push(I),a=$L(I,e,u,t,r,i,o.cases[h],g.join(""),y)|a}a&&zL(r,a,s),n.push({kind:3,index:s,cases:d,currentCaseLViewIndex:u.currentCaseLViewIndex})}function UL(n){let e=[],t=[],r=1,i=0;n=n.replace(P0,function(s,a,u){return u==="select"?r=0:r=1,i=parseInt(a.slice(1),10),""});let o=Ev(n);for(let s=0;s<o.length;){let a=o[s++].trim();r===1&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);let u=Ev(o[s++]);e.length>t.length&&t.push(u)}return{type:r,mainBinding:i,cases:e,values:t}}function Ev(n){if(!n)return[];let e=0,t=[],r=[],i=/[{}]/g;i.lastIndex=0;let o;for(;o=i.exec(n);){let a=o.index;if(o[0]=="}"){if(t.pop(),t.length==0){let u=n.substring(e,a);P0.test(u)?r.push(UL(u)):r.push(u),e=a+1}}else{if(t.length==0){let u=n.substring(e,a);r.push(u),e=a+1}t.push("{")}}let s=n.substring(e);return r.push(s),r}function $L(n,e,t,r,i,o,s,a,u){let l=[],d=[],h=[];t.cases.push(s),t.create.push(l),t.remove.push(d),t.update.push(h);let y=F1(Av()).getInertBodyElement(a),I=W1(y)||y;return I?V0(n,e,t,r,i,l,d,h,I,o,u,0):0}function V0(n,e,t,r,i,o,s,a,u,l,d,h){let g=0,y=u.firstChild;for(;y;){let I=ac(e,r,1,null);switch(y.nodeType){case Node.ELEMENT_NODE:let b=y,S=b.tagName.toLowerCase();if(H1.hasOwnProperty(S)){Qy(o,SL,S,l,I),e.data[I]=S;let Y=b.attributes;for(let te=0;te<Y.length;te++){let w=Y.item(te),v=w.name.toLowerCase();!!w.value.match(jf)?G1.hasOwnProperty(v)&&(bS[v]?Cf(a,w.value,I,w.name,0,xv):Cf(a,w.value,I,w.name,0,null)):GL(o,I,w)}let ee={kind:1,index:I,children:[]};n.push(ee),g=V0(ee.children,e,t,r,i,o,s,a,y,I,d,h+1)|g,Wb(s,I,h)}break;case Node.TEXT_NODE:let O=y.textContent||"",q=O.match(jf);Qy(o,null,q?"":O,l,I),Wb(s,I,h),q&&(g=Cf(a,O,I,null,0,null)|g),n.push({kind:0,index:I});break;case Node.COMMENT_NODE:let V=PL.exec(y.textContent||"");if(V){let Y=parseInt(V[1],10),ee=d[Y];Qy(o,AL,"",l,I),F0(n,e,r,i,l,ee,I),HL(s,I,h)}break}y=y.nextSibling}return g}function Wb(n,e,t){t===0&&n.push(e)}function HL(n,e,t){t===0&&(n.push(~e),n.push(e))}function qL(n,e,t){n.push(k0(e.mainBinding),2,-1-e.mainBinding,t<<2|2)}function zL(n,e,t){n.push(e,1,t<<2|3)}function Qy(n,e,t,r,i){e!==null&&n.push(e),n.push(t,i,SV(0,r,i))}function GL(n,e,t){n.push(e<<1|1,t.name,t.value)}function L0(n,e,t=-1){let r=tn(),i=we(),o=Dt+n,s=ni(r.consts,e),a=bs();if(r.firstCreatePass&&LL(r,a===null?0:a.index,i,o,s,t),r.type===2){let g=i[Xt];g[ne]|=32}else i[ne]|=32;let u=r.data[o],l=a===i[Zt]?null:a,d=$S(r,l,i),h=a&&a.type&8?i[a.index]:null;NV(i,o,a,t),xL(i,u.create,d,h),xy(!0)}function j0(){xy(!1)}function on(n,e,t){L0(n,e,t),j0()}function li(n,e,t){let r=we(),i=tn(),o=Ct();return B0(i,r,r[Be],o,n,e,t),li}function B0(n,e,t,r,i,o,s){let a=!0,u=null;if((r.type&3||s)&&(u??=Gy(r,e,o),GV(r,n,e,s,t,i,o,u)&&(a=!1)),a){let l=r.outputs?.[i],d=r.hostDirectiveOutputs?.[i];if(d&&d.length)for(let h=0;h<d.length;h+=2){let g=d[h],y=d[h+1];u??=Gy(r,e,o),Ub(r,e,g,y,i,u)}if(l&&l.length)for(let h of l)u??=Gy(r,e,o),Ub(r,e,h,i,i,u)}}function Ef(n,e){return n<<17|e<<2}function ho(n){return n>>17&32767}function WL(n){return(n&2)==2}function KL(n,e){return n&131071|e<<17}function Iv(n){return n|2}function ks(n){return(n&131068)>>2}function Yy(n,e){return n&-131069|e<<2}function QL(n){return(n&1)===1}function wv(n){return n|1}function YL(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=ho(s),u=ks(s);n[r]=t;let l=!1,d;if(Array.isArray(t)){let h=t;d=h[1],(d===null||Es(h,d)>0)&&(l=!0)}else d=t;if(i)if(u!==0){let g=ho(n[a+1]);n[r+1]=Ef(g,a),g!==0&&(n[g+1]=Yy(n[g+1],r)),n[a+1]=KL(n[a+1],r)}else n[r+1]=Ef(a,0),a!==0&&(n[a+1]=Yy(n[a+1],r)),a=r;else n[r+1]=Ef(u,0),a===0?a=r:n[u+1]=Yy(n[u+1],r),u=r;l&&(n[r+1]=Iv(n[r+1])),Kb(n,d,r,!0),Kb(n,d,r,!1),ZL(e,d,n,r,o),s=Ef(a,u),o?e.classBindings=s:e.styleBindings=s}function ZL(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Es(o,e)>=0&&(t[r+1]=wv(t[r+1]))}function Kb(n,e,t,r){let i=n[t+1],o=e===null,s=r?ho(i):ks(i),a=!1;for(;s!==0&&(a===!1||o);){let u=n[s],l=n[s+1];XL(u,e)&&(a=!0,n[s+1]=r?wv(l):Iv(l)),s=r?ho(l):ks(l)}a&&(n[t+1]=r?Iv(i):wv(i))}function XL(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Es(n,e)>=0:!1}function rh(n,e){return JL(n,e,null,!0),rh}function JL(n,e,t,r){let i=we(),o=tn(),s=Ny(2);if(o.firstUpdatePass&&tj(o,n,s,r),e!==Sn&&fo(i,s,e)){let a=o.data[ri()];sj(o,a,i,i[Be],n,i[s+1]=aj(e,t),r,s)}}function ej(n,e){return e>=n.expandoStartIndex}function tj(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[ri()],s=ej(n,t);uj(o,r)&&e===null&&!s&&(e=!1),e=nj(i,o,e,r),YL(i,o,e,t,s,r)}}function nj(n,e,t,r){let i=fb(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Zy(null,n,e,t,r),t=ic(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=Zy(i,n,e,t,r),o===null){let u=rj(n,e,r);u!==void 0&&Array.isArray(u)&&(u=Zy(null,n,e,u[1],r),u=ic(u,e.attrs,r),ij(n,e,r,u))}else o=oj(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function rj(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ks(r)!==0)return n[ho(r)]}function ij(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[ho(i)]=r}function oj(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=ic(r,s,t)}return ic(r,e.attrs,t)}function Zy(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=ic(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function ic(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),$T(n,s,t?!0:e[++o]))}return n===void 0?null:n}function sj(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let u=n.data,l=u[a+1],d=QL(l)?Qb(u,e,t,i,ks(l),s):void 0;if(!Bf(d)){Bf(o)||WL(l)&&(o=Qb(u,null,t,i,a,s));let h=_y(ri(),t);BF(r,s,h,i,o)}}function Qb(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let u=n[i],l=Array.isArray(u),d=l?u[1]:u,h=d===null,g=t[i+1];g===Sn&&(g=h?jt:void 0);let y=h?af(g,r):d===r?g:void 0;if(l&&!Bf(y)&&(y=af(u,r)),Bf(y)&&(a=y,s))return a;let I=n[i+1];i=s?ho(I):ks(I)}if(e!==null){let u=o?e.residualClasses:e.residualStyles;u!=null&&(a=af(u,r))}return a}function Bf(n){return n!==void 0}function aj(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=mr(Nv(n)))),n}function uj(n,e){return(n.flags&(e?8:16))!==0}function Ht(n,e=""){let t=we(),r=tn(),i=n+Dt,o=r.firstCreatePass?Jf(r,i,1,e,null):r.data[i],s=cj(r,t,o,e,n);t[i]=s,Qu()&&qv(r,t,s,o),_r(o,!1)}var cj=(n,e,t,r,i)=>(Yu(!0),RS(e[Be],r));function lj(n,e,t,r=""){return fo(n,hf(),t)?e+_s(t)+r:Sn}function dj(n,e,t,r,i,o=""){let s=ab(),a=zV(n,s,t,i);return Ny(2),a?e+_s(t)+r+_s(i)+o:Sn}function br(n){return dc("",n),br}function dc(n,e,t){let r=we(),i=lj(r,n,e,t);return i!==Sn&&U0(r,ri(),i),dc}function ih(n,e,t,r,i){let o=we(),s=dj(o,n,e,t,r,i);return s!==Sn&&U0(o,ri(),s),ih}function U0(n,e,t){let r=_y(e,n);dF(n[Be],r,t)}function fc(n,e,t){jy(e)&&(e=e());let r=we(),i=hf();if(fo(r,i,e)){let o=tn(),s=Fy();KS(s,r,n,e,r[Be],t)}return fc}function oh(n,e){let t=jy(n);return t&&n.set(e),t}function hc(n,e){let t=we(),r=tn(),i=Ct();return B0(r,t,t[Be],i,n,e),hc}function fj(n,e,t){let r=tn();if(r.firstCreatePass){let i=$n(n);Dv(t,r.data,r.blueprint,i,!0),Dv(e,r.data,r.blueprint,i,!1)}}function Dv(n,e,t,r,i){if(n=lt(n),Array.isArray(n))for(let o=0;o<n.length;o++)Dv(n[o],e,t,r,i);else{let o=tn(),s=we(),a=Ct(),u=eo(n)?n:lt(n.provide),l=gy(n),d=a.providerIndexes&1048575,h=a.directiveStart,g=a.providerIndexes>>20;if(eo(n)||!n.multi){let y=new co(l,i,_e,null),I=Jy(u,e,i?d:d+g,h);I===-1?(tv(Af(a,s),o,u),Xy(o,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),s.push(y)):(t[I]=y,s[I]=y)}else{let y=Jy(u,e,d+g,h),I=Jy(u,e,d,d+g),b=y>=0&&t[y],S=I>=0&&t[I];if(i&&!S||!i&&!b){tv(Af(a,s),o,u);let O=gj(i?pj:hj,t.length,i,r,l,n);!i&&S&&(t[I].providerFactory=O),Xy(o,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(O),s.push(O)}else{let O=$0(t[i?I:y],l,!i&&r);Xy(o,n,y>-1?y:I,O)}!i&&r&&S&&t[I].componentProviders++}}}function Xy(n,e,t,r){let i=eo(e),o=WT(e);if(i||o){let u=(o?lt(e.useClass):e).prototype.ngOnDestroy;if(u){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,u]):l[d+1].push(r,u)}else l.push(t,u)}}}function $0(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Jy(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function hj(n,e,t,r,i){return Cv(this.multi,[])}function pj(n,e,t,r,i){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,u=Rf(r,r[oe],this.providerFactory.index,i);s=u.slice(0,a),Cv(o,s);for(let l=a;l<u.length;l++)s.push(u[l])}else s=[],Cv(o,s);return s}function Cv(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function gj(n,e,t,r,i,o){let s=new co(n,t,_e,null);return s.multi=[],s.index=e,s.componentProviders=0,$0(s,i,r&&!t),s}function Bs(n,e=[]){return t=>{t.providersResolver=(r,i)=>fj(r,i?i(n):n,e)}}function n_(n,e,t,r){return yj(we(),sb(),n,e,t,r)}function mj(n,e){let t=n[e];return t===Sn?void 0:t}function yj(n,e,t,r,i,o){let s=e+t;return fo(n,s,i)?qV(n,s+1,o?r.call(o,i):r(i)):mj(n,s+1)}var Uf=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},r_=(()=>{class n{compileModuleSync(t){return new Lf(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=dy(t),o=SS(i.declarations).reduce((s,a)=>{let u=Xr(a);return u&&s.push(new Ps(u)),s},[]);return new Uf(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var vj=(()=>{class n{zone=F(be);changeDetectionScheduler=F(yr);applicationRef=F(Tr);applicationErrorHandler=F(pn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function H0({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new be(ce(j({},q0()),{scheduleInRootZone:t})),[{provide:be,useFactory:n},{provide:Zr,multi:!0,useFactory:()=>{let r=F(vj,{optional:!0});return()=>r.initialize()}},{provide:Zr,multi:!0,useFactory:()=>{let r=F(_j);return()=>{r.initialize()}}},e===!0?{provide:By,useValue:!0}:[],{provide:Uy,useValue:t??OS},{provide:pn,useFactory:()=>{let r=F(be),i=F(Fe),o;return s=>{r.runOutsideAngular(()=>{i.destroyed&&!o?setTimeout(()=>{throw s}):(o??=i.get(In),o.handleError(s))})}}}]}function q0(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var _j=(()=>{class n{subscription=new He;initialized=!1;zone=F(be);pendingTasks=F(Gn);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{be.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{be.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var z0=(()=>{class n{applicationErrorHandler=F(pn);appRef=F(Tr);taskService=F(Gn);ngZone=F(be);zonelessEnabled=F(vf);tracing=F(po,{optional:!0});disableScheduling=F(By,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new He;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Nf):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(F(Uy,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof xf||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?Mb:kS;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Nf+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Mb(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ej(){return typeof $localize<"u"&&$localize.locale||lc}var i_=new z("",{providedIn:"root",factory:()=>F(i_,{optional:!0,skipSelf:!0})||Ej()});function Pt(n){return NT(n)}function pc(n,e){return Dd(n,e?.equal)}var G0=class{[Et];constructor(e){this[Et]=e}destroy(){this[Et].destroy()}};var Z0=Symbol("InputSignalNode#UNSET"),Oj=ce(j({},Cd),{transformFn:void 0,applyValueToInputSignal(n,e){is(n,e)}});function X0(n,e){let t=Object.create(Oj);t.value=n,t.transformFn=e?.transform;function r(){if(ts(t),t.value===Z0){let i=null;throw new K(-950,i)}return t.value}return r[Et]=t,r}var kj=new z("");kj.__NG_ELEMENT_ID__=n=>{let e=Ct();if(e===null)throw new K(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new K(204,!1)};function W0(n,e){return X0(n,e)}function Fj(n){return X0(Z0,n)}var J0=(W0.required=Fj,W0);var o_=new z(""),Vj=new z("");function gc(n){return!n.moduleRef}function Lj(n){let e=gc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(be);return t.run(()=>{gc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(pn),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),gc(n)){let o=()=>e.destroy(),s=n.platformInjector.get(o_);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(o_);s.add(o),n.moduleRef.onDestroy(()=>{ec(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return Bj(r,t,()=>{let o=e.get(Gn),s=o.add(),a=e.get(t_);return a.runInitializers(),a.donePromise.then(()=>{let u=e.get(i_,lc);if(x0(u||lc),!e.get(Vj,!0))return gc(n)?e.get(Tr):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(gc(n)){let d=e.get(Tr);return n.rootComponent!==void 0&&d.bootstrap(n.rootComponent),d}else return jj?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(s))})})}var jj;function Bj(n,e,t){try{let r=t();return go(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var sh=null;function Uj(n=[],e){return Bt.create({name:e,providers:[{provide:ju,useValue:"platform"},{provide:o_,useValue:new Set([()=>sh=null])},...n]})}function $j(n=[]){if(sh)return sh;let e=Uj(n);return sh=e,R0(),Hj(e),e}function Hj(n){let e=n.get(qf,null);wt(n,()=>{e?.forEach(t=>t())})}function mc(){return!1}var Us=(()=>{class n{static __NG_ELEMENT_ID__=qj}return n})();function qj(n){return zj(Ct(),we(),(n&16)===16)}function zj(n,e,t){if(ti(n)&&!t){let r=hn(n.index,e);return new oi(r,r)}else if(n.type&175){let r=e[Xt];return new oi(r,e)}return null}var s_=class{constructor(){}supports(e){return Xv(e)}create(e){return new a_(e)}},Gj=(n,e)=>e,a_=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||Gj}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<K0(r,i,o)?t:r,a=K0(s,i,o),u=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,d=u-i;if(l!=d){for(let g=0;g<l;g++){let y=g<o.length?o[g]:o[g]=0,I=y+g;d<=I&&I<l&&(o[g]=y+1)}let h=s.previousIndex;o[h]=d-l}}a!==u&&e(s,a,u)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!Xv(e))throw new K(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,E0(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new u_(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new ah),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new ah),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},u_=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},c_=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},ah=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new c_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function K0(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function Q0(){return new l_([new s_])}var l_=(()=>{class n{factories;static \u0275prov=W({token:n,providedIn:"root",factory:Q0});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=F(n,{optional:!0,skipSelf:!0});return n.create(t,r||Q0())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new K(901,!1)}}return n})();function eA(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;De(8);try{let o=i?.injector??$j(r),s=[H0({}),{provide:yr,useExisting:z0},vb,...t||[]],a=new rc({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return Lj({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{De(9)}}function d_(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var rA=null;function mn(){return rA}function f_(n){rA??=n}var yc=class{},h_=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>F(iA),providedIn:"platform"})}return n})();var iA=(()=>{class n extends h_{_location;_history;_doc=F(ft);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return mn().getBaseHref(this._doc)}onPopState(t){let r=mn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=mn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function oA(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function tA(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function di(n){return n&&n[0]!=="?"?`?${n}`:n}var uh=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>F(aA),providedIn:"root"})}return n})(),sA=new z(""),aA=(()=>{class n extends uh{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??F(ft).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return oA(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+di(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+di(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+di(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)($(h_),$(sA,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$s=(()=>{class n{_subject=new xe;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=Qj(tA(nA(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+di(r))}normalize(t){return n.stripTrailingSlash(Kj(this._basePath,nA(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+di(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+di(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=di;static joinWithSlash=oA;static stripTrailingSlash=tA;static \u0275fac=function(r){return new(r||n)($(uh))};static \u0275prov=W({token:n,factory:()=>Wj(),providedIn:"root"})}return n})();function Wj(){return new $s($(uh))}function Kj(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function nA(n){return n.replace(/\/index.html$/,"")}function Qj(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var p_=/\s+/,uA=[],g_=(()=>{class n{_ngEl;_renderer;initialClasses=uA;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(p_):uA}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(p_):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(p_).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(_e(Dr),_e(ui))};static \u0275dir=Tt({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var ch=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Hs=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new ch(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),cA(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);cA(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(_e(Vs),_e(Xf),_e(l_))};static \u0275dir=Tt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function cA(n,e){n.context.$implicit=e.item}var fi=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Kn({type:n});static \u0275inj=wn({})}return n})();function m_(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var vc=class{};var lA="browser",Yj="server";function lh(n){return n===Yj}var _c=class{_doc;constructor(e){this._doc=e}manager},dh=(()=>{class n extends _c{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)($(ft))};static \u0275prov=W({token:n,factory:n.\u0275fac})}return n})(),hh=new z(""),w_=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(s=>{s.manager=this});let i=t.filter(s=>!(s instanceof dh));this._plugins=i.slice().reverse();let o=t.find(s=>s instanceof dh);o&&this._plugins.push(o)}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new K(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)($(hh),$(be))};static \u0275prov=W({token:n,factory:n.\u0275fac})}return n})(),v_="ng-app-id";function dA(n){for(let e of n)e.remove()}function fA(n,e){let t=e.createElement("style");return t.textContent=n,t}function Zj(n,e,t,r){let i=n.head?.querySelectorAll(`style[${v_}="${e}"],link[${v_}="${e}"]`);if(i)for(let o of i)o.removeAttribute(v_),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function E_(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var D_=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,Zj(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,fA);r?.forEach(i=>this.addUsage(i,this.external,E_))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(dA(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])dA(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,fA(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,E_(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)($(ft),$(Hf),$(zf,8),$(bn))};static \u0275prov=W({token:n,factory:n.\u0275fac})}return n})(),__={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},C_=/%COMP%/g;var pA="%COMP%",Xj=`_nghost-${pA}`,Jj=`_ngcontent-${pA}`,e2=!0,t2=new z("",{providedIn:"root",factory:()=>e2});function n2(n){return Jj.replace(C_,n)}function r2(n){return Xj.replace(C_,n)}function gA(n,e){return e.map(t=>t.replace(C_,n))}var T_=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,u,l=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=u,this.nonce=l,this.tracingService=d,this.platformIsServer=!1,this.defaultRenderer=new Ec(t,s,u,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof fh?i.applyToHost(t):i instanceof Ic&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer,g=this.tracingService;switch(r.encapsulation){case Ir.Emulated:o=new fh(u,l,r,this.appId,d,s,a,h,g);break;case Ir.ShadowDom:return new I_(u,l,t,r,s,a,this.nonce,h,g);default:o=new Ic(u,l,r,d,s,a,h,g);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)($(w_),$(D_),$(Hf),$(t2),$(ft),$(bn),$(be),$(zf),$(po,8))};static \u0275prov=W({token:n,factory:n.\u0275fac})}return n})(),Ec=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(__[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(hA(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(hA(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new K(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=__[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=__[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(wr.DashCase|wr.Important)?e.style.setProperty(t,r,i&wr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&wr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=mn().getGlobalEventTarget(this.doc,e),!e))throw new K(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function hA(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var I_=class extends Ec{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,u,l){super(e,o,s,u,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=i.styles;d=gA(i.id,d);for(let g of d){let y=document.createElement("style");a&&y.setAttribute("nonce",a),y.textContent=g,this.shadowRoot.appendChild(y)}let h=i.getExternalStyles?.();if(h)for(let g of h){let y=E_(g,o);a&&y.setAttribute("nonce",a),this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ic=class extends Ec{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,u,l){super(e,o,s,a,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let d=r.styles;this.styles=l?gA(l,d):d,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&xs.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},fh=class extends Ic{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,u,l){let d=i+"-"+r.id;super(e,t,r,o,s,a,u,l,d),this.contentAttr=n2(d),this.hostAttr=r2(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var ph=class n extends yc{supportsDOMEvents=!0;static makeCurrent(){f_(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=i2();return t==null?null:o2(t)}resetBaseElement(){wc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return m_(document.cookie,e)}},wc=null;function i2(){return wc=wc||document.head.querySelector("base"),wc?wc.getAttribute("href"):null}function o2(n){return new URL(n,document.baseURI).pathname}var s2=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac})}return n})(),mA=["alt","control","meta","shift"],a2={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},u2={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},yA=(()=>{class n extends _c{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>mn().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),mA.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let u={};return u.domEventName=i,u.fullKey=s,u}static matchEventFullKeyCode(t,r){let i=a2[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),mA.forEach(s=>{if(s!==i){let a=u2[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)($(ft))};static \u0275prov=W({token:n,factory:n.\u0275fac})}return n})();function b_(n,e,t){let r=j({rootComponent:n,platformRef:t?.platformRef},c2(e));return eA(r)}function c2(n){return{appProviders:[...p2,...n?.providers??[]],platformProviders:h2}}function l2(){ph.makeCurrent()}function d2(){return new In}function f2(){return Sv(document),document}var h2=[{provide:bn,useValue:lA},{provide:qf,useValue:l2,multi:!0},{provide:ft,useFactory:f2}];var p2=[{provide:ju,useValue:"root"},{provide:In,useFactory:d2},{provide:hh,useClass:dh,multi:!0,deps:[ft]},{provide:hh,useClass:yA,multi:!0,deps:[ft]},T_,D_,w_,{provide:lo,useExisting:T_},{provide:vc,useClass:s2},[]];var vA=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)($(ft))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var se="primary",Vc=Symbol("RouteTitle"),N_=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function vo(n){return new N_(n)}function bA(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function m2(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Qn(n[t],e[t]))return!1;return!0}function Qn(n,e){let t=n?x_(n):void 0,r=e?x_(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!SA(n[i],e[i]))return!1;return!0}function x_(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function SA(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function AA(n){return n.length>0?n[n.length-1]:null}function Rr(n){return Om(n)?n:go(n)?ve(Promise.resolve(n)):Z(n)}var y2={exact:MA,subset:NA},RA={exact:v2,subset:_2,ignored:()=>!0};function _A(n,e,t){return y2[t.paths](n.root,e.root,t.matrixParams)&&RA[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function v2(n,e){return Qn(n,e)}function MA(n,e,t){if(!mo(n.segments,e.segments)||!yh(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!MA(n.children[r],e.children[r],t))return!1;return!0}function _2(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>SA(n[t],e[t]))}function NA(n,e,t){return xA(n,e,e.segments,t)}function xA(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!mo(i,t)||e.hasChildren()||!yh(i,t,r))}else if(n.segments.length===t.length){if(!mo(n.segments,t)||!yh(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!NA(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!mo(n.segments,i)||!yh(n.segments,i,r)||!n.children[se]?!1:xA(n.children[se],e,o,r)}}function yh(n,e,t){return e.every((r,i)=>RA[t](n[i].parameters,r.parameters))}var Zn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Ee([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=vo(this.queryParams),this._queryParamMap}toString(){return w2.serialize(this)}},Ee=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vh(this)}},hi=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=vo(this.parameters),this._parameterMap}toString(){return OA(this)}};function E2(n,e){return mo(n,e)&&n.every((t,r)=>Qn(t.parameters,e[r].parameters))}function mo(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function I2(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===se&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==se&&(t=t.concat(e(i,r)))}),t}var Lc=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>new _o,providedIn:"root"})}return n})(),_o=class{parse(e){let t=new O_(e);return new Zn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Dc(e.root,!0)}`,r=T2(e.queryParams),i=typeof e.fragment=="string"?`#${D2(e.fragment)}`:"";return`${t}${r}${i}`}},w2=new _o;function vh(n){return n.segments.map(e=>OA(e)).join("/")}function Dc(n,e){if(!n.hasChildren())return vh(n);if(e){let t=n.children[se]?Dc(n.children[se],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==se&&r.push(`${i}:${Dc(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=I2(n,(r,i)=>i===se?[Dc(n.children[se],!1)]:[`${i}:${Dc(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[se]!=null?`${vh(n)}/${t[0]}`:`${vh(n)}/(${t.join("//")})`}}function PA(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function gh(n){return PA(n).replace(/%3B/gi,";")}function D2(n){return encodeURI(n)}function P_(n){return PA(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _h(n){return decodeURIComponent(n)}function EA(n){return _h(n.replace(/\+/g,"%20"))}function OA(n){return`${P_(n.path)}${C2(n.parameters)}`}function C2(n){return Object.entries(n).map(([e,t])=>`;${P_(e)}=${P_(t)}`).join("")}function T2(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${gh(t)}=${gh(i)}`).join("&"):`${gh(t)}=${gh(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var b2=/^[^\/()?;#]+/;function S_(n){let e=n.match(b2);return e?e[0]:""}var S2=/^[^\/()?;=#]+/;function A2(n){let e=n.match(S2);return e?e[0]:""}var R2=/^[^=?&#]+/;function M2(n){let e=n.match(R2);return e?e[0]:""}var N2=/^[^&#]+/;function x2(n){let e=n.match(N2);return e?e[0]:""}var O_=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ee([],{}):new Ee([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[se]=new Ee(e,t)),r}parseSegment(){let e=S_(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new K(4009,!1);return this.capture(e),new hi(_h(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=A2(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=S_(this.remaining);i&&(r=i,this.capture(r))}e[_h(t)]=_h(r)}parseQueryParam(e){let t=M2(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=x2(this.remaining);s&&(r=s,this.capture(r))}let i=EA(t),o=EA(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=S_(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new K(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=se);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[se]:new Ee([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new K(4011,!1)}};function kA(n){return n.segments.length>0?new Ee([],{[se]:n}):n}function FA(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=FA(i);if(r===se&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new Ee(n.segments,e);return P2(t)}function P2(n){if(n.numberOfChildren===1&&n.children[se]){let e=n.children[se];return new Ee(n.segments.concat(e.segments),e.children)}return n}function Ks(n){return n instanceof Zn}function VA(n,e,t=null,r=null){let i=LA(n);return jA(i,e,t,r)}function LA(n){let e;function t(o){let s={};for(let u of o.children){let l=t(u);s[u.outlet]=l}let a=new Ee(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=kA(r);return e??i}function jA(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return A_(i,i,i,t,r);let o=O2(e);if(o.toRoot())return A_(i,i,new Ee([],{}),t,r);let s=k2(o,i,n),a=s.processChildren?Tc(s.segmentGroup,s.index,o.commands):UA(s.segmentGroup,s.index,o.commands);return A_(i,s.segmentGroup,a,t,r)}function Eh(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Ac(n){return typeof n=="object"&&n!=null&&n.outlets}function A_(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([u,l])=>{o[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let s;n===e?s=t:s=BA(n,e,t);let a=kA(FA(s));return new Zn(a,o,i)}function BA(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=BA(o,e,t)}),new Ee(n.segments,r)}var Ih=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Eh(r[0]))throw new K(4003,!1);let i=r.find(Ac);if(i&&i!==AA(r))throw new K(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function O2(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Ih(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new Ih(t,e,r)}var Gs=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function k2(n,e,t){if(n.isAbsolute)return new Gs(e,!0,0);if(!t)return new Gs(e,!1,NaN);if(t.parent===null)return new Gs(t,!0,0);let r=Eh(n.commands[0])?0:1,i=t.segments.length-1+r;return F2(t,i,n.numberOfDoubleDots)}function F2(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new K(4005,!1);i=r.segments.length}return new Gs(r,!1,i-o)}function V2(n){return Ac(n[0])?n[0].outlets:{[se]:n}}function UA(n,e,t){if(n??=new Ee([],{}),n.segments.length===0&&n.hasChildren())return Tc(n,e,t);let r=L2(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new Ee(n.segments.slice(0,r.pathIndex),{});return o.children[se]=new Ee(n.segments.slice(r.pathIndex),n.children),Tc(o,0,i)}else return r.match&&i.length===0?new Ee(n.segments,{}):r.match&&!n.hasChildren()?k_(n,e,t):r.match?Tc(n,0,i):k_(n,e,t)}function Tc(n,e,t){if(t.length===0)return new Ee(n.segments,{});{let r=V2(t),i={};if(Object.keys(r).some(o=>o!==se)&&n.children[se]&&n.numberOfChildren===1&&n.children[se].segments.length===0){let o=Tc(n.children[se],e,t);return new Ee(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=UA(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new Ee(n.segments,i)}}function L2(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Ac(a))break;let u=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!wA(u,l,s))return o;r+=2}else{if(!wA(u,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function k_(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Ac(o)){let u=j2(o.outlets);return new Ee(r,u)}if(i===0&&Eh(t[0])){let u=n.segments[e];r.push(new hi(u.path,IA(t[0]))),i++;continue}let s=Ac(o)?o.outlets[se]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Eh(a)?(r.push(new hi(s,IA(a))),i+=2):(r.push(new hi(s,{})),i++)}return new Ee(r,{})}function j2(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=k_(new Ee([],{}),0,r))}),e}function IA(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function wA(n,e,t){return n==t.path&&Qn(e,t.parameters)}var bc="imperative",st=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(st||{}),an=class{id;url;constructor(e,t){this.id=e,this.url=t}},Eo=class extends an{type=st.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Sr=class extends an{urlAfterRedirects;type=st.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Ot=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Ot||{}),Rc=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Rc||{}),Yn=class extends an{reason;code;type=st.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ar=class extends an{reason;code;type=st.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Qs=class extends an{error;target;type=st.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Mc=class extends an{urlAfterRedirects;state;type=st.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},wh=class extends an{urlAfterRedirects;state;type=st.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dh=class extends an{urlAfterRedirects;state;shouldActivate;type=st.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ch=class extends an{urlAfterRedirects;state;type=st.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Th=class extends an{urlAfterRedirects;state;type=st.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bh=class{route;type=st.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Sh=class{route;type=st.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ah=class{snapshot;type=st.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Rh=class{snapshot;type=st.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mh=class{snapshot;type=st.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nh=class{snapshot;type=st.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Nc=class{},Ys=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function B2(n){return!(n instanceof Nc)&&!(n instanceof Ys)}function U2(n,e){return n.providers&&!n._injector&&(n._injector=cc(n.providers,e,`Route: ${n.path}`)),n._injector??e}function An(n){return n.outlet||se}function $2(n,e){let t=n.filter(r=>An(r)===e);return t.push(...n.filter(r=>An(r)!==e)),t}function Js(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var xh=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Js(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new ea(this.rootInjector)}},ea=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new xh(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)($(Fe))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ph=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=F_(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=F_(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=V_(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return V_(e,this._root).map(t=>t.value)}};function F_(n,e){if(n===e.value)return e;for(let t of e.children){let r=F_(n,t);if(r)return r}return null}function V_(n,e){if(n===e.value)return[e];for(let t of e.children){let r=V_(n,t);if(r.length)return r.unshift(e),r}return[]}var sn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function zs(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var xc=class extends Ph{snapshot;constructor(e,t){super(e),this.snapshot=t,z_(this,e)}toString(){return this.snapshot.toString()}};function $A(n){let e=H2(n),t=new ut([new hi("",{})]),r=new ut({}),i=new ut({}),o=new ut({}),s=new ut(""),a=new pi(t,r,o,s,i,se,n,e.root);return a.snapshot=e.root,new xc(new sn(a,[]),e)}function H2(n){let e={},t={},r={},o=new yo([],e,r,"",t,se,n,null,{});return new Pc("",new sn(o,[]))}var pi=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(X(l=>l[Vc]))??Z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(X(e=>vo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(X(e=>vo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Oh(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:j(j({},e.params),n.params),data:j(j({},e.data),n.data),resolve:j(j(j(j({},n.data),e.data),i?.data),n._resolvedData)}:r={params:j({},n.params),data:j({},n.data),resolve:j(j({},n.data),n._resolvedData??{})},i&&qA(i)&&(r.resolve[Vc]=i.title),r}var yo=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Vc]}constructor(e,t,r,i,o,s,a,u,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=vo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=vo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Pc=class extends Ph{url;constructor(e,t){super(t),this.url=e,z_(this,t)}toString(){return HA(this._root)}};function z_(n,e){e.value._routerState=n,e.children.forEach(t=>z_(n,t))}function HA(n){let e=n.children.length>0?` { ${n.children.map(HA).join(", ")} } `:"";return`${n.value}${e}`}function R_(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Qn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Qn(e.params,t.params)||n.paramsSubject.next(t.params),m2(e.url,t.url)||n.urlSubject.next(t.url),Qn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function L_(n,e){let t=Qn(n.params,e.params)&&E2(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||L_(n.parent,e.parent))}function qA(n){return typeof n.title=="string"||n.title===null}var zA=new z(""),jc=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=se;activateEvents=new nt;deactivateEvents=new nt;attachEvents=new nt;detachEvents=new nt;routerOutletData=J0(void 0);parentContexts=F(ea);location=F(Vs);changeDetector=F(Us);inputBinder=F(Lh,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new K(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new K(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new K(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new K(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new j_(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Tt({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Fs]})}return n})(),j_=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===pi?this.route:e===ea?this.childContexts:e===zA?this.outletData:this.parent.get(e,t)}},Lh=new z("");var G_=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&gn(0,"router-outlet")},dependencies:[jc],encapsulation:2})}return n})();function W_(n){let e=n.children&&n.children.map(W_),t=e?ce(j({},n),{children:e}):j({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==se&&(t.component=G_),t}function q2(n,e,t){let r=Oc(n,e._root,t?t._root:void 0);return new xc(r,e)}function Oc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=z2(n,e,t);return new sn(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>Oc(n,a)),s}}let r=G2(e.value),i=e.children.map(o=>Oc(n,o));return new sn(r,i)}}function z2(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Oc(n,r,i);return Oc(n,r)})}function G2(n){return new pi(new ut(n.url),new ut(n.params),new ut(n.queryParams),new ut(n.fragment),new ut(n.data),n.outlet,n.component,n)}var Zs=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},GA="ngNavigationCancelingError";function kh(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Ks(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=WA(!1,Ot.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function WA(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[GA]=!0,t.cancellationCode=e,t}function W2(n){return KA(n)&&Ks(n.url)}function KA(n){return!!n&&n[GA]}var K2=(n,e,t,r)=>X(i=>(new B_(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),B_=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),R_(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=zs(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=zs(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=zs(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=zs(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Nh(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Rh(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(R_(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),R_(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Fh=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ws=class{component;route;constructor(e,t){this.component=e,this.route=t}};function Q2(n,e,t){let r=n._root,i=e?e._root:null;return Cc(r,i,t,[r.value])}function Y2(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function ta(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!ey(n)?n:e.get(n):r}function Cc(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=zs(e);return n.children.forEach(s=>{Z2(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Sc(a,t.getContext(s),i)),i}function Z2(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let u=X2(s,o,o.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Fh(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Cc(n,e,a?a.children:null,r,i):Cc(n,e,t,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ws(a.outlet.component,s))}else s&&Sc(e,a,i),i.canActivateChecks.push(new Fh(r)),o.component?Cc(n,null,a?a.children:null,r,i):Cc(n,null,t,r,i);return i}function X2(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!mo(n.url,e.url);case"pathParamsOrQueryParamsChange":return!mo(n.url,e.url)||!Qn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!L_(n,e)||!Qn(n.queryParams,e.queryParams);case"paramsChange":default:return!L_(n,e)}}function Sc(n,e,t){let r=zs(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Sc(s,e.children.getContext(o),t):Sc(s,null,t):Sc(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ws(e.outlet.component,i)):t.canDeactivateChecks.push(new Ws(null,i)):t.canDeactivateChecks.push(new Ws(null,i))}function Bc(n){return typeof n=="function"}function J2(n){return typeof n=="boolean"}function eB(n){return n&&Bc(n.canLoad)}function tB(n){return n&&Bc(n.canActivate)}function nB(n){return n&&Bc(n.canActivateChild)}function rB(n){return n&&Bc(n.canDeactivate)}function iB(n){return n&&Bc(n.canMatch)}function QA(n){return n instanceof hr||n?.name==="EmptyError"}var mh=Symbol("INITIAL_VALUE");function Xs(){return ke(n=>Wd(n.map(e=>e.pipe(pr(1),Yi(mh)))).pipe(X(e=>{for(let t of e)if(t!==!0){if(t===mh)return mh;if(t===!1||oB(t))return t}return!0}),ct(e=>e!==mh),pr(1)))}function oB(n){return Ks(n)||n instanceof Zs}function sB(n,e){return tt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Z(ce(j({},t),{guardsResult:!0})):aB(s,r,i,n).pipe(tt(a=>a&&J2(a)?uB(r,o,n,e):Z(a)),X(a=>ce(j({},t),{guardsResult:a})))})}function aB(n,e,t,r){return ve(n).pipe(tt(i=>hB(i.component,i.route,t,e,r)),En(i=>i!==!0,!0))}function uB(n,e,t,r){return ve(e).pipe(ms(i=>gs(lB(i.route.parent,r),cB(i.route,r),fB(n,i.path,t),dB(n,i.route,t))),En(i=>i!==!0,!0))}function cB(n,e){return n!==null&&e&&e(new Mh(n)),Z(!0)}function lB(n,e){return n!==null&&e&&e(new Ah(n)),Z(!0)}function dB(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Z(!0);let i=r.map(o=>Mu(()=>{let s=Js(e)??t,a=ta(o,s),u=tB(a)?a.canActivate(e,n):wt(s,()=>a(e,n));return Rr(u).pipe(En())}));return Z(i).pipe(Xs())}function fB(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>Y2(s)).filter(s=>s!==null).map(s=>Mu(()=>{let a=s.guards.map(u=>{let l=Js(s.node)??t,d=ta(u,l),h=nB(d)?d.canActivateChild(r,n):wt(l,()=>d(r,n));return Rr(h).pipe(En())});return Z(a).pipe(Xs())}));return Z(o).pipe(Xs())}function hB(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Z(!0);let s=o.map(a=>{let u=Js(e)??i,l=ta(a,u),d=rB(l)?l.canDeactivate(n,e,t,r):wt(u,()=>l(n,e,t,r));return Rr(d).pipe(En())});return Z(s).pipe(Xs())}function pB(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Z(!0);let o=i.map(s=>{let a=ta(s,n),u=eB(a)?a.canLoad(e,t):wt(n,()=>a(e,t));return Rr(u)});return Z(o).pipe(Xs(),YA(r))}function YA(n){return Am(ot(e=>{if(typeof e!="boolean")throw kh(n,e)}),X(e=>e===!0))}function gB(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Z(!0);let o=i.map(s=>{let a=ta(s,n),u=iB(a)?a.canMatch(e,t):wt(n,()=>a(e,t));return Rr(u)});return Z(o).pipe(Xs(),YA(r))}var kc=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Fc=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function qs(n){return ps(new kc(n))}function mB(n){return ps(new K(4e3,!1))}function yB(n){return ps(WA(!1,Ot.GuardRejected))}var U_=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Z(r);if(i.numberOfChildren>1||!i.children[se])return mB(`${e.redirectTo}`);i=i.children[se]}}applyRedirectCommands(e,t,r,i,o){return vB(t,i,o).pipe(X(s=>{if(s instanceof Zn)throw new Fc(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,r);if(s[0]==="/")throw new Fc(a);return a}))}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Zn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,u])=>{s[a]=this.createSegmentGroup(e,u,r,i)}),new Ee(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new K(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function vB(n,e,t){if(typeof n=="string")return Z(n);let r=n,{queryParams:i,fragment:o,routeConfig:s,url:a,outlet:u,params:l,data:d,title:h}=e;return Rr(wt(t,()=>r({params:l,data:d,queryParams:i,fragment:o,routeConfig:s,url:a,outlet:u,title:h})))}var $_={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _B(n,e,t,r,i){let o=ZA(n,e,t);return o.matched?(r=U2(e,r),gB(r,e,t,i).pipe(X(s=>s===!0?o:j({},$_)))):Z(o)}function ZA(n,e,t){if(e.path==="**")return EB(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?j({},$_):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||bA)(t,n,e);if(!i)return j({},$_);let o={};Object.entries(i.posParams??{}).forEach(([a,u])=>{o[a]=u.path});let s=i.consumed.length>0?j(j({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function EB(n){return{matched:!0,parameters:n.length>0?AA(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function DA(n,e,t,r){return t.length>0&&DB(n,t,r)?{segmentGroup:new Ee(e,wB(r,new Ee(t,n.children))),slicedSegments:[]}:t.length===0&&CB(n,t,r)?{segmentGroup:new Ee(n.segments,IB(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ee(n.segments,n.children),slicedSegments:t}}function IB(n,e,t,r){let i={};for(let o of t)if(jh(n,e,o)&&!r[An(o)]){let s=new Ee([],{});i[An(o)]=s}return j(j({},r),i)}function wB(n,e){let t={};t[se]=e;for(let r of n)if(r.path===""&&An(r)!==se){let i=new Ee([],{});t[An(r)]=i}return t}function DB(n,e,t){return t.some(r=>jh(n,e,r)&&An(r)!==se)}function CB(n,e,t){return t.some(r=>jh(n,e,r))}function jh(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function TB(n,e,t){return e.length===0&&!n.children[t]}var H_=class{};function bB(n,e,t,r,i,o,s="emptyOnly"){return new q_(n,e,t,r,i,s,o).recognize()}var SB=31,q_=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new U_(this.urlSerializer,this.urlTree)}noMatchError(e){return new K(4002,`'${e.segmentGroup}'`)}recognize(){let e=DA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(X(({children:t,rootSnapshot:r})=>{let i=new sn(r,t),o=new Pc("",i),s=VA(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new yo([],Object.freeze({}),Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),se,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,se,t).pipe(X(r=>({children:r,rootSnapshot:t})),Wr(r=>{if(r instanceof Fc)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof kc?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(X(s=>s instanceof sn?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return ve(o).pipe(ms(s=>{let a=r.children[s],u=$2(t,s);return this.processSegmentGroup(e,u,a,s,i)}),Qi((s,a)=>(s.push(...a),s)),Kr(null),Lm(),tt(s=>{if(s===null)return qs(r);let a=XA(s);return AB(a),Z(a)}))}processSegment(e,t,r,i,o,s,a){return ve(t).pipe(ms(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,o,s,a).pipe(Wr(l=>{if(l instanceof kc)return Z(null);throw l}))),En(u=>!!u),Wr(u=>{if(QA(u))return TB(r,i,o)?Z(new H_):qs(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,u){return An(r)!==s&&(s===se||!jh(i,o,r))?qs(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,u):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,u):qs(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:u,parameters:l,consumedSegments:d,positionalParamSegments:h,remainingSegments:g}=ZA(t,i,o);if(!u)return qs(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>SB&&(this.allowRedirects=!1));let y=new yo(o,l,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,CA(i),An(i),i.component??i._loadedComponent??null,i,TA(i)),I=Oh(y,a,this.paramsInheritanceStrategy);return y.params=Object.freeze(I.params),y.data=Object.freeze(I.data),this.applyRedirects.applyRedirectCommands(d,i.redirectTo,h,y,e).pipe(ke(S=>this.applyRedirects.lineralizeSegments(i,S)),tt(S=>this.processSegment(e,r,t,S.concat(g),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=_B(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(ke(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ke(({routes:l})=>{let d=r._loadedInjector??e,{parameters:h,consumedSegments:g,remainingSegments:y}=u,I=new yo(g,h,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,CA(r),An(r),r.component??r._loadedComponent??null,r,TA(r)),b=Oh(I,s,this.paramsInheritanceStrategy);I.params=Object.freeze(b.params),I.data=Object.freeze(b.data);let{segmentGroup:S,slicedSegments:O}=DA(t,g,y,l);if(O.length===0&&S.hasChildren())return this.processChildren(d,l,S,I).pipe(X(V=>new sn(I,V)));if(l.length===0&&O.length===0)return Z(new sn(I,[]));let q=An(r)===o;return this.processSegment(d,l,S,O,q?se:o,!0,I).pipe(X(V=>new sn(I,V instanceof sn?[V]:[])))}))):qs(t)))}getChildConfig(e,t,r){return t.children?Z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Z({routes:t._loadedRoutes,injector:t._loadedInjector}):pB(e,t,r,this.urlSerializer).pipe(tt(i=>i?this.configLoader.loadChildren(e,t).pipe(ot(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):yB(t))):Z({routes:[],injector:e})}};function AB(n){n.sort((e,t)=>e.value.outlet===se?-1:t.value.outlet===se?1:e.value.outlet.localeCompare(t.value.outlet))}function RB(n){let e=n.value.routeConfig;return e&&e.path===""}function XA(n){let e=[],t=new Set;for(let r of n){if(!RB(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=XA(r.children);e.push(new sn(r.value,i))}return e.filter(r=>!t.has(r))}function CA(n){return n.data||{}}function TA(n){return n.resolve||{}}function MB(n,e,t,r,i,o){return tt(s=>bB(n,e,t,r,s.extractedUrl,i,o).pipe(X(({state:a,tree:u})=>ce(j({},s),{targetSnapshot:a,urlAfterRedirects:u}))))}function NB(n,e){return tt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Z(t);let o=new Set(i.map(u=>u.route)),s=new Set;for(let u of o)if(!s.has(u))for(let l of JA(u))s.add(l);let a=0;return ve(s).pipe(ms(u=>o.has(u)?xB(u,r,n,e):(u.data=Oh(u,u.parent,n).resolve,Z(void 0))),ot(()=>a++),ys(1),tt(u=>a===s.size?Z(t):It))})}function JA(n){let e=n.children.map(t=>JA(t)).flat();return[n,...e]}function xB(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!qA(i)&&(o[Vc]=i.title),Mu(()=>(n.data=Oh(n,n.parent,t).resolve,PB(o,n,e,r).pipe(X(s=>(n._resolvedData=s,n.data=j(j({},n.data),s),null)))))}function PB(n,e,t,r){let i=x_(n);if(i.length===0)return Z({});let o={};return ve(i).pipe(tt(s=>OB(n[s],e,t,r).pipe(En(),ot(a=>{if(a instanceof Zs)throw kh(new _o,a);o[s]=a}))),ys(1),X(()=>o),Wr(s=>QA(s)?It:ps(s)))}function OB(n,e,t,r){let i=Js(e)??r,o=ta(n,i),s=o.resolve?o.resolve(e,t):wt(i,()=>o(e,t));return Rr(s)}function M_(n){return ke(e=>{let t=n(e);return t?ve(t).pipe(X(()=>e)):Z(e)})}var K_=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===se);return r}getResolvedTitleForRoute(t){return t.data[Vc]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>F(eR),providedIn:"root"})}return n})(),eR=(()=>{class n extends K_{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)($(vA))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Uc=new z("",{providedIn:"root",factory:()=>({})}),$c=new z(""),tR=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=F(r_);loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Z(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Rr(wt(t,()=>r.loadComponent())).pipe(X(rR),ke(iR),ot(s=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s}),Nu(()=>{this.componentLoaders.delete(r)})),o=new ls(i,()=>new xe).pipe(cs());return this.componentLoaders.set(r,o),o}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Z({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=nR(r,this.compiler,t,this.onLoadEndListener).pipe(Nu(()=>{this.childrenLoaders.delete(r)})),s=new ls(o,()=>new xe).pipe(cs());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function nR(n,e,t,r){return Rr(wt(t,()=>n.loadChildren())).pipe(X(rR),ke(iR),tt(i=>i instanceof th||Array.isArray(i)?Z(i):ve(e.compileModuleAsync(i))),X(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get($c,[],{optional:!0,self:!0}).flat()),{routes:s.map(W_),injector:o}}))}function kB(n){return n&&typeof n=="object"&&"default"in n}function rR(n){return kB(n)?n.default:n}function iR(n){return Z(n)}var Bh=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>F(FB),providedIn:"root"})}return n})(),FB=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),oR=new z("");var sR=new z(""),aR=(()=>{class n{currentNavigation=zn(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new xe;transitionAbortWithErrorSubject=new xe;configLoader=F(tR);environmentInjector=F(Fe);destroyRef=F(qn);urlSerializer=F(Lc);rootContexts=F(ea);location=F($s);inputBindingEnabled=F(Lh,{optional:!0})!==null;titleStrategy=F(K_);options=F(Uc,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=F(Bh);createViewTransition=F(oR,{optional:!0});navigationErrorHandler=F(sR,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>Z(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new bh(i)),r=i=>this.events.next(new Sh(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;Pt(()=>{this.transitions?.next(ce(j({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:r}))})}setupNavigations(t){return this.transitions=new ut(null),this.transitions.pipe(ct(r=>r!==null),ke(r=>{let i=!1;return Z(r).pipe(ke(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Ot.SupersededByNewNavigation),It;this.currentTransition=r,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?ce(j({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let s=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!s&&a!=="reload")return this.events.next(new Ar(o.id,this.urlSerializer.serialize(o.rawUrl),"",Rc.IgnoredSameUrlNavigation)),o.resolve(!1),It;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return Z(o).pipe(ke(u=>(this.events.next(new Eo(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?It:Promise.resolve(u))),MB(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ot(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation.update(d=>(d.finalUrl=u.urlAfterRedirects,d));let l=new Mc(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:u,extractedUrl:l,source:d,restoredState:h,extras:g}=o,y=new Eo(u,this.urlSerializer.serialize(l),d,h);this.events.next(y);let I=$A(this.rootComponentType).snapshot;return this.currentTransition=r=ce(j({},o),{targetSnapshot:I,urlAfterRedirects:l,extras:ce(j({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(b=>(b.finalUrl=l,b)),Z(r)}else return this.events.next(new Ar(o.id,this.urlSerializer.serialize(o.extractedUrl),"",Rc.IgnoredByUrlHandlingStrategy)),o.resolve(!1),It}),ot(o=>{let s=new wh(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),X(o=>(this.currentTransition=r=ce(j({},o),{guards:Q2(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),sB(this.environmentInjector,o=>this.events.next(o)),ot(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw kh(this.urlSerializer,o.guardsResult);let s=new Dh(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),ct(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",Ot.GuardRejected),!1)),M_(o=>{if(o.guards.canActivateChecks.length!==0)return Z(o).pipe(ot(s=>{let a=new Ch(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),ke(s=>{let a=!1;return Z(s).pipe(NB(this.paramsInheritanceStrategy,this.environmentInjector),ot({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(s,"",Ot.NoDataFromResolver)}}))}),ot(s=>{let a=new Th(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}))}),M_(o=>{let s=a=>{let u=[];if(a.routeConfig?.loadComponent){let l=Js(a)??this.environmentInjector;u.push(this.configLoader.loadComponent(l,a.routeConfig).pipe(ot(d=>{a.component=d}),X(()=>{})))}for(let l of a.children)u.push(...s(l));return u};return Wd(s(o.targetSnapshot.root)).pipe(Kr(null),pr(1))}),M_(()=>this.afterPreactivation()),ke(()=>{let{currentSnapshot:o,targetSnapshot:s}=r,a=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return a?ve(a).pipe(X(()=>r)):Z(r)}),X(o=>{let s=q2(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=ce(j({},o),{targetRouterState:s}),this.currentNavigation.update(a=>(a.targetRouterState=s,a)),r}),ot(()=>{this.events.next(new Nc)}),K2(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),pr(1),Xd(new ie(o=>{let s=r.abortController.signal,a=()=>o.next();return s.addEventListener("abort",a),()=>s.removeEventListener("abort",a)}).pipe(ct(()=>!i&&!r.targetRouterState),ot(()=>{this.cancelNavigationTransition(r,r.abortController.signal.reason+"",Ot.Aborted)}))),ot({next:o=>{i=!0,this.lastSuccessfulNavigation=Pt(this.currentNavigation),this.events.next(new Sr(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),Xd(this.transitionAbortWithErrorSubject.pipe(ot(o=>{throw o}))),Nu(()=>{i||this.cancelNavigationTransition(r,"",Ot.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Wr(o=>{if(this.destroyed)return r.resolve(!1),It;if(i=!0,KA(o))this.events.next(new Yn(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),W2(o)?this.events.next(new Ys(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let s=new Qs(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let a=wt(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(a instanceof Zs){let{message:u,cancellationCode:l}=kh(this.urlSerializer,a);this.events.next(new Yn(r.id,this.urlSerializer.serialize(r.extractedUrl),u,l)),this.events.next(new Ys(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(a){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(a)}}return It}))}))}cancelNavigationTransition(t,r,i){let o=new Yn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Pt(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function VB(n){return n!==bc}var uR=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>F(LB),providedIn:"root"})}return n})(),Vh=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},LB=(()=>{class n extends Vh{static \u0275fac=(()=>{let t;return function(i){return(t||(t=si(n)))(i||n)}})();static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),cR=(()=>{class n{urlSerializer=F(Lc);options=F(Uc,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=F($s);urlHandlingStrategy=F(Bh);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Zn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,s=i??o;return s instanceof Zn?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=$A(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:()=>F(jB),providedIn:"root"})}return n})(),jB=(()=>{class n extends cR{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Eo?this.updateStateMemento():t instanceof Ar?this.commitTransition(r):t instanceof Mc?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Nc?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Yn&&t.code!==Ot.SupersededByNewNavigation&&t.code!==Ot.Redirect?this.restoreHistory(r):t instanceof Qs?this.restoreHistory(r,!0):t instanceof Sr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:o,state:s}=r;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,u=j(j({},s),this.generateNgRouterState(i,a));this.location.replaceState(t,"",u)}else{let a=j(j({},s),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=si(n)))(i||n)}})();static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Q_(n,e){n.events.pipe(ct(t=>t instanceof Sr||t instanceof Yn||t instanceof Qs||t instanceof Ar),X(t=>t instanceof Sr||t instanceof Ar?0:(t instanceof Yn?t.code===Ot.Redirect||t.code===Ot.SupersededByNewNavigation:!1)?2:1),ct(t=>t!==2),pr(1)).subscribe(()=>{e()})}var BB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},UB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Uh=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=F(Jv);stateManager=F(cR);options=F(Uc,{optional:!0})||{};pendingTasks=F(Gn);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=F(aR);urlSerializer=F(Lc);location=F($s);urlHandlingStrategy=F(Bh);injector=F(Fe);_events=new xe;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=F(uR);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=F($c,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!F(Lh,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new He;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=Pt(this.navigationTransitions.currentNavigation);if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Yn&&r.code!==Ot.Redirect&&r.code!==Ot.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Sr)this.navigated=!0;else if(r instanceof Ys){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=j({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||VB(i.source)},s);this.scheduleNavigation(a,bc,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}B2(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),bc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let u=j({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o).catch(u=>{this.disposed||this.injector.get(pn)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Pt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(W_),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=j(j({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let g=i?i.snapshot:this.routerState.snapshot.root;h=LA(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return jA(h,t,d,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Ks(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,bc,null,r)}navigate(t,r={skipLocationChange:!1}){return $B(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=j({},BB):r===!1?i=j({},UB):i=r,Ks(t))return _A(this.currentUrlTree,t,i);let o=this.parseUrl(t);return _A(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,u,l;s?(a=s.resolve,u=s.reject,l=s.promise):l=new Promise((h,g)=>{a=h,u=g});let d=this.pendingTasks.add();return Q_(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function $B(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new K(4008,!1)}var qB=new z("");function Y_(n,...e){return uf([{provide:$c,multi:!0,useValue:n},[],{provide:pi,useFactory:zB,deps:[Uh]},{provide:nh,multi:!0,useFactory:GB},e.map(t=>t.\u0275providers)])}function zB(n){return n.routerState.root}function GB(){let n=F(Bt);return e=>{let t=n.get(Tr);if(e!==t.components[0])return;let r=n.get(Uh),i=n.get(WB);n.get(KB)===1&&r.initialNavigation(),n.get(QB,null,{optional:!0})?.setUpPreloading(),n.get(qB,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var WB=new z("",{factory:()=>new xe}),KB=new z("",{providedIn:"root",factory:()=>1});var QB=new z("");var ZB=n=>({"flex flex-col mt-2 gap-2":!0,hidden:n,"md:flex md:flex-row md:gap-6 md:mt-0":!0}),lR=(()=>{class n{menuOpen=!1;static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["app-navbar"]],decls:12,vars:3,consts:()=>{let t;t=$localize`Micro Event Tracker`;let r;r=$localize`HOME`;let i;return i=$localize`LISTA`,[t,r,i,[1,"bg-blue-800","text-white","px-4","py-3"],[1,"flex","items-center","justify-between"],[1,"font-bold","text-xl"],[1,"md:hidden","py-2","px-3","flex","items-center",3,"click"],[1,"material-icons"],[3,"ngClass"],["routerLink","/",1,"py-2","px-4","hover:bg-blue-700","rounded"],["routerLink","/list",1,"py-2","px-4","hover:bg-blue-700","rounded"]]},template:function(r,i){r&1&&(Re(0,"nav",3)(1,"div",4)(2,"div",5),on(3,0),Ve(),Re(4,"button",6),li("click",function(){return i.menuOpen=!i.menuOpen}),Re(5,"span",7),Ht(6,"menu"),Ve()()(),Re(7,"div",8)(8,"a",9),on(9,1),Ve(),Re(10,"a",10),on(11,2),Ve()()()),r&2&&(Qe(7),rn("ngClass",n_(1,ZB,!i.menuOpen)))},dependencies:[fi,g_],encapsulation:2})}return n})();var dR=(()=>{class n{title="MicroEventTracker";static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(r,i){r&1&&gn(0,"app-navbar")(1,"router-outlet")},dependencies:[lR,jc],encapsulation:2})}return n})();var fR=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["app-home"]],decls:7,vars:0,consts:()=>{let t;t=$localize` Scopri tutti gli eventi locali per data e zona, filtrali per categoria e citt, e trova l'evento perfetto vicino a te! `;let r;return r=$localize` Vai agli eventi `,[t,r,[1,"home-bg","min-h-screen","flex","flex-col","items-center","justify-center","text-center"],[1,"text-4xl","md:text-6xl","font-bold","text-blue-800","mb-6","drop-shadow-lg"],[1,"text-lg","md:text-2xl","text-gray-900","mb-8","max-w-lg"],["routerLink","/list",1,"px-6","py-3","bg-blue-600","text-white","rounded-lg","shadow-md","hover:bg-blue-700","transition","text-lg","font-medium"]]},template:function(r,i){r&1&&(Ls(0,"div",2)(1,"h1",3),Ht(2," Micro Event Tracker "),js(),Ls(3,"p",4),on(4,0),js(),Ls(5,"a",5),on(6,1),js()())},styles:[".home-bg[_ngcontent-%COMP%]{background:linear-gradient(135deg,#93c5fd,#60a5fa)}"]})}return n})();var IR=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(_e(ui),_e(Dr))};static \u0275dir=Tt({type:n})}return n})(),nE=(()=>{class n extends IR{static \u0275fac=(()=>{let t;return function(i){return(t||(t=si(n)))(i||n)}})();static \u0275dir=Tt({type:n,features:[Cr]})}return n})(),Gh=new z("");var XB={provide:Gh,useExisting:vr(()=>wR),multi:!0};function JB(){let n=mn()?mn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var eU=new z(""),wR=(()=>{class n extends IR{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!JB())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(_e(ui),_e(Dr),_e(eU,8))};static \u0275dir=Tt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&li("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[Bs([XB]),Cr]})}return n})();var tU=new z(""),nU=new z("");function DR(n){return n!=null}function CR(n){return go(n)?ve(n):n}function TR(n){let e={};return n.forEach(t=>{e=t!=null?j(j({},e),t):e}),Object.keys(e).length===0?null:e}function bR(n,e){return e.map(t=>t(n))}function rU(n){return!n.validate}function SR(n){return n.map(e=>rU(e)?e:t=>e.validate(t))}function iU(n){if(!n)return null;let e=n.filter(DR);return e.length==0?null:function(t){return TR(bR(t,e))}}function AR(n){return n!=null?iU(SR(n)):null}function oU(n){if(!n)return null;let e=n.filter(DR);return e.length==0?null:function(t){let r=bR(t,e).map(CR);return km(r).pipe(X(TR))}}function RR(n){return n!=null?oU(SR(n)):null}function hR(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function sU(n){return n._rawValidators}function aU(n){return n._rawAsyncValidators}function Z_(n){return n?Array.isArray(n)?n:[n]:[]}function Hh(n,e){return Array.isArray(n)?n.includes(e):n===e}function pR(n,e){let t=Z_(e);return Z_(n).forEach(i=>{Hh(t,i)||t.push(i)}),t}function gR(n,e){return Z_(e).filter(t=>!Hh(n,t))}var qh=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=AR(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=RR(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},X_=class extends qh{name;get formDirective(){return null}get path(){return null}},Wc=class extends qh{_parent=null;name=null;valueAccessor=null},J_=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},uU={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Mne=ce(j({},uU),{"[class.ng-submitted]":"isSubmitted"}),MR=(()=>{class n extends J_{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(_e(Wc,2))};static \u0275dir=Tt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&rh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Cr]})}return n})();var Hc="VALID",$h="INVALID",na="PENDING",qc="DISABLED",Io=class{},zh=class extends Io{value;source;constructor(e,t){super(),this.value=e,this.source=t}},zc=class extends Io{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Gc=class extends Io{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},ra=class extends Io{status;source;constructor(e,t){super(),this.status=e,this.source=t}};var eE=class extends Io{source;constructor(e){super(),this.source=e}};function cU(n){return(Wh(n)?n.validators:n)||null}function lU(n){return Array.isArray(n)?AR(n):n||null}function dU(n,e){return(Wh(e)?e.asyncValidators:n)||null}function fU(n){return Array.isArray(n)?RR(n):n||null}function Wh(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var tE=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Pt(this.statusReactive)}set status(e){Pt(()=>this.statusReactive.set(e))}_status=pc(()=>this.statusReactive());statusReactive=zn(void 0);get valid(){return this.status===Hc}get invalid(){return this.status===$h}get pending(){return this.status==na}get disabled(){return this.status===qc}get enabled(){return this.status!==qc}errors;get pristine(){return Pt(this.pristineReactive)}set pristine(e){Pt(()=>this.pristineReactive.set(e))}_pristine=pc(()=>this.pristineReactive());pristineReactive=zn(!0);get dirty(){return!this.pristine}get touched(){return Pt(this.touchedReactive)}set touched(e){Pt(()=>this.touchedReactive.set(e))}_touched=pc(()=>this.touchedReactive());touchedReactive=zn(!1);get untouched(){return!this.touched}_events=new xe;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(pR(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(pR(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(gR(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(gR(e,this._rawAsyncValidators))}hasValidator(e){return Hh(this._rawValidators,e)}hasAsyncValidator(e){return Hh(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ce(j({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Gc(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Gc(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ce(j({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new zc(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new zc(!0,r))}markAsPending(e={}){this.status=na;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ra(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ce(j({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=qc,this.errors=null,this._forEachChild(i=>{i.disable(ce(j({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zh(this.value,r)),this._events.next(new ra(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ce(j({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Hc,this._forEachChild(r=>{r.enable(ce(j({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ce(j({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Hc||this.status===na)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zh(this.value,t)),this._events.next(new ra(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ce(j({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?qc:Hc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=na,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=CR(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new ra(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new nt,this.statusChanges=new nt}_calculateStatus(){return this._allControlsDisabled()?qc:this.errors?$h:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(na)?na:this._anyControlsHaveStatus($h)?$h:Hc}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new zc(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Gc(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Wh(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=lU(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=fU(this._rawAsyncValidators)}};var NR=new z("",{providedIn:"root",factory:()=>rE}),rE="always";function hU(n,e){return[...e.path,n]}function pU(n,e,t=rE){mU(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),yU(n,e),_U(n,e),vU(n,e),gU(n,e)}function mR(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function gU(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function mU(n,e){let t=sU(n);e.validator!==null?n.setValidators(hR(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=aU(n);e.asyncValidator!==null?n.setAsyncValidators(hR(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();mR(e._rawValidators,i),mR(e._rawAsyncValidators,i)}function yU(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&xR(n,e)})}function vU(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&xR(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function xR(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function _U(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function EU(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function IU(n){return Object.getPrototypeOf(n.constructor)===nE}function wU(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===wR?t=o:IU(o)?r=o:i=o}),i||r||t||null}function yR(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function vR(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var DU=class extends tE{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(cU(t),dU(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Wh(t)&&(t.nonNullable||t.initialValueIsDefault)&&(vR(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new eE(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){yR(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){yR(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){vR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var CU={provide:Wc,useExisting:vr(()=>iE)},_R=Promise.resolve(),iE=(()=>{class n extends Wc{_changeDetectorRef;callSetDisabledState;control=new DU;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new nt;constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=wU(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),EU(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){pU(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){_R.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&d_(r);_R.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?hU(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(_e(X_,9),_e(tU,10),_e(nU,10),_e(Gh,10),_e(Us,8),_e(NR,8))};static \u0275dir=Tt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Bs([CU]),Cr,Fs]})}return n})();var TU={provide:Gh,useExisting:vr(()=>Kh),multi:!0};function PR(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function bU(n){return n.split(":")[0]}var Kh=(()=>{class n extends nE{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=F(Tr).injector;destroyRef=F(qn);cdr=F(Us);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,Yf({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let r=this._getOptionId(t),i=PR(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=bU(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=si(n)))(i||n)}})();static \u0275dir=Tt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&li("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Bs([TU]),Cr]})}return n})(),OR=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(PR(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||n)(_e(Dr),_e(ui),_e(Kh,9))};static \u0275dir=Tt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),SU={provide:Gh,useExisting:vr(()=>kR),multi:!0};function ER(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function AU(n){return n.split(":")[0]}var kR=(()=>{class n extends nE{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let u=s[a],l=this._getOptionValue(u.value);i.push(l)}}else{let s=r.options;for(let a=0;a<s.length;a++){let u=s[a];if(u.selected){let l=this._getOptionValue(u.value);i.push(l)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=AU(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=si(n)))(i||n)}})();static \u0275dir=Tt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&li("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Bs([SU]),Cr]})}return n})(),FR=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(ER(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(ER(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(_e(Dr),_e(ui),_e(kR,9))};static \u0275dir=Tt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var RU=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Kn({type:n});static \u0275inj=wn({})}return n})();var Qh=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:NR,useValue:t.callSetDisabledState??rE}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Kn({type:n});static \u0275inj=wn({imports:[RU]})}return n})();function NU(n,e){if(n&1&&(Re(0,"span",13),Ht(1),Ve()),n&2){let t=e.$implicit;Qe(),br(t)}}var VR=(()=>{class n{event;static \u0275fac=function(r){return new(r||n)};static \u0275cmp=nn({type:n,selectors:[["app-event-card"]],inputs:{event:"event"},decls:18,vars:8,consts:()=>{let t;return t=$localize` Dettagli evento `,[t,[1,"bg-white","shadow-lg","rounded-lg","p-4","flex","flex-col","md:flex-row","items-center","mb-4","hover:bg-blue-50","transition-all"],["alt","Event Image",1,"w-32","h-32","rounded-lg","object-cover","mr-4","mb-2","md:mb-0",3,"src"],[1,"flex-1"],[1,"text-xl","font-bold","mb-1","text-blue-700"],[1,"text-gray-600","mb-2"],[1,"mr-2"],[1,"fa","fa-map-marker-alt"],[1,"fa","fa-calendar-alt"],[1,"flex","gap-2","mb-2"],["class","bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs",4,"ngFor","ngForOf"],[1,"text-gray-800"],["target","_blank",1,"text-blue-600","underline","mt-2","inline-block",3,"href"],[1,"bg-blue-100","text-blue-700","px-2","py-1","rounded","text-xs"]]},template:function(r,i){r&1&&(Re(0,"div",1),gn(1,"img",2),Re(2,"div",3)(3,"h2",4),Ht(4),Ve(),Re(5,"div",5)(6,"span",6),gn(7,"i",7),Ht(8),Ve(),Re(9,"span",6),gn(10,"i",8),Ht(11),Ve()(),Re(12,"div",9),ci(13,NU,2,1,"span",10),Ve(),Re(14,"p",11),Ht(15),Ve(),Re(16,"a",12),on(17,0),Ve()()()),r&2&&(Qe(),rn("src",i.event.link_img,Gf),Qe(3),br(i.event.titolo),Qe(4),ih(" ",i.event.citta,", ",i.event.luogo),Qe(3),dc(" ",i.event.data),Qe(2),rn("ngForOf",i.event.categoria),Qe(2),br(i.event.orario),Qe(),rn("href",i.event.link_titolo,Gf))},dependencies:[fi,Hs,Qh],encapsulation:2})}return n})();var xU="firebase",PU="11.10.0";Gr(xU,PU,"app");function qt(n){n===void 0&&(n=F(Bt));let e=n.get(Zu);return t=>new ie(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:u=>{r.next(u),s()},complete:()=>{r.complete(),s()},error:u=>{r.error(u),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var LR=(n,e)=>{let t=e?[e]:tT(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},oE=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(oE||{}),Qne=mc()&&typeof Zone<"u"?oE.WARN:oE.SILENT;var Yh=class{zone;delegate;constructor(e,t=xm){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},Kc=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=F(be);this.outsideAngular=t.runOutsideAngular(()=>new Yh(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Yh(typeof Zone>"u"?void 0:Zone.current,Ru))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var FU=new Map,VU={activated:!1,tokenObservers:[]},LU={initialized:!1,enabled:!1};function Rn(n){return FU.get(n)||Object.assign({},VU)}function HR(){return LU}var jU="https://content-firebaseappcheck.googleapis.com/v1";var BU="exchangeDebugToken",BR={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},nre=1440*60*1e3;var uE=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return x(this,null,function*(){this.stop();try{this.pending=new dm,this.pending.promise.catch(t=>{}),yield UU(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new dm,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function UU(n){return new Promise(e=>{setTimeout(e,n)})}var $U={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},gi=new XC("appCheck","AppCheck",$U);function qR(n){if(!Rn(n).activated)throw gi.create("use-before-activation",{appName:n.name})}function zR(r,i){return x(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let y=yield s.getHeartbeatsHeader();y&&(o["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:o},u;try{u=yield fetch(n,a)}catch(y){throw gi.create("fetch-network-error",{originalErrorMessage:y?.message})}if(u.status!==200)throw gi.create("fetch-status-error",{httpStatus:u.status});let l;try{l=yield u.json()}catch(y){throw gi.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw gi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let h=Number(d[1])*1e3,g=Date.now();return{token:l.token,expireTimeMillis:g+h,issuedAtTimeMillis:g}})}function GR(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${jU}/projects/${t}/apps/${r}:${BU}?key=${i}`,body:{debug_token:e}}}var HU="firebase-app-check-database",qU=1,cE="firebase-app-check-store";var Zh=null;function zU(){return Zh||(Zh=new Promise((n,e)=>{try{let t=indexedDB.open(HU,qU);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(gi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(cE,{keyPath:"compositeKey"})}}}catch(t){e(gi.create("storage-open",{originalErrorMessage:t?.message}))}}),Zh)}function GU(n,e){return WU(KU(n),e)}function WU(n,e){return x(this,null,function*(){let r=(yield zU()).transaction(cE,"readwrite"),o=r.objectStore(cE).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=u=>{s()},r.onerror=u=>{var l;a(gi.create("storage-set",{originalErrorMessage:(l=u.target.error)===null||l===void 0?void 0:l.message}))}})})}function KU(n){return`${n.options.appId}-${n.name}`}var Qc=new hd("@firebase/app-check");function sE(n,e){return dd()?GU(n,e).catch(t=>{Qc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function WR(){return HR().enabled}function KR(){return x(this,null,function*(){let n=HR();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var QU={error:"UNKNOWN_ERROR"};function YU(n){return WC.encodeString(JSON.stringify(n),!1)}function lE(n,e=!1,t=!1){return x(this,null,function*(){let r=n.app;qR(r);let i=Rn(r),o=i.token,s;if(o&&!Yc(o)&&(i.token=void 0,o=void 0),!o){let l=yield i.cachedTokenPromise;l&&(Yc(l)?o=l:yield sE(r,void 0))}if(!e&&o&&Yc(o))return{token:o.token};let a=!1;if(WR())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=zR(GR(r,yield KR()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let l=yield i.exchangeTokenPromise;return yield sE(r,l),i.token=l,{token:l.token}}catch(l){return l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?Qc.warn(l.message):t&&Qc.error(l),aE(l)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),o=yield Rn(r).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?Qc.warn(l.message):t&&Qc.error(l),s=l}let u;return o?s?Yc(o)?u={token:o.token,internalError:s}:u=aE(s):(u={token:o.token},i.token=o,yield sE(r,o)):u=aE(s),a&&e$(r,u),u})}function ZU(n){return x(this,null,function*(){let e=n.app;qR(e);let{provider:t}=Rn(e);if(WR()){let r=yield KR(),{token:i}=yield zR(GR(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function XU(n,e,t,r){let{app:i}=n,o=Rn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&Yc(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),UR(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>UR(n))}function QR(n,e){let t=Rn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function UR(n){let{app:e}=n,t=Rn(e),r=t.tokenRefresher;r||(r=JU(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function JU(n){let{app:e}=n;return new uE(()=>x(null,null,function*(){let t=Rn(e),r;if(t.token?r=yield lE(n,!0):r=yield lE(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Rn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},BR.RETRIAL_MIN_WAIT,BR.RETRIAL_MAX_WAIT)}function e$(n,e){let t=Rn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Yc(n){return n.expireTimeMillis-Date.now()>0}function aE(n){return{token:YU(QU),error:n}}var dE=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Rn(this.app);for(let t of e)QR(this.app,t.next);return Promise.resolve()}};function t$(n,e){return new dE(n,e)}function n$(n){return{getToken:e=>lE(n,e),getLimitedUseToken:()=>ZU(n),addTokenListener:e=>XU(n,"INTERNAL",e),removeTokenListener:e=>QR(n.app,e)}}var r$="@firebase/app-check",i$="0.10.1";var o$="app-check",$R="app-check-internal";function s$(){Eu(new zi(o$,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return t$(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider($R).initialize()})),Eu(new zi($R,n=>{let e=n.getProvider("app-check").getImmediate();return n$(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Gr(r$,i$)}s$();var a$="app-check";var ia=class{constructor(){return LR(a$)}};var u$=["localhost","0.0.0.0","127.0.0.1"],vre=typeof window<"u"&&u$.includes(window.location.hostname);var c$="firebase",l$="11.10.0";Fn.registerVersion(c$,l$,"app-compat");var d$=["ngOnDestroy"],XR=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(d$.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let u=a?.[o];return typeof u=="function"?u.bind(a):u?.then?u.then(l=>t.run(()=>l)):t.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>s[u],apply:(a,u,l)=>s.then(d=>{let h=d?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,h),h})})})});var fE=class{constructor(e){return e}},Xh=new z("angularfire2.app.options"),Jh=new z("angularfire2.app.name");function ep(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Fn.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Fn.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;f$("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new fE(s)}var f$=(n,...e)=>{mc()&&typeof console<"u"&&console[n](...e)};function tp(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return h$(i,s)||(ZR("error",`${e} was already initialized on the ${t} Firebase App with different settings.${p$?" You may need to reload as Firebase is not HMR aware.":""}`),ZR("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function h$(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var p$=typeof module<"u"&&!!module.hot,ZR=(n,...e)=>{mc()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var hE=new z("angularfire2.auth.use-emulator"),pE=new z("angularfire2.auth.settings"),gE=new z("angularfire2.auth.tenant-id"),mE=new z("angularfire2.auth.langugage-code"),yE=new z("angularfire2.auth.use-device-language"),vE=new z("angularfire.auth.persistence"),_E=(n,e,t,r,i,o,s,a)=>tp(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let u=e.runOutsideAngular(()=>n.auth());if(t&&u.useEmulator(...t),r&&(u.tenantId=r),u.languageCode=i,o&&u.useDeviceLanguage(),s)for(let[l,d]of Object.entries(s))u.settings[l]=d;return a&&u.setPersistence(a),u},[t,r,i,o,s,a]),JR=(()=>{class n{injector=F(Fe);authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,u,l,d,h,g,y){let I=new xe,b=Z(void 0).pipe(jn(s.outsideAngular),ke(()=>o.runOutsideAngular(()=>import("./chunk-7XFD4IMF.js"))),X(()=>ep(t,o,r)),X(S=>_E(S,o,a,l,d,h,u,g)),Yd({bufferSize:1,refCount:!1}));if(lh(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Z(null);else{b.pipe(En()).subscribe();let S=b.pipe(ke(V=>V.getRedirectResult().then(Y=>Y,()=>null)),qt(this.injector),Yd({bufferSize:1,refCount:!1})),O=b.pipe(ke(V=>new ie(Y=>({unsubscribe:o.runOutsideAngular(()=>V.onAuthStateChanged(ee=>Y.next(ee),ee=>Y.error(ee),()=>Y.complete()))})))),q=b.pipe(ke(V=>new ie(Y=>({unsubscribe:o.runOutsideAngular(()=>V.onIdTokenChanged(ee=>Y.next(ee),ee=>Y.error(ee),()=>Y.complete()))}))));this.authState=S.pipe(Zd(O),fr(s.outsideAngular),jn(s.insideAngular)),this.user=S.pipe(Zd(q),fr(s.outsideAngular),jn(s.insideAngular)),this.idToken=this.user.pipe(ke(V=>V?ve(V.getIdToken()):Z(null))),this.idTokenResult=this.user.pipe(ke(V=>V?ve(V.getIdTokenResult()):Z(null))),this.credential=Fm(S,I,this.authState.pipe(ct(V=>!V))).pipe(X(V=>V?.user?V:null),fr(s.outsideAngular),jn(s.insideAngular))}return XR(this,b,o,{spy:{apply:(S,O,q)=>{(S.startsWith("signIn")||S.startsWith("createUser"))&&q.then(V=>I.next(V))}}})}static \u0275fac=function(r){return new(r||n)($(Xh),$(Jh,8),$(bn),$(be),$(Kc),$(hE,8),$(pE,8),$(gE,8),$(mE,8),$(yE,8),$(vE,8),$(ia,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var eM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tM={};var Mr,EE;(function(){var n;function e(w,v){function E(){}E.prototype=v.prototype,w.D=v.prototype,w.prototype=new E,w.prototype.constructor=w,w.C=function(D,C,A){for(var _=Array(arguments.length-2),ur=2;ur<arguments.length;ur++)_[ur-2]=arguments[ur];return v.prototype[C].apply(D,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,v,E){E||(E=0);var D=Array(16);if(typeof v=="string")for(var C=0;16>C;++C)D[C]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(C=0;16>C;++C)D[C]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=w.g[0],E=w.g[1],C=w.g[2];var A=w.g[3],_=v+(A^E&(C^A))+D[0]+3614090360&4294967295;v=E+(_<<7&4294967295|_>>>25),_=A+(C^v&(E^C))+D[1]+3905402710&4294967295,A=v+(_<<12&4294967295|_>>>20),_=C+(E^A&(v^E))+D[2]+606105819&4294967295,C=A+(_<<17&4294967295|_>>>15),_=E+(v^C&(A^v))+D[3]+3250441966&4294967295,E=C+(_<<22&4294967295|_>>>10),_=v+(A^E&(C^A))+D[4]+4118548399&4294967295,v=E+(_<<7&4294967295|_>>>25),_=A+(C^v&(E^C))+D[5]+1200080426&4294967295,A=v+(_<<12&4294967295|_>>>20),_=C+(E^A&(v^E))+D[6]+2821735955&4294967295,C=A+(_<<17&4294967295|_>>>15),_=E+(v^C&(A^v))+D[7]+4249261313&4294967295,E=C+(_<<22&4294967295|_>>>10),_=v+(A^E&(C^A))+D[8]+1770035416&4294967295,v=E+(_<<7&4294967295|_>>>25),_=A+(C^v&(E^C))+D[9]+2336552879&4294967295,A=v+(_<<12&4294967295|_>>>20),_=C+(E^A&(v^E))+D[10]+4294925233&4294967295,C=A+(_<<17&4294967295|_>>>15),_=E+(v^C&(A^v))+D[11]+2304563134&4294967295,E=C+(_<<22&4294967295|_>>>10),_=v+(A^E&(C^A))+D[12]+1804603682&4294967295,v=E+(_<<7&4294967295|_>>>25),_=A+(C^v&(E^C))+D[13]+4254626195&4294967295,A=v+(_<<12&4294967295|_>>>20),_=C+(E^A&(v^E))+D[14]+2792965006&4294967295,C=A+(_<<17&4294967295|_>>>15),_=E+(v^C&(A^v))+D[15]+1236535329&4294967295,E=C+(_<<22&4294967295|_>>>10),_=v+(C^A&(E^C))+D[1]+4129170786&4294967295,v=E+(_<<5&4294967295|_>>>27),_=A+(E^C&(v^E))+D[6]+3225465664&4294967295,A=v+(_<<9&4294967295|_>>>23),_=C+(v^E&(A^v))+D[11]+643717713&4294967295,C=A+(_<<14&4294967295|_>>>18),_=E+(A^v&(C^A))+D[0]+3921069994&4294967295,E=C+(_<<20&4294967295|_>>>12),_=v+(C^A&(E^C))+D[5]+3593408605&4294967295,v=E+(_<<5&4294967295|_>>>27),_=A+(E^C&(v^E))+D[10]+38016083&4294967295,A=v+(_<<9&4294967295|_>>>23),_=C+(v^E&(A^v))+D[15]+3634488961&4294967295,C=A+(_<<14&4294967295|_>>>18),_=E+(A^v&(C^A))+D[4]+3889429448&4294967295,E=C+(_<<20&4294967295|_>>>12),_=v+(C^A&(E^C))+D[9]+568446438&4294967295,v=E+(_<<5&4294967295|_>>>27),_=A+(E^C&(v^E))+D[14]+3275163606&4294967295,A=v+(_<<9&4294967295|_>>>23),_=C+(v^E&(A^v))+D[3]+4107603335&4294967295,C=A+(_<<14&4294967295|_>>>18),_=E+(A^v&(C^A))+D[8]+1163531501&4294967295,E=C+(_<<20&4294967295|_>>>12),_=v+(C^A&(E^C))+D[13]+2850285829&4294967295,v=E+(_<<5&4294967295|_>>>27),_=A+(E^C&(v^E))+D[2]+4243563512&4294967295,A=v+(_<<9&4294967295|_>>>23),_=C+(v^E&(A^v))+D[7]+1735328473&4294967295,C=A+(_<<14&4294967295|_>>>18),_=E+(A^v&(C^A))+D[12]+2368359562&4294967295,E=C+(_<<20&4294967295|_>>>12),_=v+(E^C^A)+D[5]+4294588738&4294967295,v=E+(_<<4&4294967295|_>>>28),_=A+(v^E^C)+D[8]+2272392833&4294967295,A=v+(_<<11&4294967295|_>>>21),_=C+(A^v^E)+D[11]+1839030562&4294967295,C=A+(_<<16&4294967295|_>>>16),_=E+(C^A^v)+D[14]+4259657740&4294967295,E=C+(_<<23&4294967295|_>>>9),_=v+(E^C^A)+D[1]+2763975236&4294967295,v=E+(_<<4&4294967295|_>>>28),_=A+(v^E^C)+D[4]+1272893353&4294967295,A=v+(_<<11&4294967295|_>>>21),_=C+(A^v^E)+D[7]+4139469664&4294967295,C=A+(_<<16&4294967295|_>>>16),_=E+(C^A^v)+D[10]+3200236656&4294967295,E=C+(_<<23&4294967295|_>>>9),_=v+(E^C^A)+D[13]+681279174&4294967295,v=E+(_<<4&4294967295|_>>>28),_=A+(v^E^C)+D[0]+3936430074&4294967295,A=v+(_<<11&4294967295|_>>>21),_=C+(A^v^E)+D[3]+3572445317&4294967295,C=A+(_<<16&4294967295|_>>>16),_=E+(C^A^v)+D[6]+76029189&4294967295,E=C+(_<<23&4294967295|_>>>9),_=v+(E^C^A)+D[9]+3654602809&4294967295,v=E+(_<<4&4294967295|_>>>28),_=A+(v^E^C)+D[12]+3873151461&4294967295,A=v+(_<<11&4294967295|_>>>21),_=C+(A^v^E)+D[15]+530742520&4294967295,C=A+(_<<16&4294967295|_>>>16),_=E+(C^A^v)+D[2]+3299628645&4294967295,E=C+(_<<23&4294967295|_>>>9),_=v+(C^(E|~A))+D[0]+4096336452&4294967295,v=E+(_<<6&4294967295|_>>>26),_=A+(E^(v|~C))+D[7]+1126891415&4294967295,A=v+(_<<10&4294967295|_>>>22),_=C+(v^(A|~E))+D[14]+2878612391&4294967295,C=A+(_<<15&4294967295|_>>>17),_=E+(A^(C|~v))+D[5]+4237533241&4294967295,E=C+(_<<21&4294967295|_>>>11),_=v+(C^(E|~A))+D[12]+1700485571&4294967295,v=E+(_<<6&4294967295|_>>>26),_=A+(E^(v|~C))+D[3]+2399980690&4294967295,A=v+(_<<10&4294967295|_>>>22),_=C+(v^(A|~E))+D[10]+4293915773&4294967295,C=A+(_<<15&4294967295|_>>>17),_=E+(A^(C|~v))+D[1]+2240044497&4294967295,E=C+(_<<21&4294967295|_>>>11),_=v+(C^(E|~A))+D[8]+1873313359&4294967295,v=E+(_<<6&4294967295|_>>>26),_=A+(E^(v|~C))+D[15]+4264355552&4294967295,A=v+(_<<10&4294967295|_>>>22),_=C+(v^(A|~E))+D[6]+2734768916&4294967295,C=A+(_<<15&4294967295|_>>>17),_=E+(A^(C|~v))+D[13]+1309151649&4294967295,E=C+(_<<21&4294967295|_>>>11),_=v+(C^(E|~A))+D[4]+4149444226&4294967295,v=E+(_<<6&4294967295|_>>>26),_=A+(E^(v|~C))+D[11]+3174756917&4294967295,A=v+(_<<10&4294967295|_>>>22),_=C+(v^(A|~E))+D[2]+718787259&4294967295,C=A+(_<<15&4294967295|_>>>17),_=E+(A^(C|~v))+D[9]+3951481745&4294967295,w.g[0]=w.g[0]+v&4294967295,w.g[1]=w.g[1]+(C+(_<<21&4294967295|_>>>11))&4294967295,w.g[2]=w.g[2]+C&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.u=function(w,v){v===void 0&&(v=w.length);for(var E=v-this.blockSize,D=this.B,C=this.h,A=0;A<v;){if(C==0)for(;A<=E;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<v;)if(D[C++]=w.charCodeAt(A++),C==this.blockSize){i(this,D),C=0;break}}else for(;A<v;)if(D[C++]=w[A++],C==this.blockSize){i(this,D),C=0;break}}this.h=C,this.o+=v},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var v=1;v<w.length-8;++v)w[v]=0;var E=8*this.o;for(v=w.length-8;v<w.length;++v)w[v]=E&255,E/=256;for(this.u(w),w=Array(16),v=E=0;4>v;++v)for(var D=0;32>D;D+=8)w[E++]=this.g[v]>>>D&255;return w};function o(w,v){var E=a;return Object.prototype.hasOwnProperty.call(E,w)?E[w]:E[w]=v(w)}function s(w,v){this.h=v;for(var E=[],D=!0,C=w.length-1;0<=C;C--){var A=w[C]|0;D&&A==v||(E[C]=A,D=!1)}this.g=E}var a={};function u(w){return-128<=w&&128>w?o(w,function(v){return new s([v|0],0>v?-1:0)}):new s([w|0],0>w?-1:0)}function l(w){if(isNaN(w)||!isFinite(w))return h;if(0>w)return S(l(-w));for(var v=[],E=1,D=0;w>=E;D++)v[D]=w/E|0,E*=4294967296;return new s(v,0)}function d(w,v){if(w.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(w.charAt(0)=="-")return S(d(w.substring(1),v));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(v,8)),D=h,C=0;C<w.length;C+=8){var A=Math.min(8,w.length-C),_=parseInt(w.substring(C,C+A),v);8>A?(A=l(Math.pow(v,A)),D=D.j(A).add(l(_))):(D=D.j(E),D=D.add(l(_)))}return D}var h=u(0),g=u(1),y=u(16777216);n=s.prototype,n.m=function(){if(b(this))return-S(this).m();for(var w=0,v=1,E=0;E<this.g.length;E++){var D=this.i(E);w+=(0<=D?D:4294967296+D)*v,v*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(I(this))return"0";if(b(this))return"-"+S(this).toString(w);for(var v=l(Math.pow(w,6)),E=this,D="";;){var C=Y(E,v).g;E=O(E,C.j(v));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(w);if(E=C,I(E))return A+D;for(;6>A.length;)A="0"+A;D=A+D}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function I(w){if(w.h!=0)return!1;for(var v=0;v<w.g.length;v++)if(w.g[v]!=0)return!1;return!0}function b(w){return w.h==-1}n.l=function(w){return w=O(this,w),b(w)?-1:I(w)?0:1};function S(w){for(var v=w.g.length,E=[],D=0;D<v;D++)E[D]=~w.g[D];return new s(E,~w.h).add(g)}n.abs=function(){return b(this)?S(this):this},n.add=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],D=0,C=0;C<=v;C++){var A=D+(this.i(C)&65535)+(w.i(C)&65535),_=(A>>>16)+(this.i(C)>>>16)+(w.i(C)>>>16);D=_>>>16,A&=65535,_&=65535,E[C]=_<<16|A}return new s(E,E[E.length-1]&-2147483648?-1:0)};function O(w,v){return w.add(S(v))}n.j=function(w){if(I(this)||I(w))return h;if(b(this))return b(w)?S(this).j(S(w)):S(S(this).j(w));if(b(w))return S(this.j(S(w)));if(0>this.l(y)&&0>w.l(y))return l(this.m()*w.m());for(var v=this.g.length+w.g.length,E=[],D=0;D<2*v;D++)E[D]=0;for(D=0;D<this.g.length;D++)for(var C=0;C<w.g.length;C++){var A=this.i(D)>>>16,_=this.i(D)&65535,ur=w.i(C)>>>16,eu=w.i(C)&65535;E[2*D+2*C]+=_*eu,q(E,2*D+2*C),E[2*D+2*C+1]+=A*eu,q(E,2*D+2*C+1),E[2*D+2*C+1]+=_*ur,q(E,2*D+2*C+1),E[2*D+2*C+2]+=A*ur,q(E,2*D+2*C+2)}for(D=0;D<v;D++)E[D]=E[2*D+1]<<16|E[2*D];for(D=v;D<2*v;D++)E[D]=0;return new s(E,0)};function q(w,v){for(;(w[v]&65535)!=w[v];)w[v+1]+=w[v]>>>16,w[v]&=65535,v++}function V(w,v){this.g=w,this.h=v}function Y(w,v){if(I(v))throw Error("division by zero");if(I(w))return new V(h,h);if(b(w))return v=Y(S(w),v),new V(S(v.g),S(v.h));if(b(v))return v=Y(w,S(v)),new V(S(v.g),v.h);if(30<w.g.length){if(b(w)||b(v))throw Error("slowDivide_ only works with positive integers.");for(var E=g,D=v;0>=D.l(w);)E=ee(E),D=ee(D);var C=te(E,1),A=te(D,1);for(D=te(D,2),E=te(E,2);!I(D);){var _=A.add(D);0>=_.l(w)&&(C=C.add(E),A=_),D=te(D,1),E=te(E,1)}return v=O(w,C.j(v)),new V(C,v)}for(C=h;0<=w.l(v);){for(E=Math.max(1,Math.floor(w.m()/v.m())),D=Math.ceil(Math.log(E)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),A=l(E),_=A.j(v);b(_)||0<_.l(w);)E-=D,A=l(E),_=A.j(v);I(A)&&(A=g),C=C.add(A),w=O(w,_)}return new V(C,w)}n.A=function(w){return Y(this,w).h},n.and=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],D=0;D<v;D++)E[D]=this.i(D)&w.i(D);return new s(E,this.h&w.h)},n.or=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],D=0;D<v;D++)E[D]=this.i(D)|w.i(D);return new s(E,this.h|w.h)},n.xor=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],D=0;D<v;D++)E[D]=this.i(D)^w.i(D);return new s(E,this.h^w.h)};function ee(w){for(var v=w.g.length+1,E=[],D=0;D<v;D++)E[D]=w.i(D)<<1|w.i(D-1)>>>31;return new s(E,w.h)}function te(w,v){var E=v>>5;v%=32;for(var D=w.g.length-E,C=[],A=0;A<D;A++)C[A]=0<v?w.i(A+E)>>>v|w.i(A+E+1)<<32-v:w.i(A+E);return new s(C,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,EE=tM.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=d,Mr=tM.Integer=s}).apply(typeof eM<"u"?eM:typeof self<"u"?self:typeof window<"u"?window:{});var np=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nr={};var IE,m$,oa,wE,Zc,rp,DE,CE,TE;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,p){return c==Array.prototype||c==Object.prototype||(c[f]=p.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof np=="object"&&np];for(var f=0;f<c.length;++f){var p=c[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(c,f){if(f)e:{var p=r;c=c.split(".");for(var m=0;m<c.length-1;m++){var T=c[m];if(!(T in p))break e;p=p[T]}c=c[c.length-1],m=p[c],f=f(m),f!=m&&f!=null&&e(p,c,{configurable:!0,writable:!0,value:f})}}function o(c,f){c instanceof String&&(c+="");var p=0,m=!1,T={next:function(){if(!m&&p<c.length){var N=p++;return{value:f(N,c[N]),done:!1}}return m=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(c){return c||function(){return o(this,function(f,p){return p})}});var s=s||{},a=this||self;function u(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function l(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function d(c,f,p){return c.call.apply(c.bind,arguments)}function h(c,f,p){if(!c)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,m),c.apply(f,T)}}return function(){return c.apply(f,arguments)}}function g(c,f,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function y(c,f){var p=Array.prototype.slice.call(arguments,1);return function(){var m=p.slice();return m.push.apply(m,arguments),c.apply(this,m)}}function I(c,f){function p(){}p.prototype=f.prototype,c.aa=f.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(m,T,N){for(var L=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)L[Ae-2]=arguments[Ae];return f.prototype[T].apply(m,L)}}function b(c){let f=c.length;if(0<f){let p=Array(f);for(let m=0;m<f;m++)p[m]=c[m];return p}return[]}function S(c,f){for(let p=1;p<arguments.length;p++){let m=arguments[p];if(u(m)){let T=c.length||0,N=m.length||0;c.length=T+N;for(let L=0;L<N;L++)c[T+L]=m[L]}else c.push(m)}}class O{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function q(c){return/^[\s\xa0]*$/.test(c)}function V(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function Y(c){return Y[" "](c),c}Y[" "]=function(){};var ee=V().indexOf("Gecko")!=-1&&!(V().toLowerCase().indexOf("webkit")!=-1&&V().indexOf("Edge")==-1)&&!(V().indexOf("Trident")!=-1||V().indexOf("MSIE")!=-1)&&V().indexOf("Edge")==-1;function te(c,f,p){for(let m in c)f.call(p,c[m],m,c)}function w(c,f){for(let p in c)f.call(void 0,c[p],p,c)}function v(c){let f={};for(let p in c)f[p]=c[p];return f}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(c,f){let p,m;for(let T=1;T<arguments.length;T++){m=arguments[T];for(p in m)c[p]=m[p];for(let N=0;N<E.length;N++)p=E[N],Object.prototype.hasOwnProperty.call(m,p)&&(c[p]=m[p])}}function C(c){var f=1;c=c.split(":");let p=[];for(;0<f&&c.length;)p.push(c.shift()),f--;return c.length&&p.push(c.join(":")),p}function A(c){a.setTimeout(()=>{throw c},0)}function _(){var c=Lg;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class ur{constructor(){this.h=this.g=null}add(f,p){let m=eu.get();m.set(f,p),this.h?this.h.next=m:this.g=m,this.h=m}}var eu=new O(()=>new mO,c=>c.reset());class mO{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let tu,nu=!1,Lg=new ur,HD=()=>{let c=a.Promise.resolve(void 0);tu=()=>{c.then(yO)}};var yO=()=>{for(var c;c=_();){try{c.h.call(c.g)}catch(p){A(p)}var f=eu;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}nu=!1};function $r(){this.s=this.s,this.C=this.C}$r.prototype.s=!1,$r.prototype.ma=function(){this.s||(this.s=!0,this.N())},$r.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function gt(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}gt.prototype.h=function(){this.defaultPrevented=!0};var vO=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return c})();function ru(c,f){if(gt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,m=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(ee){e:{try{Y(f.nodeName);var T=!0;break e}catch{}T=!1}T||(f=null)}}else p=="mouseover"?f=c.fromElement:p=="mouseout"&&(f=c.toElement);this.relatedTarget=f,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:_O[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&ru.aa.h.call(this)}}I(ru,gt);var _O={2:"touch",3:"pen",4:"mouse"};ru.prototype.h=function(){ru.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var iu="closure_listenable_"+(1e6*Math.random()|0),EO=0;function IO(c,f,p,m,T){this.listener=c,this.proxy=null,this.src=f,this.type=p,this.capture=!!m,this.ha=T,this.key=++EO,this.da=this.fa=!1}function Wl(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Kl(c){this.src=c,this.g={},this.h=0}Kl.prototype.add=function(c,f,p,m,T){var N=c.toString();c=this.g[N],c||(c=this.g[N]=[],this.h++);var L=Bg(c,f,m,T);return-1<L?(f=c[L],p||(f.fa=!1)):(f=new IO(f,this.src,N,!!m,T),f.fa=p,c.push(f)),f};function jg(c,f){var p=f.type;if(p in c.g){var m=c.g[p],T=Array.prototype.indexOf.call(m,f,void 0),N;(N=0<=T)&&Array.prototype.splice.call(m,T,1),N&&(Wl(f),c.g[p].length==0&&(delete c.g[p],c.h--))}}function Bg(c,f,p,m){for(var T=0;T<c.length;++T){var N=c[T];if(!N.da&&N.listener==f&&N.capture==!!p&&N.ha==m)return T}return-1}var Ug="closure_lm_"+(1e6*Math.random()|0),$g={};function qD(c,f,p,m,T){if(m&&m.once)return GD(c,f,p,m,T);if(Array.isArray(f)){for(var N=0;N<f.length;N++)qD(c,f[N],p,m,T);return null}return p=Gg(p),c&&c[iu]?c.K(f,p,l(m)?!!m.capture:!!m,T):zD(c,f,p,!1,m,T)}function zD(c,f,p,m,T,N){if(!f)throw Error("Invalid event type");var L=l(T)?!!T.capture:!!T,Ae=qg(c);if(Ae||(c[Ug]=Ae=new Kl(c)),p=Ae.add(f,p,m,L,N),p.proxy)return p;if(m=wO(),p.proxy=m,m.src=c,m.listener=p,c.addEventListener)vO||(T=L),T===void 0&&(T=!1),c.addEventListener(f.toString(),m,T);else if(c.attachEvent)c.attachEvent(KD(f.toString()),m);else if(c.addListener&&c.removeListener)c.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return p}function wO(){function c(p){return f.call(c.src,c.listener,p)}let f=DO;return c}function GD(c,f,p,m,T){if(Array.isArray(f)){for(var N=0;N<f.length;N++)GD(c,f[N],p,m,T);return null}return p=Gg(p),c&&c[iu]?c.L(f,p,l(m)?!!m.capture:!!m,T):zD(c,f,p,!0,m,T)}function WD(c,f,p,m,T){if(Array.isArray(f))for(var N=0;N<f.length;N++)WD(c,f[N],p,m,T);else m=l(m)?!!m.capture:!!m,p=Gg(p),c&&c[iu]?(c=c.i,f=String(f).toString(),f in c.g&&(N=c.g[f],p=Bg(N,p,m,T),-1<p&&(Wl(N[p]),Array.prototype.splice.call(N,p,1),N.length==0&&(delete c.g[f],c.h--)))):c&&(c=qg(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Bg(f,p,m,T)),(p=-1<c?f[c]:null)&&Hg(p))}function Hg(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[iu])jg(f.i,c);else{var p=c.type,m=c.proxy;f.removeEventListener?f.removeEventListener(p,m,c.capture):f.detachEvent?f.detachEvent(KD(p),m):f.addListener&&f.removeListener&&f.removeListener(m),(p=qg(f))?(jg(p,c),p.h==0&&(p.src=null,f[Ug]=null)):Wl(c)}}}function KD(c){return c in $g?$g[c]:$g[c]="on"+c}function DO(c,f){if(c.da)c=!0;else{f=new ru(f,this);var p=c.listener,m=c.ha||c.src;c.fa&&Hg(c),c=p.call(m,f)}return c}function qg(c){return c=c[Ug],c instanceof Kl?c:null}var zg="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gg(c){return typeof c=="function"?c:(c[zg]||(c[zg]=function(f){return c.handleEvent(f)}),c[zg])}function mt(){$r.call(this),this.i=new Kl(this),this.M=this,this.F=null}I(mt,$r),mt.prototype[iu]=!0,mt.prototype.removeEventListener=function(c,f,p,m){WD(this,c,f,p,m)};function Mt(c,f){var p,m=c.F;if(m)for(p=[];m;m=m.F)p.push(m);if(c=c.M,m=f.type||f,typeof f=="string")f=new gt(f,c);else if(f instanceof gt)f.target=f.target||c;else{var T=f;f=new gt(m,c),D(f,T)}if(T=!0,p)for(var N=p.length-1;0<=N;N--){var L=f.g=p[N];T=Ql(L,m,!0,f)&&T}if(L=f.g=c,T=Ql(L,m,!0,f)&&T,T=Ql(L,m,!1,f)&&T,p)for(N=0;N<p.length;N++)L=f.g=p[N],T=Ql(L,m,!1,f)&&T}mt.prototype.N=function(){if(mt.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var p=c.g[f],m=0;m<p.length;m++)Wl(p[m]);delete c.g[f],c.h--}}this.F=null},mt.prototype.K=function(c,f,p,m){return this.i.add(String(c),f,!1,p,m)},mt.prototype.L=function(c,f,p,m){return this.i.add(String(c),f,!0,p,m)};function Ql(c,f,p,m){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var T=!0,N=0;N<f.length;++N){var L=f[N];if(L&&!L.da&&L.capture==p){var Ae=L.listener,at=L.ha||L.src;L.fa&&jg(c.i,L),T=Ae.call(at,m)!==!1&&T}}return T&&!m.defaultPrevented}function QD(c,f,p){if(typeof c=="function")p&&(c=g(c,p));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function YD(c){c.g=QD(()=>{c.g=null,c.i&&(c.i=!1,YD(c))},c.l);let f=c.h;c.h=null,c.m.apply(null,f)}class CO extends $r{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:YD(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ou(c){$r.call(this),this.h=c,this.g={}}I(ou,$r);var ZD=[];function XD(c){te(c.g,function(f,p){this.g.hasOwnProperty(p)&&Hg(f)},c),c.g={}}ou.prototype.N=function(){ou.aa.N.call(this),XD(this)},ou.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wg=a.JSON.stringify,TO=a.JSON.parse,bO=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Kg(){}Kg.prototype.h=null;function JD(c){return c.h||(c.h=c.i())}function eC(){}var su={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qg(){gt.call(this,"d")}I(Qg,gt);function Yg(){gt.call(this,"c")}I(Yg,gt);var Ui={},tC=null;function Yl(){return tC=tC||new mt}Ui.La="serverreachability";function nC(c){gt.call(this,Ui.La,c)}I(nC,gt);function au(c){let f=Yl();Mt(f,new nC(f))}Ui.STAT_EVENT="statevent";function rC(c,f){gt.call(this,Ui.STAT_EVENT,c),this.stat=f}I(rC,gt);function Nt(c){let f=Yl();Mt(f,new rC(f,c))}Ui.Ma="timingevent";function iC(c,f){gt.call(this,Ui.Ma,c),this.size=f}I(iC,gt);function uu(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function cu(){this.g=!0}cu.prototype.xa=function(){this.g=!1};function SO(c,f,p,m,T,N){c.info(function(){if(c.g)if(N)for(var L="",Ae=N.split("&"),at=0;at<Ae.length;at++){var ye=Ae[at].split("=");if(1<ye.length){var yt=ye[0];ye=ye[1];var vt=yt.split("_");L=2<=vt.length&&vt[1]=="type"?L+(yt+"="+ye+"&"):L+(yt+"=redacted&")}}else L=null;else L=N;return"XMLHTTP REQ ("+m+") [attempt "+T+"]: "+f+`
`+p+`
`+L})}function AO(c,f,p,m,T,N,L){c.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+T+"]: "+f+`
`+p+`
`+N+" "+L})}function Qo(c,f,p,m){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+MO(c,p)+(m?" "+m:"")})}function RO(c,f){c.info(function(){return"TIMEOUT: "+f})}cu.prototype.info=function(){};function MO(c,f){if(!c.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var m=p[c];if(!(2>m.length)){var T=m[1];if(Array.isArray(T)&&!(1>T.length)){var N=T[0];if(N!="noop"&&N!="stop"&&N!="close")for(var L=1;L<T.length;L++)T[L]=""}}}}return Wg(p)}catch{return f}}var Zl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},oC={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zg;function Xl(){}I(Xl,Kg),Xl.prototype.g=function(){return new XMLHttpRequest},Xl.prototype.i=function(){return{}},Zg=new Xl;function Hr(c,f,p,m){this.j=c,this.i=f,this.l=p,this.R=m||1,this.U=new ou(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sC}function sC(){this.i=null,this.g="",this.h=!1}var aC={},Xg={};function Jg(c,f,p){c.L=1,c.v=nd(cr(f)),c.m=p,c.P=!0,uC(c,null)}function uC(c,f){c.F=Date.now(),Jl(c),c.A=cr(c.v);var p=c.A,m=c.R;Array.isArray(m)||(m=[String(m)]),wC(p.i,"t",m),c.C=0,p=c.j.J,c.h=new sC,c.g=BC(c.j,p?f:null,!c.m),0<c.O&&(c.M=new CO(g(c.Y,c,c.g),c.O)),f=c.U,p=c.g,m=c.ca;var T="readystatechange";Array.isArray(T)||(T&&(ZD[0]=T.toString()),T=ZD);for(var N=0;N<T.length;N++){var L=qD(p,T[N],m||f.handleEvent,!1,f.h||f);if(!L)break;f.g[L.key]=L}f=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),au(),SO(c.i,c.u,c.A,c.l,c.R,c.m)}Hr.prototype.ca=function(c){c=c.target;let f=this.M;f&&lr(c)==3?f.j():this.Y(c)},Hr.prototype.Y=function(c){try{if(c==this.g)e:{let vt=lr(this.g);var f=this.g.Ba();let Xo=this.g.Z();if(!(3>vt)&&(vt!=3||this.g&&(this.h.h||this.g.oa()||RC(this.g)))){this.J||vt!=4||f==7||(f==8||0>=Xo?au(3):au(2)),em(this);var p=this.g.Z();this.X=p;t:if(cC(this)){var m=RC(this.g);c="";var T=m.length,N=lr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$i(this),lu(this);var L="";break t}this.h.i=new a.TextDecoder}for(f=0;f<T;f++)this.h.h=!0,c+=this.h.i.decode(m[f],{stream:!(N&&f==T-1)});m.length=0,this.h.g+=c,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=p==200,AO(this.i,this.u,this.A,this.l,this.R,vt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ae,at=this.g;if((Ae=at.g?at.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Ae)){var ye=Ae;break t}}ye=null}if(p=ye)Qo(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,tm(this,p);else{this.o=!1,this.s=3,Nt(12),$i(this),lu(this);break e}}if(this.P){p=!0;let vn;for(;!this.J&&this.C<L.length;)if(vn=NO(this,L),vn==Xg){vt==4&&(this.s=4,Nt(14),p=!1),Qo(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==aC){this.s=4,Nt(15),Qo(this.i,this.l,L,"[Invalid Chunk]"),p=!1;break}else Qo(this.i,this.l,vn,null),tm(this,vn);if(cC(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vt!=4||L.length!=0||this.h.h||(this.s=1,Nt(16),p=!1),this.o=this.o&&p,!p)Qo(this.i,this.l,L,"[Invalid Chunked Response]"),$i(this),lu(this);else if(0<L.length&&!this.W){this.W=!0;var yt=this.j;yt.g==this&&yt.ba&&!yt.M&&(yt.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),am(yt),yt.M=!0,Nt(11))}}else Qo(this.i,this.l,L,null),tm(this,L);vt==4&&$i(this),this.o&&!this.J&&(vt==4?FC(this.j,this):(this.o=!1,Jl(this)))}else KO(this.g),p==400&&0<L.indexOf("Unknown SID")?(this.s=3,Nt(12)):(this.s=0,Nt(13)),$i(this),lu(this)}}}catch{}finally{}};function cC(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function NO(c,f){var p=c.C,m=f.indexOf(`
`,p);return m==-1?Xg:(p=Number(f.substring(p,m)),isNaN(p)?aC:(m+=1,m+p>f.length?Xg:(f=f.slice(m,m+p),c.C=m+p,f)))}Hr.prototype.cancel=function(){this.J=!0,$i(this)};function Jl(c){c.S=Date.now()+c.I,lC(c,c.I)}function lC(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=uu(g(c.ba,c),f)}function em(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Hr.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(RO(this.i,this.A),this.L!=2&&(au(),Nt(17)),$i(this),this.s=2,lu(this)):lC(this,this.S-c)};function lu(c){c.j.G==0||c.J||FC(c.j,c)}function $i(c){em(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,XD(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function tm(c,f){try{var p=c.j;if(p.G!=0&&(p.g==c||nm(p.h,c))){if(!c.K&&nm(p.h,c)&&p.G==3){try{var m=p.Da.g.parse(f)}catch{m=null}if(Array.isArray(m)&&m.length==3){var T=m;if(T[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)ad(p),od(p);else break e;sm(p),Nt(18)}}else p.za=T[1],0<p.za-p.T&&37500>T[2]&&p.F&&p.v==0&&!p.C&&(p.C=uu(g(p.Za,p),6e3));if(1>=hC(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else qi(p,11)}else if((c.K||p.g==c)&&ad(p),!q(f))for(T=p.Da.g.parse(f),f=0;f<T.length;f++){let ye=T[f];if(p.T=ye[0],ye=ye[1],p.G==2)if(ye[0]=="c"){p.K=ye[1],p.ia=ye[2];let yt=ye[3];yt!=null&&(p.la=yt,p.j.info("VER="+p.la));let vt=ye[4];vt!=null&&(p.Aa=vt,p.j.info("SVER="+p.Aa));let Xo=ye[5];Xo!=null&&typeof Xo=="number"&&0<Xo&&(m=1.5*Xo,p.L=m,p.j.info("backChannelRequestTimeoutMs_="+m)),m=p;let vn=c.g;if(vn){let cd=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cd){var N=m.h;N.g||cd.indexOf("spdy")==-1&&cd.indexOf("quic")==-1&&cd.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(rm(N,N.h),N.h=null))}if(m.D){let um=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;um&&(m.ya=um,Ne(m.I,m.D,um))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),m=p;var L=c;if(m.qa=jC(m,m.J?m.ia:null,m.W),L.K){pC(m.h,L);var Ae=L,at=m.L;at&&(Ae.I=at),Ae.B&&(em(Ae),Jl(Ae)),m.g=L}else OC(m);0<p.i.length&&sd(p)}else ye[0]!="stop"&&ye[0]!="close"||qi(p,7);else p.G==3&&(ye[0]=="stop"||ye[0]=="close"?ye[0]=="stop"?qi(p,7):om(p):ye[0]!="noop"&&p.l&&p.l.ta(ye),p.v=0)}}au(4)}catch{}}var xO=class{constructor(c,f){this.g=c,this.map=f}};function dC(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function fC(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function hC(c){return c.h?1:c.g?c.g.size:0}function nm(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function rm(c,f){c.g?c.g.add(f):c.h=f}function pC(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}dC.prototype.cancel=function(){if(this.i=gC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function gC(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(let p of c.g.values())f=f.concat(p.D);return f}return b(c.i)}function PO(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var f=[],p=c.length,m=0;m<p;m++)f.push(c[m]);return f}f=[],p=0;for(m in c)f[p++]=c[m];return f}function OO(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var f=[];c=c.length;for(var p=0;p<c;p++)f.push(p);return f}f=[],p=0;for(let m in c)f[p++]=m;return f}}}function mC(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var p=OO(c),m=PO(c),T=m.length,N=0;N<T;N++)f.call(void 0,m[N],p&&p[N],c)}var yC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function kO(c,f){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var m=c[p].indexOf("="),T=null;if(0<=m){var N=c[p].substring(0,m);T=c[p].substring(m+1)}else N=c[p];f(N,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Hi(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Hi){this.h=c.h,ed(this,c.j),this.o=c.o,this.g=c.g,td(this,c.s),this.l=c.l;var f=c.i,p=new hu;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),vC(this,p),this.m=c.m}else c&&(f=String(c).match(yC))?(this.h=!1,ed(this,f[1]||"",!0),this.o=du(f[2]||""),this.g=du(f[3]||"",!0),td(this,f[4]),this.l=du(f[5]||"",!0),vC(this,f[6]||"",!0),this.m=du(f[7]||"")):(this.h=!1,this.i=new hu(null,this.h))}Hi.prototype.toString=function(){var c=[],f=this.j;f&&c.push(fu(f,_C,!0),":");var p=this.g;return(p||f=="file")&&(c.push("//"),(f=this.o)&&c.push(fu(f,_C,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(fu(p,p.charAt(0)=="/"?LO:VO,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",fu(p,BO)),c.join("")};function cr(c){return new Hi(c)}function ed(c,f,p){c.j=p?du(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function td(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function vC(c,f,p){f instanceof hu?(c.i=f,UO(c.i,c.h)):(p||(f=fu(f,jO)),c.i=new hu(f,c.h))}function Ne(c,f,p){c.i.set(f,p)}function nd(c){return Ne(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function du(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function fu(c,f,p){return typeof c=="string"?(c=encodeURI(c).replace(f,FO),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function FO(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var _C=/[#\/\?@]/g,VO=/[#\?:]/g,LO=/[#\?]/g,jO=/[#\?@]/g,BO=/#/g;function hu(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function qr(c){c.g||(c.g=new Map,c.h=0,c.i&&kO(c.i,function(f,p){c.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=hu.prototype,n.add=function(c,f){qr(this),this.i=null,c=Yo(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(f),this.h+=1,this};function EC(c,f){qr(c),f=Yo(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function IC(c,f){return qr(c),f=Yo(c,f),c.g.has(f)}n.forEach=function(c,f){qr(this),this.g.forEach(function(p,m){p.forEach(function(T){c.call(f,T,m,this)},this)},this)},n.na=function(){qr(this);let c=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let m=0;m<f.length;m++){let T=c[m];for(let N=0;N<T.length;N++)p.push(f[m])}return p},n.V=function(c){qr(this);let f=[];if(typeof c=="string")IC(this,c)&&(f=f.concat(this.g.get(Yo(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)f=f.concat(c[p])}return f},n.set=function(c,f){return qr(this),this.i=null,c=Yo(this,c),IC(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},n.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function wC(c,f,p){EC(c,f),0<p.length&&(c.i=null,c.g.set(Yo(c,f),b(p)),c.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var m=f[p];let N=encodeURIComponent(String(m)),L=this.V(m);for(m=0;m<L.length;m++){var T=N;L[m]!==""&&(T+="="+encodeURIComponent(String(L[m]))),c.push(T)}}return this.i=c.join("&")};function Yo(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function UO(c,f){f&&!c.j&&(qr(c),c.i=null,c.g.forEach(function(p,m){var T=m.toLowerCase();m!=T&&(EC(this,m),wC(this,T,p))},c)),c.j=f}function $O(c,f){let p=new cu;if(a.Image){let m=new Image;m.onload=y(zr,p,"TestLoadImage: loaded",!0,f,m),m.onerror=y(zr,p,"TestLoadImage: error",!1,f,m),m.onabort=y(zr,p,"TestLoadImage: abort",!1,f,m),m.ontimeout=y(zr,p,"TestLoadImage: timeout",!1,f,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=c}else f(!1)}function HO(c,f){let p=new cu,m=new AbortController,T=setTimeout(()=>{m.abort(),zr(p,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:m.signal}).then(N=>{clearTimeout(T),N.ok?zr(p,"TestPingServer: ok",!0,f):zr(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(T),zr(p,"TestPingServer: error",!1,f)})}function zr(c,f,p,m,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),m(p)}catch{}}function qO(){this.g=new bO}function zO(c,f,p){let m=p||"";try{mC(c,function(T,N){let L=T;l(T)&&(L=Wg(T)),f.push(m+N+"="+encodeURIComponent(L))})}catch(T){throw f.push(m+"type="+encodeURIComponent("_badmap")),T}}function pu(c){this.l=c.Ub||null,this.j=c.eb||!1}I(pu,Kg),pu.prototype.g=function(){return new rd(this.l,this.j)},pu.prototype.i=(function(c){return function(){return c}})({});function rd(c,f){mt.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(rd,mt),n=rd.prototype,n.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,mu(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gu(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,mu(this)),this.g&&(this.readyState=3,mu(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;DC(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function DC(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?gu(this):mu(this),this.readyState==3&&DC(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,gu(this))},n.Qa=function(c){this.g&&(this.response=c,gu(this))},n.ga=function(){this.g&&gu(this)};function gu(c){c.readyState=4,c.l=null,c.j=null,c.v=null,mu(c)}n.setRequestHeader=function(c,f){this.u.append(c,f)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=f.next();return c.join(`\r
`)};function mu(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(rd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function CC(c){let f="";return te(c,function(p,m){f+=m,f+=":",f+=p,f+=`\r
`}),f}function im(c,f,p){e:{for(m in p){var m=!1;break e}m=!0}m||(p=CC(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):Ne(c,f,p))}function $e(c){mt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I($e,mt);var GO=/^https?$/i,WO=["POST","PUT"];n=$e.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,f,p,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zg.g(),this.v=this.o?JD(this.o):JD(Zg),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(N){TC(this,N);return}if(c=p||"",p=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var T in m)p.set(T,m[T]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let N of m.keys())p.set(N,m.get(N));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(p.keys()).find(N=>N.toLowerCase()=="content-type"),T=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(WO,f,void 0))||m||T||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,L]of p)this.g.setRequestHeader(N,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{AC(this),this.u=!0,this.g.send(c),this.u=!1}catch(N){TC(this,N)}};function TC(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,bC(c),id(c)}function bC(c){c.A||(c.A=!0,Mt(c,"complete"),Mt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Mt(this,"complete"),Mt(this,"abort"),id(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),id(this,!0)),$e.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?SC(this):this.bb())},n.bb=function(){SC(this)};function SC(c){if(c.h&&typeof s<"u"&&(!c.v[1]||lr(c)!=4||c.Z()!=2)){if(c.u&&lr(c)==4)QD(c.Ea,0,c);else if(Mt(c,"readystatechange"),lr(c)==4){c.h=!1;try{let L=c.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var m;if(m=L===0){var T=String(c.D).match(yC)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),m=!GO.test(T?T.toLowerCase():"")}p=m}if(p)Mt(c,"complete"),Mt(c,"success");else{c.m=6;try{var N=2<lr(c)?c.g.statusText:""}catch{N=""}c.l=N+" ["+c.Z()+"]",bC(c)}}finally{id(c)}}}}function id(c,f){if(c.g){AC(c);let p=c.g,m=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||Mt(c,"ready");try{p.onreadystatechange=m}catch{}}}function AC(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function lr(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<lr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),TO(f)}};function RC(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function KO(c){let f={};c=(c.g&&2<=lr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<c.length;m++){if(q(c[m]))continue;var p=C(c[m]);let T=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let N=f[T]||[];f[T]=N,N.push(p)}w(f,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function yu(c,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||f}function MC(c){this.Aa=0,this.i=[],this.j=new cu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=yu("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=yu("baseRetryDelayMs",5e3,c),this.cb=yu("retryDelaySeedMs",1e4,c),this.Wa=yu("forwardChannelMaxRetries",2,c),this.wa=yu("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new dC(c&&c.concurrentRequestLimit),this.Da=new qO,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=MC.prototype,n.la=8,n.G=1,n.connect=function(c,f,p,m){Nt(0),this.W=c,this.H=f||{},p&&m!==void 0&&(this.H.OSID=p,this.H.OAID=m),this.F=this.X,this.I=jC(this,null,this.W),sd(this)};function om(c){if(NC(c),c.G==3){var f=c.U++,p=cr(c.I);if(Ne(p,"SID",c.K),Ne(p,"RID",f),Ne(p,"TYPE","terminate"),vu(c,p),f=new Hr(c,c.j,f),f.L=2,f.v=nd(cr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=BC(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Jl(f)}LC(c)}function od(c){c.g&&(am(c),c.g.cancel(),c.g=null)}function NC(c){od(c),c.u&&(a.clearTimeout(c.u),c.u=null),ad(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function sd(c){if(!fC(c.h)&&!c.s){c.s=!0;var f=c.Ga;tu||HD(),nu||(tu(),nu=!0),Lg.add(f,c),c.B=0}}function QO(c,f){return hC(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=uu(g(c.Ga,c,f),VC(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let T=new Hr(this,this.j,c),N=this.o;if(this.S&&(N?(N=v(N),D(N,this.S)):N=this.S),this.m!==null||this.O||(T.H=N,N=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var m=this.i[p];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(f+=m,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=PC(this,T,f),p=cr(this.I),Ne(p,"RID",c),Ne(p,"CVER",22),this.D&&Ne(p,"X-HTTP-Session-Id",this.D),vu(this,p),N&&(this.O?f="headers="+encodeURIComponent(String(CC(N)))+"&"+f:this.m&&im(p,this.m,N)),rm(this.h,T),this.Ua&&Ne(p,"TYPE","init"),this.P?(Ne(p,"$req",f),Ne(p,"SID","null"),T.T=!0,Jg(T,p,null)):Jg(T,p,f),this.G=2}}else this.G==3&&(c?xC(this,c):this.i.length==0||fC(this.h)||xC(this))};function xC(c,f){var p;f?p=f.l:p=c.U++;let m=cr(c.I);Ne(m,"SID",c.K),Ne(m,"RID",p),Ne(m,"AID",c.T),vu(c,m),c.m&&c.o&&im(m,c.m,c.o),p=new Hr(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),f&&(c.i=f.D.concat(c.i)),f=PC(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),rm(c.h,p),Jg(p,m,f)}function vu(c,f){c.H&&te(c.H,function(p,m){Ne(f,m,p)}),c.l&&mC({},function(p,m){Ne(f,m,p)})}function PC(c,f,p){p=Math.min(c.i.length,p);var m=c.l?g(c.l.Na,c.l,c):null;e:{var T=c.i;let N=-1;for(;;){let L=["count="+p];N==-1?0<p?(N=T[0].g,L.push("ofs="+N)):N=0:L.push("ofs="+N);let Ae=!0;for(let at=0;at<p;at++){let ye=T[at].g,yt=T[at].map;if(ye-=N,0>ye)N=Math.max(0,T[at].g-100),Ae=!1;else try{zO(yt,L,"req"+ye+"_")}catch{m&&m(yt)}}if(Ae){m=L.join("&");break e}}}return c=c.i.splice(0,p),f.D=c,m}function OC(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;tu||HD(),nu||(tu(),nu=!0),Lg.add(f,c),c.v=0}}function sm(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=uu(g(c.Fa,c),VC(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,kC(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=uu(g(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nt(10),od(this),kC(this))};function am(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function kC(c){c.g=new Hr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=cr(c.qa);Ne(f,"RID","rpc"),Ne(f,"SID",c.K),Ne(f,"AID",c.T),Ne(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&Ne(f,"TO",c.ja),Ne(f,"TYPE","xmlhttp"),vu(c,f),c.m&&c.o&&im(f,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=nd(cr(f)),p.m=null,p.P=!0,uC(p,c)}n.Za=function(){this.C!=null&&(this.C=null,od(this),sm(this),Nt(19))};function ad(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function FC(c,f){var p=null;if(c.g==f){ad(c),am(c),c.g=null;var m=2}else if(nm(c.h,f))p=f.D,pC(c.h,f),m=1;else return;if(c.G!=0){if(f.o)if(m==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var T=c.B;m=Yl(),Mt(m,new iC(m,p)),sd(c)}else OC(c);else if(T=f.s,T==3||T==0&&0<f.X||!(m==1&&QO(c,f)||m==2&&sm(c)))switch(p&&0<p.length&&(f=c.h,f.i=f.i.concat(p)),T){case 1:qi(c,5);break;case 4:qi(c,10);break;case 3:qi(c,6);break;default:qi(c,2)}}}function VC(c,f){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*f}function qi(c,f){if(c.j.info("Error code "+f),f==2){var p=g(c.fb,c),m=c.Xa;let T=!m;m=new Hi(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ed(m,"https"),nd(m),T?$O(m.toString(),p):HO(m.toString(),p)}else Nt(2);c.G=0,c.l&&c.l.sa(f),LC(c),NC(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function LC(c){if(c.G=0,c.ka=[],c.l){let f=gC(c.h);(f.length!=0||c.i.length!=0)&&(S(c.ka,f),S(c.ka,c.i),c.h.i.length=0,b(c.i),c.i.length=0),c.l.ra()}}function jC(c,f,p){var m=p instanceof Hi?cr(p):new Hi(p);if(m.g!="")f&&(m.g=f+"."+m.g),td(m,m.s);else{var T=a.location;m=T.protocol,f=f?f+"."+T.hostname:T.hostname,T=+T.port;var N=new Hi(null);m&&ed(N,m),f&&(N.g=f),T&&td(N,T),p&&(N.l=p),m=N}return p=c.D,f=c.ya,p&&f&&Ne(m,p,f),Ne(m,"VER",c.la),vu(c,m),m}function BC(c,f,p){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new $e(new pu({eb:p})):new $e(c.pa),f.Ha(c.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function UC(){}n=UC.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ud(){}ud.prototype.g=function(c,f){return new Qt(c,f)};function Qt(c,f){mt.call(this),this.g=new MC(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!q(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!q(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Zo(this)}I(Qt,mt),Qt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Qt.prototype.close=function(){om(this.g)},Qt.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=Wg(c),c=p);f.i.push(new xO(f.Ya++,c)),f.G==3&&sd(f)},Qt.prototype.N=function(){this.g.l=null,delete this.j,om(this.g),delete this.g,Qt.aa.N.call(this)};function $C(c){Qg.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(let p in f){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}I($C,Qg);function HC(){Yg.call(this),this.status=1}I(HC,Yg);function Zo(c){this.g=c}I(Zo,UC),Zo.prototype.ua=function(){Mt(this.g,"a")},Zo.prototype.ta=function(c){Mt(this.g,new $C(c))},Zo.prototype.sa=function(c){Mt(this.g,new HC)},Zo.prototype.ra=function(){Mt(this.g,"b")},ud.prototype.createWebChannel=ud.prototype.g,Qt.prototype.send=Qt.prototype.o,Qt.prototype.open=Qt.prototype.m,Qt.prototype.close=Qt.prototype.close,TE=Nr.createWebChannelTransport=function(){return new ud},CE=Nr.getStatEventTarget=function(){return Yl()},DE=Nr.Event=Ui,rp=Nr.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zl.NO_ERROR=0,Zl.TIMEOUT=8,Zl.HTTP_ERROR=6,Zc=Nr.ErrorCode=Zl,oC.COMPLETE="complete",wE=Nr.EventType=oC,eC.EventType=su,su.OPEN="a",su.CLOSE="b",su.ERROR="c",su.MESSAGE="d",mt.prototype.listen=mt.prototype.K,oa=Nr.WebChannel=eC,m$=Nr.FetchXmlHttpFactory=pu,$e.prototype.listenOnce=$e.prototype.L,$e.prototype.getLastError=$e.prototype.Ka,$e.prototype.getLastErrorCode=$e.prototype.Ba,$e.prototype.getStatus=$e.prototype.Z,$e.prototype.getResponseJson=$e.prototype.Oa,$e.prototype.getResponseText=$e.prototype.oa,$e.prototype.send=$e.prototype.ea,$e.prototype.setWithCredentials=$e.prototype.Ha,IE=Nr.XhrIo=$e}).apply(typeof np<"u"?np:typeof self<"u"?self:typeof window<"u"?window:{});var nM="@firebase/firestore",rM="4.8.0";var Xe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Xe.UNAUTHENTICATED=new Xe(null),Xe.GOOGLE_CREDENTIALS=new Xe("google-credentials-uid"),Xe.FIRST_PARTY=new Xe("first-party-uid"),Xe.MOCK_USER=new Xe("mock-user");var qa="11.10.0";var Ti=new hd("@firebase/firestore");function fa(){return Ti.logLevel}function vN(n){Ti.setLogLevel(n)}function k(n,...e){if(Ti.logLevel<=kn.DEBUG){let t=e.map(jw);Ti.debug(`Firestore (${qa}): ${n}`,...t)}}function ze(n,...e){if(Ti.logLevel<=kn.ERROR){let t=e.map(jw);Ti.error(`Firestore (${qa}): ${n}`,...t)}}function Kt(n,...e){if(Ti.logLevel<=kn.WARN){let t=e.map(jw);Ti.warn(`Firestore (${qa}): ${n}`,...t)}}function jw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function H(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,_N(n,r,t)}function _N(n,e,t){let r=`FIRESTORE (${qa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ze(r),new Error(r)}function G(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||_N(e,i,r)}function EN(n,e){n||H(57014,e)}function U(n,e){return n}var M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends ZC{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var rt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var yp=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},PE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Xe.UNAUTHENTICATED))}shutdown(){}},OE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},kE=class{constructor(e){this.t=e,this.currentUser=Xe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){G(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),o=new rt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new rt,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let u=o;e.enqueueRetryable(()=>x(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new rt)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(G(typeof r.accessToken=="string",31837,{l:r}),new yp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string",2055,{h:e}),new Xe(e)}},FE=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Xe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},VE=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new FE(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Xe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},vp=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},LE=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,JC(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){G(this.o===void 0,3512);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new vp(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(G(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function y$(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Bw(){return new TextEncoder}var fl=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=y$(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function J(n,e){return n<e?-1:n>e?1:0}function jE(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return J(r,i);{let o=Bw(),s=v$(o.encode(iM(n,t)),o.encode(iM(e,t)));return s!==0?s:J(r,i)}}t+=r>65535?2:1}return J(n.length,e.length)}function iM(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function v$(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return J(n[t],e[t]);return J(n.length,e.length)}function Ia(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function IN(n){return n+"\0"}var oM="__name__",_p=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&H(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return J(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):jE(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Mr.fromString(e.substring(4,e.length-2))}},pe=class n extends _p{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},_$=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ge=class n extends _p{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return _$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===oM}static keyField(){return new n([oM])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new P(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(pe.fromString(e))}static fromName(e){return new n(pe.fromString(e).popFirst(5))}static empty(){return new n(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new pe(e.slice()))}};function Uw(n,e,t){if(!t)throw new P(M.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $w(n,e,t,r){if(e===!0&&r===!0)throw new P(M.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sM(n){if(!B.isDocumentKey(n))throw new P(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function aM(n){if(B.isDocumentKey(n))throw new P(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wN(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function vg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H(12329,{type:typeof n})}function me(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=vg(n);throw new P(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function DN(n,e){if(e<=0)throw new P(M.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Je(n,e){let t={typeString:n};return e&&(t.value=e),t}function Vl(n,e){if(!wN(n))throw new P(M.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new P(M.INVALID_ARGUMENT,t);return!0}var uM=-62135596800,cM=1e6,Me=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*cM);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<uM)throw new P(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cM}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vl(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-uM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Me._jsonSchemaVersion="firestore/timestamp/1.0",Me._jsonSchema={type:Je("string",Me._jsonSchemaVersion),seconds:Je("number"),nanoseconds:Je("number")};var Q=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Me(0,0))}static max(){return new n(new Me(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var wa=-1,Da=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function BE(n){return n.fields.find(e=>e.kind===2)}function Do(n){return n.fields.filter(e=>e.kind!==2)}Da.UNKNOWN_ID=-1;var va=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var hl=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,yn.min())}};function CN(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Q.fromTimestamp(r===1e9?new Me(t+1,0):new Me(t,r));return new yn(i,B.empty(),e)}function TN(n){return new yn(n.readTime,n.key,wa)}var yn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Q.min(),B.empty(),wa)}static max(){return new n(Q.max(),B.empty(),wa)}};function Hw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:J(n.largestBatchId,e.largestBatchId))}var bN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ep=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Fi(n){return x(this,null,function*(){if(n.code!==M.FAILED_PRECONDITION||n.message!==bN)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},u=>r(u))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let u=0;u<o;u++){let l=u;t(e[l]).next(d=>{s[l]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var un="SimpleDb",Ip=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new No(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new rt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new No(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=qw(r.target.error);this.S.reject(new No(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(k(un,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new $E(t)}},bi=class n{static delete(e){return k(un,"Removing database:",e),To(lm().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!dd())return!1;if(n.F())return!0;let e=_u(),t=n.M(e),r=0<t&&t<10,i=SN(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,n.M(_u())===12.2&&ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}k(e){return x(this,null,function*(){return this.db||(k(un,"Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new No(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new No(e,s))},i.onupgradeneeded=o=>{k(un,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;if(this.L!==null&&this.L!==o.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${o.oldVersion}, event.newVersion=${o.newVersion}, db.version=${s.version}`);this.B.q(s,i.transaction,o.oldVersion,this.version).next(()=>{k(un,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{let r=t.target;this.L=r.version},{passive:!0})),this.db.addEventListener("versionchange",t=>{var r;t.newVersion===null&&(Kt('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),(r=this.databaseDeletedListener)===null||r===void 0||r.call(this))},{passive:!0}),this.db})}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}runTransaction(e,t,r,i){return x(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.k(e);let a=Ip.open(this.db,e,o?"readonly":"readwrite",r),u=i(a).next(l=>(a.v(),l)).catch(l=>(a.abort(l),R.reject(l))).toPromise();return u.catch(()=>{}),yield a.D,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&s<3;if(k(un,"Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function SN(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var UE=class{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return To(this.$.delete())}},No=class extends P{constructor(e,t){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Vi(n){return n.name==="IndexedDbTransactionError"}var $E=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k(un,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(k(un,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),To(r)}add(e){return k(un,"ADD",this.store.name,e,e),To(this.store.add(e))}get(e){return To(this.store.get(e)).next(t=>(t===void 0&&(t=null),k(un,"GET",this.store.name,e,t),t))}delete(e){return k(un,"DELETE",this.store.name,e),To(this.store.delete(e))}count(){return k(un,"COUNT",this.store.name),To(this.store.count())}j(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new R((s,a)=>{o.onerror=u=>{a(u.target.error)},o.onsuccess=u=>{s(u.target.result)}})}{let o=this.cursor(r),s=[];return this.J(o,(a,u)=>{s.push(u)}).next(()=>s)}}H(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new R((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}Y(e,t){k(un,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Z=!1;let i=this.cursor(r);return this.J(i,(o,s,a)=>a.delete())}X(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.J(i,t)}ee(e){let t=this.cursor({});return new R((r,i)=>{t.onerror=o=>{let s=qw(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}J(e,t){let r=[];return new R((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let u=new UE(a),l=t(a.primaryKey,a.value,u);if(l instanceof R){let d=l.catch(h=>(u.done(),R.reject(h)));r.push(d)}u.isDone?i():u.W===null?a.continue():a.continue(u.W)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function To(n){return new R((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=qw(r.target.error);t(i)}})}var lM=!1;function qw(n){let e=bi.M(_u());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lM||(lM=!0,setTimeout(()=>{throw r},0)),r}}return n}var il="IndexBackfiller",HE=class{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ne(e){k(il,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{let t=yield this.te.re();k(il,`Documents written: ${t}`)}catch(t){Vi(t)?k(il,"Ignoring IndexedDB error during index backfill: ",t):yield Fi(t)}yield this.ne(6e4)}))}},qE=class{constructor(e,t){this.localStore=e,this.persistence=t}re(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ie(t,e))})}ie(e,t){let r=new Set,i=t,o=!0;return R.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k(il,`Processing collection: ${s}`),this.se(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}se(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.oe(i,o)).next(a=>(k(il,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}oe(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=TN(o);Hw(s,r)>0&&(r=s)}),new yn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var cn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),wi=-1;function Ll(n){return n==null}function pl(n){return n===0&&1/n==-1/0}function AN(n){return typeof n=="number"&&Number.isInteger(n)&&!pl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var wp="";function Rt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=dM(e)),e=E$(n.get(t),e);return dM(e)}function E$(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case wp:t+="";break;default:t+=o}}return t}function dM(n){return n+wp+""}function Jn(n){let e=n.length;if(G(e>=2,64408,{path:n}),e===2)return G(n.charAt(0)===wp&&n.charAt(1)==="",56145,{path:n}),pe.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf(wp,o);switch((s<0||s>t)&&H(50515,{path:n}),n.charAt(s+1)){case"":let a=n.substring(o,s),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:H(61167,{path:n})}o=s+2}return new pe(r)}var Co="remoteDocuments",jl="owner",sa="owner",gl="mutationQueues",I$="userId",Mn="mutations",fM="batchId",Ro="userMutationsIndex",hM=["userId","batchId"];function cp(n,e){return[n,Rt(e)]}function RN(n,e,t){return[n,Rt(e),t]}var w$={},Ca="documentMutations",Dp="remoteDocumentsV14",D$=["prefixPath","collectionGroup","readTime","documentId"],lp="documentKeyIndex",C$=["prefixPath","collectionGroup","documentId"],MN="collectionGroupIndex",T$=["collectionGroup","readTime","prefixPath","documentId"],ml="remoteDocumentGlobal",zE="remoteDocumentGlobalKey",Ta="targets",NN="queryTargetsIndex",b$=["canonicalId","targetId"],ba="targetDocuments",S$=["targetId","path"],zw="documentTargetsIndex",A$=["path","targetId"],Cp="targetGlobalKey",xo="targetGlobal",yl="collectionParents",R$=["collectionId","parent"],Sa="clientMetadata",M$="clientId",_g="bundles",N$="bundleId",Eg="namedQueries",x$="name",Gw="indexConfiguration",P$="indexId",GE="collectionGroupIndex",O$="collectionGroup",ol="indexState",k$=["indexId","uid"],xN="sequenceNumberIndex",F$=["uid","sequenceNumber"],sl="indexEntries",V$=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],PN="documentKeyIndex",L$=["indexId","uid","orderedDocumentKey"],Ig="documentOverlays",j$=["userId","collectionPath","documentId"],WE="collectionPathOverlayIndex",B$=["userId","collectionPath","largestBatchId"],ON="collectionGroupOverlayIndex",U$=["userId","collectionGroup","largestBatchId"],Ww="globals",$$="name",kN=[gl,Mn,Ca,Co,Ta,jl,xo,ba,Sa,ml,yl,_g,Eg],H$=[...kN,Ig],FN=[gl,Mn,Ca,Dp,Ta,jl,xo,ba,Sa,ml,yl,_g,Eg,Ig],VN=FN,Kw=[...VN,Gw,ol,sl],q$=Kw,LN=[...Kw,Ww],z$=LN;var vl=class extends Ep{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}};function it(n,e){let t=U(n);return bi.N(t.ce,e)}function pM(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function jN(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Oe=class n{constructor(e,t){this.comparator=e,this.root=t||tr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ya(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ya(this.root,e,this.comparator,!1)}getReverseIterator(){return new ya(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ya(this.root,e,this.comparator,!0)}},ya=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},tr=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw H(43730,{key:this.key,value:this.value});if(this.right.isRed())throw H(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw H(27949);return e+(this.isRed()?0:1)}};tr.EMPTY=null,tr.RED=!0,tr.BLACK=!1;tr.EMPTY=new class{constructor(){this.size=0}get key(){throw H(57766)}get value(){throw H(16141)}get color(){throw H(16727)}get left(){throw H(29726)}get right(){throw H(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new tr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class n{constructor(e){this.comparator=e,this.data=new Oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tp(this.data.getIterator())}getIteratorFrom(e){return new Tp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Tp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function aa(n){return n.hasNext()?n.getNext():void 0}var ln=class n{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new n([])}unionWith(e){let t=new Se(Ge.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ia(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var bp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function BN(){return typeof atob<"u"}var Ke=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new bp("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ke.EMPTY_BYTE_STRING=new Ke("");var G$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Or(n){if(G(!!n,39018),typeof n=="string"){let e=0,t=G$.exec(n);if(G(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Le(n.seconds),nanos:Le(n.nanos)}}function Le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function kr(n){return typeof n=="string"?Ke.fromBase64String(n):Ke.fromUint8Array(n)}var UN="server_timestamp",$N="__type__",HN="__previous_value__",qN="__local_write_time__";function wg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[$N])===null||t===void 0?void 0:t.stringValue)===UN}function Dg(n){let e=n.mapValue.fields[HN];return wg(e)?Dg(e):e}function _l(n){let e=Or(n.mapValue.fields[qN].timestampValue);return new Me(e.seconds,e.nanos)}var KE=class{constructor(e,t,r,i,o,s,a,u,l,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=d}},QE="(default)",Si=class n{constructor(e,t){this.projectId=e,this.database=t||QE}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===QE}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Qw="__type__",zN="__max__",Ei={mapValue:{fields:{__type__:{stringValue:zN}}}},Yw="__vector__",Aa="value",dp={nullValue:"NULL_VALUE"};function Ai(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?wg(n)?4:GN(n)?9007199254740991:Cg(n)?10:11:H(28295,{value:n})}function or(n,e){if(n===e)return!0;let t=Ai(n);if(t!==Ai(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return _l(n).isEqual(_l(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Or(i.timestampValue),a=Or(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return kr(i.bytesValue).isEqual(kr(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return Le(i.geoPointValue.latitude)===Le(o.geoPointValue.latitude)&&Le(i.geoPointValue.longitude)===Le(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return Le(i.integerValue)===Le(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Le(i.doubleValue),a=Le(o.doubleValue);return s===a?pl(s)===pl(a):isNaN(s)&&isNaN(a)}return!1})(n,e);case 9:return Ia(n.arrayValue.values||[],e.arrayValue.values||[],or);case 10:case 11:return(function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(pM(s)!==pM(a))return!1;for(let u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!or(s[u],a[u])))return!1;return!0})(n,e);default:return H(52216,{left:n})}}function El(n,e){return(n.values||[]).find(t=>or(t,e))!==void 0}function Ri(n,e){if(n===e)return 0;let t=Ai(n),r=Ai(e);if(t!==r)return J(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return J(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let a=Le(o.integerValue||o.doubleValue),u=Le(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1})(n,e);case 3:return gM(n.timestampValue,e.timestampValue);case 4:return gM(_l(n),_l(e));case 5:return jE(n.stringValue,e.stringValue);case 6:return(function(o,s){let a=kr(o),u=kr(s);return a.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){let d=J(a[l],u[l]);if(d!==0)return d}return J(a.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let a=J(Le(o.latitude),Le(s.latitude));return a!==0?a:J(Le(o.longitude),Le(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return mM(n.arrayValue,e.arrayValue);case 10:return(function(o,s){var a,u,l,d;let h=o.fields||{},g=s.fields||{},y=(a=h[Aa])===null||a===void 0?void 0:a.arrayValue,I=(u=g[Aa])===null||u===void 0?void 0:u.arrayValue,b=J(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((d=I?.values)===null||d===void 0?void 0:d.length)||0);return b!==0?b:mM(y,I)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Ei.mapValue&&s===Ei.mapValue)return 0;if(o===Ei.mapValue)return 1;if(s===Ei.mapValue)return-1;let a=o.fields||{},u=Object.keys(a),l=s.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let h=0;h<u.length&&h<d.length;++h){let g=jE(u[h],d[h]);if(g!==0)return g;let y=Ri(a[u[h]],l[d[h]]);if(y!==0)return y}return J(u.length,d.length)})(n.mapValue,e.mapValue);default:throw H(23264,{le:t})}}function gM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return J(n,e);let t=Or(n),r=Or(e),i=J(t.seconds,r.seconds);return i!==0?i:J(t.nanos,r.nanos)}function mM(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Ri(t[i],r[i]);if(o)return o}return J(t.length,r.length)}function Ra(n){return YE(n)}function YE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Or(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return kr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return B.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=YE(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${YE(t.fields[s])}`;return i+"}"})(n.mapValue):H(61005,{value:n})}function fp(n){switch(Ai(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Dg(n);return e?16+fp(e):16;case 5:return 2*n.stringValue.length;case 6:return kr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+fp(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Li(r.fields,(o,s)=>{i+=o.length+fp(s)}),i})(n.mapValue);default:throw H(13486,{value:n})}}function Po(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ZE(n){return!!n&&"integerValue"in n}function Il(n){return!!n&&"arrayValue"in n}function yM(n){return!!n&&"nullValue"in n}function vM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function hp(n){return!!n&&"mapValue"in n}function Cg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Qw])===null||t===void 0?void 0:t.stringValue)===Yw}function al(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Li(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=al(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=al(n.arrayValue.values[t]);return e}return Object.assign({},n)}function GN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===zN}var WN={mapValue:{fields:{[Qw]:{stringValue:Yw},[Aa]:{arrayValue:{}}}}};function W$(n){return"nullValue"in n?dp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Po(Si.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Cg(n)?WN:{mapValue:{}}:H(35942,{value:n})}function K$(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Po(Si.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?WN:"mapValue"in n?Cg(n)?{mapValue:{}}:Ei:H(61959,{value:n})}function _M(n,e){let t=Ri(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function EM(n,e){let t=Ri(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var At=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!hp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=al(t)}setAll(e){let t=Ge.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=al(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());hp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return or(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];hp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Li(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(al(this.value))}};function KN(n){let e=[];return Li(n.fields,(t,r)=>{let i=new Ge([t]);if(hp(r)){let o=KN(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new ln(e)}var et=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Q.min(),Q.min(),Q.min(),At.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Q.min(),Q.min(),At.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Q.min(),Q.min(),At.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=At.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=At.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var sr=class{constructor(e,t){this.position=e,this.inclusive=t}};function IM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(s.referenceValue),t.key):r=Ri(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function wM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!or(n.position[t],e.position[t]))return!1;return!0}var Oo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Q$(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Sp=class{},fe=class n extends Sp{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new eI(e,t,r):t==="array-contains"?new rI(e,r):t==="in"?new Ap(e,r):t==="not-in"?new iI(e,r):t==="array-contains-any"?new oI(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new tI(e,r):new nI(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ri(t,this.value)):t!==null&&Ai(this.value)===Ai(t)&&this.matchesComparison(Ri(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ce=class n extends Sp{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return Ma(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function Ma(n){return n.op==="and"}function XE(n){return n.op==="or"}function Zw(n){return QN(n)&&Ma(n)}function QN(n){for(let e of n.filters)if(e instanceof Ce)return!1;return!0}function JE(n){if(n instanceof fe)return n.field.canonicalString()+n.op.toString()+Ra(n.value);if(Zw(n))return n.filters.map(e=>JE(e)).join(",");{let e=n.filters.map(t=>JE(t)).join(",");return`${n.op}(${e})`}}function YN(n,e){return n instanceof fe?(function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&or(r.value,i.value)})(n,e):n instanceof Ce?(function(r,i){return i instanceof Ce&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&YN(s,i.filters[a]),!0):!1})(n,e):void H(19439)}function ZN(n,e){let t=n.filters.concat(e);return Ce.create(t,n.op)}function XN(n){return n instanceof fe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ra(t.value)}`})(n):n instanceof Ce?(function(t){return t.op.toString()+" {"+t.getFilters().map(XN).join(" ,")+"}"})(n):"Filter"}var eI=class extends fe{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},tI=class extends fe{constructor(e,t){super(e,"in",t),this.keys=JN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},nI=class extends fe{constructor(e,t){super(e,"not-in",t),this.keys=JN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function JN(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var rI=class extends fe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Il(t)&&El(t.arrayValue,this.value)}},Ap=class extends fe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&El(this.value.arrayValue,t)}},iI=class extends fe{constructor(e,t){super(e,"not-in",t)}matches(e){if(El(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!El(this.value.arrayValue,t)}},oI=class extends fe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>El(this.value.arrayValue,r))}};var sI=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Pe=null}};function aI(n,e=null,t=[],r=[],i=null,o=null,s=null){return new sI(n,e,t,r,i,o,s)}function ko(n){let e=U(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>JE(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),Ll(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ra(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ra(r)).join(",")),e.Pe=t}return e.Pe}function Bl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Q$(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!YN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!wM(n.startAt,e.startAt)&&wM(n.endAt,e.endAt)}function Rp(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Mp(n,e){return n.filters.filter(t=>t instanceof fe&&t.field.isEqual(e))}function DM(n,e,t){let r=dp,i=!0;for(let o of Mp(n,e)){let s=dp,a=!0;switch(o.op){case"<":case"<=":s=W$(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=dp}_M({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];_M({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function CM(n,e,t){let r=Ei,i=!0;for(let o of Mp(n,e)){let s=Ei,a=!0;switch(o.op){case">=":case">":s=K$(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Ei}EM({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];EM({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var Nn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function ex(n,e,t,r,i,o,s,a){return new Nn(n,e,t,r,i,o,s,a)}function za(n){return new Nn(n)}function TM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Xw(n){return n.collectionGroup!==null}function _a(n){let e=U(n);if(e.Te===null){e.Te=[];let t=new Set;for(let o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Se(Ge.comparator);return s.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new Oo(o,r))}),t.has(Ge.keyField().canonicalString())||e.Te.push(new Oo(Ge.keyField(),r))}return e.Te}function kt(n){let e=U(n);return e.Ie||(e.Ie=Y$(e,_a(n))),e.Ie}function Y$(n,e){if(n.limitType==="F")return aI(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Oo(i.field,o)});let t=n.endAt?new sr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new sr(n.startAt.position,n.startAt.inclusive):null;return aI(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function uI(n,e){let t=n.filters.concat([e]);return new Nn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Np(n,e,t){return new Nn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ul(n,e){return Bl(kt(n),kt(e))&&n.limitType===e.limitType}function tx(n){return`${ko(kt(n))}|lt:${n.limitType}`}function ha(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>XN(i)).join(", ")}]`),Ll(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ra(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ra(i)).join(",")),`Target(${r})`})(kt(n))}; limitType=${n.limitType})`}function $l(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of _a(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,a,u){let l=IM(s,a,u);return s.inclusive?l<=0:l<0})(r.startAt,_a(r),i)||r.endAt&&!(function(s,a,u){let l=IM(s,a,u);return s.inclusive?l>=0:l>0})(r.endAt,_a(r),i))})(n,e)}function nx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rx(n){return(e,t)=>{let r=!1;for(let i of _a(n)){let o=Z$(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Z$(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):(function(o,s,a){let u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?Ri(u,l):H(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H(19790,{direction:n.dir})}}var xn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return jN(this.inner)}size(){return this.innerSize}};var X$=new Oe(B.comparator);function Gt(){return X$}var ix=new Oe(B.comparator);function nl(...n){let e=ix;for(let t of n)e=e.insert(t.key,t);return e}function ox(n){let e=ix;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function er(){return ul()}function sx(){return ul()}function ul(){return new xn(n=>n.toString(),(n,e)=>n.isEqual(e))}var J$=new Oe(B.comparator),eH=new Se(B.comparator);function ae(...n){let e=eH;for(let t of n)e=e.add(t);return e}var tH=new Se(J);function Jw(){return tH}function eD(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pl(e)?"-0":e}}function ax(n){return{integerValue:""+n}}function ux(n,e){return AN(e)?ax(e):eD(n,e)}var Na=class{constructor(){this._=void 0}};function nH(n,e,t){return n instanceof Mi?(function(i,o){let s={fields:{[$N]:{stringValue:UN},[qN]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&wg(o)&&(o=Dg(o)),o&&(s.fields[HN]=o),{mapValue:s}})(t,e):n instanceof Fr?lx(n,e):n instanceof Vr?dx(n,e):(function(i,o){let s=cx(i,o),a=bM(s)+bM(i.Ee);return ZE(s)&&ZE(i.Ee)?ax(a):eD(i.serializer,a)})(n,e)}function rH(n,e,t){return n instanceof Fr?lx(n,e):n instanceof Vr?dx(n,e):t}function cx(n,e){return n instanceof Ni?(function(r){return ZE(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var Mi=class extends Na{},Fr=class extends Na{constructor(e){super(),this.elements=e}};function lx(n,e){let t=fx(e);for(let r of n.elements)t.some(i=>or(i,r))||t.push(r);return{arrayValue:{values:t}}}var Vr=class extends Na{constructor(e){super(),this.elements=e}};function dx(n,e){let t=fx(e);for(let r of n.elements)t=t.filter(i=>!or(i,r));return{arrayValue:{values:t}}}var Ni=class extends Na{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function bM(n){return Le(n.integerValue||n.doubleValue)}function fx(n){return Il(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Fo=class{constructor(e,t){this.field=e,this.transform=t}};function iH(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Fr&&i instanceof Fr||r instanceof Vr&&i instanceof Vr?Ia(r.elements,i.elements,or):r instanceof Ni&&i instanceof Ni?or(r.Ee,i.Ee):r instanceof Mi&&i instanceof Mi})(n.transform,e.transform)}var cI=class{constructor(e,t){this.version=e,this.transformResults=t}},qe=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function pp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var xa=class{};function hx(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Pi(n.key,qe.none()):new xi(n.key,n.data,qe.none());{let t=n.data,r=At.empty(),i=new Se(Ge.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new Pn(n.key,r,new ln(i.toArray()),qe.none())}}function oH(n,e,t){n instanceof xi?(function(i,o,s){let a=i.value.clone(),u=AM(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Pn?(function(i,o,s){if(!pp(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=AM(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(px(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()})(n,e,t):(function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function cl(n,e,t,r){return n instanceof xi?(function(o,s,a,u){if(!pp(o.precondition,s))return a;let l=o.value.clone(),d=RM(o.fieldTransforms,u,s);return l.setAll(d),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof Pn?(function(o,s,a,u){if(!pp(o.precondition,s))return a;let l=RM(o.fieldTransforms,u,s),d=s.data;return d.setAll(px(o)),d.setAll(l),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))})(n,e,t,r):(function(o,s,a){return pp(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a})(n,e,t)}function sH(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=cx(r.transform,i||null);o!=null&&(t===null&&(t=At.empty()),t.set(r.field,o))}return t||null}function SM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ia(r,i,(o,s)=>iH(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var xi=class extends xa{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Pn=class extends xa{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function px(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function AM(n,e,t){let r=new Map;G(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,rH(s,a,t[i]))}return r}function RM(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,nH(o,s,e))}return r}var Pi=class extends xa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},wl=class extends xa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Dl=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&oH(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=cl(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=cl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=sx();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let u=hx(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ae())}isEqual(e){return this.batchId===e.batchId&&Ia(this.mutations,e.mutations,(t,r)=>SM(t,r))&&Ia(this.baseMutations,e.baseMutations,(t,r)=>SM(t,r))}},lI=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){G(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return J$})(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var Cl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var dI=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ye,ge;function gx(n){switch(n){case M.OK:return H(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return H(15467,{code:n})}}function mx(n){if(n===void 0)return ze("GRPC error has no .code"),M.UNKNOWN;switch(n){case Ye.OK:return M.OK;case Ye.CANCELLED:return M.CANCELLED;case Ye.UNKNOWN:return M.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return M.INTERNAL;case Ye.UNAVAILABLE:return M.UNAVAILABLE;case Ye.UNAUTHENTICATED:return M.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case Ye.NOT_FOUND:return M.NOT_FOUND;case Ye.ALREADY_EXISTS:return M.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return M.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case Ye.ABORTED:return M.ABORTED;case Ye.OUT_OF_RANGE:return M.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return M.UNIMPLEMENTED;case Ye.DATA_LOSS:return M.DATA_LOSS;default:return H(39323,{code:n})}}(ge=Ye||(Ye={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var MM=null;var aH=new Mr([4294967295,4294967295],0);function NM(n){let e=Bw().encode(n),t=new EE;return t.update(e),new Uint8Array(t.digest())}function xM(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Mr([t,r],0),new Mr([i,o],0)]}var fI=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Mo(`Invalid padding: ${t}`);if(r<0)throw new Mo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Mo(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Mr.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Mr.fromNumber(r)));return i.compare(aH)===1&&(i=new Mr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=NM(e),[r,i]=xM(t);for(let o=0;o<this.hashCount;o++){let s=this.pe(r,i,o);if(!this.ye(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.fe===0)return;let t=NM(e),[r,i]=xM(t);for(let o=0;o<this.hashCount;o++){let s=this.pe(r,i,o);this.we(s)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Mo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Tl=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,bl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Q.min(),i,new Oe(J),Gt(),ae())}},bl=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ae(),ae(),ae())}};var Ea=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},xp=class{constructor(e,t){this.targetId=e,this.De=t}},Pp=class{constructor(e,t,r=Ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Op=class{constructor(){this.ve=0,this.Ce=PM(),this.Fe=Ke.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ae(),t=ae(),r=ae();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H(38017,{changeType:o})}}),new bl(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=PM()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,G(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},hI=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=Gt(),this.je=ip(),this.Je=ip(),this.He=new Oe(J)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:H(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let o=i.target;if(Rp(o))if(r===0){let s=new B(o.path);this.Xe(t,s,et.newNoDocument(s,Q.min()))}else G(r===1,20013,{expectedCount:r});else{let s=this.ot(t);if(s!==r){let a=this._t(e),u=a?this.ut(a,e,s):1;if(u!==0){this.rt(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,l)}MM?.ct((function(d,h,g,y,I){var b,S,O,q,V,Y;let ee={localCacheCount:d,existenceFilterCount:h.count,databaseId:g.database,projectId:g.projectId},te=h.unchangedNames;return te&&(ee.bloomFilter={applied:I===0,hashCount:(b=te?.hashCount)!==null&&b!==void 0?b:0,bitmapLength:(q=(O=(S=te?.bits)===null||S===void 0?void 0:S.bitmap)===null||O===void 0?void 0:O.length)!==null&&q!==void 0?q:0,padding:(Y=(V=te?.bits)===null||V===void 0?void 0:V.padding)!==null&&Y!==void 0?Y:0,mightContain:w=>{var v;return(v=y?.mightContain(w))!==null&&v!==void 0&&v}}),ee})(s,e.De,this.We.lt(),a,u))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=kr(r).toUint8Array()}catch(u){if(u instanceof bp)return Kt("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new fI(s,i,o)}catch(u){return Kt(u instanceof Mo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.We.lt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,o,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((o,s)=>{let a=this.st(s);if(a){if(o.current&&Rp(a.target)){let u=new B(a.target.path);this.Tt(u).has(s)||this.It(s,u)||this.Xe(s,u,et.newNoDocument(u,e))}o.Ne&&(t.set(s,o.Le()),o.ke())}});let r=ae();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(u=>{let l=this.st(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ze.forEach((o,s)=>s.setReadTime(e));let i=new Tl(e,t,this.He,this.ze,r);return this.ze=Gt(),this.je=ip(),this.Je=ip(),this.He=new Oe(J),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Op,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Se(J),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Se(J),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Op),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function ip(){return new Oe(B.comparator)}function PM(){return new Oe(B.comparator)}var uH={asc:"ASCENDING",desc:"DESCENDING"},cH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lH={and:"AND",or:"OR"},pI=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function gI(n,e){return n.useProto3Json||Ll(e)?e:{value:e}}function Pa(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yx(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dH(n,e){return Pa(n,e.toTimestamp())}function We(n){return G(!!n,49232),Q.fromTimestamp((function(t){let r=Or(t);return new Me(r.seconds,r.nanos)})(n))}function tD(n,e){return mI(n,e).canonicalString()}function mI(n,e){let t=(function(i){return new pe(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function vx(n){let e=pe.fromString(n);return G(Ax(e),10190,{key:e.toString()}),e}function Sl(n,e){return tD(n.databaseId,e.path)}function nr(n,e){let t=vx(e);if(t.get(1)!==n.databaseId.projectId)throw new P(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(Ix(t))}function _x(n,e){return tD(n.databaseId,e)}function Ex(n){let e=vx(n);return e.length===4?pe.emptyPath():Ix(e)}function yI(n){return new pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ix(n){return G(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function OM(n,e,t){return{name:Sl(n,e),fields:t.value.mapValue.fields}}function wx(n,e,t){let r=nr(n,e.name),i=We(e.updateTime),o=e.createTime?We(e.createTime):Q.min(),s=new At({mapValue:{fields:e.fields}}),a=et.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function fH(n,e){return"found"in e?(function(r,i){G(!!i.found,43571),i.found.name,i.found.updateTime;let o=nr(r,i.found.name),s=We(i.found.updateTime),a=i.found.createTime?We(i.found.createTime):Q.min(),u=new At({mapValue:{fields:i.found.fields}});return et.newFoundDocument(o,s,a,u)})(n,e):"missing"in e?(function(r,i){G(!!i.missing,3894),G(!!i.readTime,22933);let o=nr(r,i.missing),s=We(i.readTime);return et.newNoDocument(o,s)})(n,e):H(7234,{result:e})}function hH(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(l,d){return l.useProto3Json?(G(d===void 0||typeof d=="string",58123),Ke.fromBase64String(d||"")):(G(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ke.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&(function(l){let d=l.code===void 0?M.UNKNOWN:mx(l.code);return new P(d,l.message||"")})(s);t=new Pp(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=nr(n,r.document.name),o=We(r.document.updateTime),s=r.document.createTime?We(r.document.createTime):Q.min(),a=new At({mapValue:{fields:r.document.fields}}),u=et.newFoundDocument(i,o,s,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new Ea(l,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=nr(n,r.document),o=r.readTime?We(r.readTime):Q.min(),s=et.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Ea([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=nr(n,r.document),o=r.removedTargetIds||[];t=new Ea([],o,i,null)}else{if(!("filter"in e))return H(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new dI(i,o),a=r.targetId;t=new xp(a,s)}}return t}function Al(n,e){let t;if(e instanceof xi)t={update:OM(n,e.key,e.value)};else if(e instanceof Pi)t={delete:Sl(n,e.key)};else if(e instanceof Pn)t={update:OM(n,e.key,e.data),updateMask:_H(e.fieldMask)};else{if(!(e instanceof wl))return H(16599,{Rt:e.type});t={verify:Sl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,s){let a=s.transform;if(a instanceof Mi)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Fr)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Vr)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ni)return{fieldPath:s.field.canonicalString(),increment:a.Ee};throw H(20930,{transform:s.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:dH(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:H(27497)})(n,e.precondition)),t}function vI(n,e){let t=e.currentDocument?(function(o){return o.updateTime!==void 0?qe.updateTime(We(o.updateTime)):o.exists!==void 0?qe.exists(o.exists):qe.none()})(e.currentDocument):qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>(function(s,a){let u=null;if("setToServerValue"in a)G(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),u=new Mi;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];u=new Fr(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];u=new Vr(d)}else"increment"in a?u=new Ni(s,a.increment):H(16584,{proto:a});let l=Ge.fromServerFormat(a.fieldPath);return new Fo(l,u)})(n,i)):[];if(e.update){e.update.name;let i=nr(n,e.update.name),o=new At({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=(function(u){let l=u.fieldPaths||[];return new ln(l.map(d=>Ge.fromServerFormat(d)))})(e.updateMask);return new Pn(i,o,s,t,r)}return new xi(i,o,t,r)}if(e.delete){let i=nr(n,e.delete);return new Pi(i,t)}if(e.verify){let i=nr(n,e.verify);return new wl(i,t)}return H(1463,{proto:e})}function pH(n,e){return n&&n.length>0?(G(e!==void 0,14353),n.map(t=>(function(i,o){let s=i.updateTime?We(i.updateTime):We(o);return s.isEqual(Q.min())&&(s=We(o)),new cI(s,i.transformResults||[])})(t,e))):[]}function Dx(n,e){return{documents:[_x(n,e.path)]}}function Cx(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_x(n,i);let o=(function(l){if(l.length!==0)return Sx(Ce.create(l,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(l){if(l.length!==0)return l.map(d=>(function(g){return{field:pa(g.field),direction:mH(g.dir)}})(d))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=gI(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{Vt:t,parent:i}}function Tx(n){let e=Ex(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){G(r===1,65062);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=(function(h){let g=bx(h);return g instanceof Ce&&Zw(g)?g.getFilters():[g]})(t.where));let s=[];t.orderBy&&(s=(function(h){return h.map(g=>(function(I){return new Oo(ga(I.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(I.direction))})(g))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let g;return g=typeof h=="object"?h.value:h,Ll(g)?null:g})(t.limit));let u=null;t.startAt&&(u=(function(h){let g=!!h.before,y=h.values||[];return new sr(y,g)})(t.startAt));let l=null;return t.endAt&&(l=(function(h){let g=!h.before,y=h.values||[];return new sr(y,g)})(t.endAt)),ex(e,i,s,o,a,"F",u,l)}function gH(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bx(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ga(t.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ga(t.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=ga(t.unaryFilter.field);return fe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=ga(t.unaryFilter.field);return fe.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return H(61313);default:return H(60726)}})(n):n.fieldFilter!==void 0?(function(t){return fe.create(ga(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return H(58110);default:return H(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ce.create(t.compositeFilter.filters.map(r=>bx(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H(1026)}})(t.compositeFilter.op))})(n):H(30097,{filter:n})}function mH(n){return uH[n]}function yH(n){return cH[n]}function vH(n){return lH[n]}function pa(n){return{fieldPath:n.canonicalString()}}function ga(n){return Ge.fromServerFormat(n.fieldPath)}function Sx(n){return n instanceof fe?(function(t){if(t.op==="=="){if(vM(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NAN"}};if(yM(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vM(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NOT_NAN"}};if(yM(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(t.field),op:yH(t.op),value:t.value}}})(n):n instanceof Ce?(function(t){let r=t.getFilters().map(i=>Sx(i));return r.length===1?r[0]:{compositeFilter:{op:vH(t.op),filters:r}}})(n):H(54877,{filter:n})}function _H(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ax(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Oa=class n{constructor(e,t,r,i,o=Q.min(),s=Q.min(),a=Ke.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var kp=class{constructor(e){this.gt=e}};function EH(n,e){let t;if(e.document)t=wx(n.gt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=Lo(e.noDocument.readTime);t=et.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return H(56709);{let r=B.fromSegments(e.unknownDocument.path),i=Lo(e.unknownDocument.version);t=et.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){let o=new Me(i[0],i[1]);return Q.fromTimestamp(o)})(e.readTime)),t}function kM(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(o,s){return{name:Sl(o,s.key),fields:s.data.value.mapValue.fields,updateTime:Pa(o,s.version.toTimestamp()),createTime:Pa(o,s.createTime.toTimestamp())}})(n.gt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Vo(e.version)};else{if(!e.isUnknownDocument())return H(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Vo(e.version)}}return r}function Fp(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Vo(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Lo(n){let e=new Me(n.seconds,n.nanoseconds);return Q.fromTimestamp(e)}function bo(n,e){let t=(e.baseMutations||[]).map(o=>vI(n.gt,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>vI(n.gt,o)),i=Me.fromMillis(e.localWriteTimeMs);return new Dl(e.batchId,i,t,r)}function rl(n){let e=Lo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Lo(n.lastLimboFreeSnapshotVersion):Q.min(),r;return r=(function(o){return o.documents!==void 0})(n.query)?(function(o){let s=o.documents.length;return G(s===1,1966,{count:s}),kt(za(Ex(o.documents[0])))})(n.query):(function(o){return kt(Tx(o))})(n.query),new Oa(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ke.fromBase64String(n.resumeToken))}function Rx(n,e){let t=Vo(e.snapshotVersion),r=Vo(e.lastLimboFreeSnapshotVersion),i;i=Rp(e.target)?Dx(n.gt,e.target):Cx(n.gt,e.target).Vt;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ko(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nD(n){let e=Tx({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Np(e,e.limit,"L"):e}function bE(n,e){return new Cl(e.largestBatchId,vI(n.gt,e.overlayMutation))}function FM(n,e){let t=e.path.lastSegment();return[n,Rt(e.path.popLast()),t]}function VM(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Vo(r.readTime),documentKey:Rt(r.documentKey.path),largestBatchId:r.largestBatchId}}var _I=class{getBundleMetadata(e,t){return LM(e).get(t).next(r=>{if(r)return(function(o){return{id:o.bundleId,createTime:Lo(o.createTime),version:o.version}})(r)})}saveBundleMetadata(e,t){return LM(e).put((function(i){return{bundleId:i.id,createTime:Vo(We(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return jM(e).get(t).next(r=>{if(r)return(function(o){return{name:o.name,query:nD(o.bundledQuery),readTime:Lo(o.readTime)}})(r)})}saveNamedQuery(e,t){return jM(e).put((function(i){return{name:i.name,readTime:Vo(We(i.readTime)),bundledQuery:i.bundledQuery}})(t))}};function LM(n){return it(n,_g)}function jM(n){return it(n,Eg)}var Vp=class n{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Xc(e).get(FM(this.userId,t)).next(r=>r?bE(this.serializer,r):null)}getOverlays(e,t){let r=er();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new Cl(t,s);i.push(this.wt(e,a))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(Rt(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Xc(e).Y(WE,a))}),R.waitFor(o)}getOverlaysForCollection(e,t,r){let i=er(),o=Rt(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Xc(e).j(WE,s).next(a=>{for(let u of a){let l=bE(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=er(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xc(e).X({index:ON,range:a},(u,l,d)=>{let h=bE(this.serializer,l);o.size()<i||h.largestBatchId===s?(o.set(h.getKey(),h),s=h.largestBatchId):d.done()}).next(()=>o)}wt(e,t){return Xc(e).put((function(i,o,s){let[a,u,l]=FM(o,s.mutation.key);return{userId:o,collectionPath:u,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Al(i.gt,s.mutation)}})(this.serializer,this.userId,t))}};function Xc(n){return it(n,Ig)}var EI=class{St(e){return it(e,Ww)}getSessionToken(e){return this.St(e).get("sessionToken").next(t=>{let r=t?.value;return r?Ke.fromUint8Array(r):Ke.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}};var xr=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Le(e.integerValue));else if("doubleValue"in e){let r=Le(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),pl(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=Or(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(kr(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?GN(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Cg(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):H(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let o=e.fields||{};this.Ct(t,53);let s=Aa,a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(Le(a)),this.xt(s,t),this.Dt(o[s],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),B.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};xr.Ut=new xr;var ua=255;function IH(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function BM(n){let e=64-(function(r){let i=0;for(let o=0;o<8;++o){let s=IH(255&r[o]);if(i+=s,s!==8)break}return i})(n);return Math.ceil(e/8)}var II=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Wt(r.value),r=t.next();this.Gt()}zt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.jt(r.value),r=t.next();this.Jt()}Ht(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Wt(r);else if(r<2048)this.Wt(960|r>>>6),this.Wt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Wt(480|r>>>12),this.Wt(128|63&r>>>6),this.Wt(128|63&r);else{let i=t.codePointAt(0);this.Wt(240|i>>>18),this.Wt(128|63&i>>>12),this.Wt(128|63&i>>>6),this.Wt(128|63&i)}}this.Gt()}Yt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.jt(r);else if(r<2048)this.jt(960|r>>>6),this.jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.jt(480|r>>>12),this.jt(128|63&r>>>6),this.jt(128|63&r);else{let i=t.codePointAt(0);this.jt(240|i>>>18),this.jt(128|63&i>>>12),this.jt(128|63&i>>>6),this.jt(128|63&i)}}this.Jt()}Zt(e){let t=this.Xt(e),r=BM(t);this.en(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}tn(e){let t=this.Xt(e),r=BM(t);this.en(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}nn(){this.rn(ua),this.rn(255)}sn(){this._n(ua),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){let t=(function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Wt(e){let t=255&e;t===0?(this.rn(0),this.rn(255)):t===ua?(this.rn(ua),this.rn(0)):this.rn(t)}jt(e){let t=255&e;t===0?(this._n(0),this._n(255)):t===ua?(this._n(ua),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},wI=class{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}},DI=class{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}},So=class{constructor(){this.un=new II,this.cn=new wI(this.un),this.ln=new DI(this.un)}seed(e){this.un.seed(e)}hn(e){return e===0?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}};var Ao=class n{constructor(e,t,r,i){this.Pn=e,this.Tn=t,this.In=r,this.dn=i}En(){let e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new n(this.Pn,this.Tn,this.In,r)}An(e,t,r){return{indexId:this.Pn,uid:e,arrayValue:gp(this.In),directionalValue:gp(this.dn),orderedDocumentKey:gp(t),documentKey:r.path.toArray()}}Rn(e,t,r){let i=this.An(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}};function mi(n,e){let t=n.Pn-e.Pn;return t!==0?t:(t=UM(n.In,e.In),t!==0?t:(t=UM(n.dn,e.dn),t!==0?t:B.comparator(n.Tn,e.Tn)))}function UM(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function gp(n){return pm()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function $M(n){return typeof n!="string"?n:(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}var Lp=class{constructor(e){this.Vn=new Se((t,r)=>Ge.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}}get gn(){return this.Vn.size>1}pn(e){if(G(e.collectionGroup===this.collectionId,49279),this.gn)return!1;let t=BE(e);if(t!==void 0&&!this.yn(t))return!1;let r=Do(e),i=new Set,o=0,s=0;for(;o<r.length&&this.yn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Vn.size>0){let a=this.Vn.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[o];if(!this.wn(a,u)||!this.Sn(this.mn[s++],u))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.mn.length||!this.Sn(this.mn[s++],a))return!1}return!0}bn(){if(this.gn)return null;let e=new Se(Ge.comparator),t=[];for(let r of this.fn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new va(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new va(r.field,0))}for(let r of this.mn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new va(r.field,r.dir==="asc"?0:1)));return new Da(Da.UNKNOWN_ID,this.collectionId,t,hl.empty())}yn(e){for(let t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function Mx(n){var e,t;if(G(n instanceof fe||n instanceof Ce,20012),n instanceof fe){if(n instanceof Ap){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>fe.create(n.field,"==",o)))||[];return Ce.create(i,"or")}return n}let r=n.filters.map(i=>Mx(i));return Ce.create(r,n.op)}function wH(n){if(n.getFilters().length===0)return[];let e=bI(Mx(n));return G(Nx(e),7391),CI(e)||TI(e)?[e]:e.getFilters()}function CI(n){return n instanceof fe}function TI(n){return n instanceof Ce&&Zw(n)}function Nx(n){return CI(n)||TI(n)||(function(t){if(t instanceof Ce&&XE(t)){for(let r of t.getFilters())if(!CI(r)&&!TI(r))return!1;return!0}return!1})(n)}function bI(n){if(G(n instanceof fe||n instanceof Ce,34018),n instanceof fe)return n;if(n.filters.length===1)return bI(n.filters[0]);let e=n.filters.map(r=>bI(r)),t=Ce.create(e,n.op);return t=jp(t),Nx(t)?t:(G(t instanceof Ce,64498),G(Ma(t),40251),G(t.filters.length>1,57927),t.filters.reduce((r,i)=>rD(r,i)))}function rD(n,e){let t;return G(n instanceof fe||n instanceof Ce,38388),G(e instanceof fe||e instanceof Ce,25473),t=n instanceof fe?e instanceof fe?(function(i,o){return Ce.create([i,o],"and")})(n,e):HM(n,e):e instanceof fe?HM(e,n):(function(i,o){if(G(i.filters.length>0&&o.filters.length>0,48005),Ma(i)&&Ma(o))return ZN(i,o.getFilters());let s=XE(i)?i:o,a=XE(i)?o:i,u=s.filters.map(l=>rD(l,a));return Ce.create(u,"or")})(n,e),jp(t)}function HM(n,e){if(Ma(e))return ZN(e,n.getFilters());{let t=e.filters.map(r=>rD(n,r));return Ce.create(t,"or")}}function jp(n){if(G(n instanceof fe||n instanceof Ce,11850),n instanceof fe)return n;let e=n.getFilters();if(e.length===1)return jp(e[0]);if(QN(n))return n;let t=e.map(i=>jp(i)),r=[];return t.forEach(i=>{i instanceof fe?r.push(i):i instanceof Ce&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ce.create(r,n.op)}var SI=class{constructor(){this.Dn=new Rl}addToCollectionParentIndex(e,t){return this.Dn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(yn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(yn.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},Rl=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Se(pe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(pe.comparator)).toArray()}};var qM="IndexedDbIndexManager",op=new Uint8Array(0),AI=class{constructor(e,t){this.databaseId=t,this.vn=new Rl,this.Cn=new xn(r=>ko(r),(r,i)=>Bl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});let o={collectionId:r,parent:Rt(i)};return zM(e).put(o)}return R.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[IN(t),""],!1,!0);return zM(e).j(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(Jn(s.parent))}return r})}addFieldIndex(e,t){let r=Jc(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}})(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=la(e);return o.next(a=>{s.put(VM(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Jc(e),i=la(e),o=ca(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Jc(e),r=ca(e),i=la(e);return t.Y().next(()=>r.Y()).next(()=>i.Y())}createTargetIndexes(e,t){return R.forEach(this.Fn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Lp(r).bn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=ca(e),i=!0,o=new Map;return R.forEach(this.Fn(t),s=>this.Mn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ae(),a=[];return R.forEach(o,(u,l)=>{k(qM,`Using index ${(function(V){return`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(Y=>`${Y.fieldPath}:${Y.kind}`).join(",")}`})(u)} to execute ${ko(t)}`);let d=(function(V,Y){let ee=BE(Y);if(ee===void 0)return null;for(let te of Mp(V,ee.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null})(l,u),h=(function(V,Y){let ee=new Map;for(let te of Do(Y))for(let w of Mp(V,te.fieldPath))switch(w.op){case"==":case"in":ee.set(te.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return ee.set(te.fieldPath.canonicalString(),w.value),Array.from(ee.values())}return null})(l,u),g=(function(V,Y){let ee=[],te=!0;for(let w of Do(Y)){let v=w.kind===0?DM(V,w.fieldPath,V.startAt):CM(V,w.fieldPath,V.startAt);ee.push(v.value),te&&(te=v.inclusive)}return new sr(ee,te)})(l,u),y=(function(V,Y){let ee=[],te=!0;for(let w of Do(Y)){let v=w.kind===0?CM(V,w.fieldPath,V.endAt):DM(V,w.fieldPath,V.endAt);ee.push(v.value),te&&(te=v.inclusive)}return new sr(ee,te)})(l,u),I=this.xn(u,l,g),b=this.xn(u,l,y),S=this.On(u,l,h),O=this.Nn(u.indexId,d,I,g.inclusive,b,y.inclusive,S);return R.forEach(O,q=>r.H(q,t.limit).next(V=>{V.forEach(Y=>{let ee=B.fromSegments(Y.documentKey);s.has(ee)||(s=s.add(ee),a.push(ee))})}))}).next(()=>a)}return R.resolve(null)})}Fn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=wH(Ce.create(e.filters,"and")).map(r=>aI(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}Nn(e,t,r,i,o,s,a){let u=(t!=null?t.length:1)*Math.max(r.length,o.length),l=u/(t!=null?t.length:1),d=[];for(let h=0;h<u;++h){let g=t?this.Bn(t[h/l]):op,y=this.Ln(e,g,r[h%l],i),I=this.kn(e,g,o[h%l],s),b=a.map(S=>this.Ln(e,g,S,!0));d.push(...this.createRange(y,I,b))}return d}Ln(e,t,r,i){let o=new Ao(e,B.empty(),t,r);return i?o:o.En()}kn(e,t,r,i){let o=new Ao(e,B.empty(),t,r);return i?o.En():o}Mn(e,t){let r=new Lp(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.pn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.Fn(t);return R.forEach(i,o=>this.Mn(e,o).next(s=>{s?r!==0&&s.fields.length<(function(u){let l=new Se(Ge.comparator),d=!1;for(let h of u.filters)for(let g of h.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:l=l.add(g.field));for(let h of u.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(d?1:0)})(o)&&(r=1):r=0})).next(()=>(function(s){return s.limit!==null})(t)&&i.length>1&&r===2?1:r)}qn(e,t){let r=new So;for(let i of Do(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.hn(i.kind);xr.Ut.bt(o,s)}return r.an()}Bn(e){let t=new So;return xr.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){let r=new So;return xr.Ut.bt(Po(this.databaseId,t),r.hn((function(o){let s=Do(o);return s.length===0?0:s[s.length-1].kind})(e))),r.an()}On(e,t,r){if(r===null)return[];let i=[];i.push(new So);let o=0;for(let s of Do(e)){let a=r[o++];for(let u of i)if(this.$n(t,s.fieldPath)&&Il(a))i=this.Un(i,s,a);else{let l=u.hn(s.kind);xr.Ut.bt(a,l)}}return this.Kn(i)}xn(e,t,r){return this.On(e,t,r.position)}Kn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].an();return t}Un(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let u=new So;u.seed(a.an()),xr.Ut.bt(s,u.hn(t.kind)),o.push(u)}return o}$n(e,t){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Jc(e),i=la(e);return(t?r.j(GE,IDBKeyRange.bound(t,t)):r.j()).next(o=>{let s=[];return R.forEach(o,a=>i.get([a.indexId,this.uid]).next(u=>{s.push((function(d,h){let g=h?new hl(h.sequenceNumber,new yn(Lo(h.readTime),new B(Jn(h.documentKey)),h.largestBatchId)):hl.empty(),y=d.fields.map(([I,b])=>new va(Ge.fromServerFormat(I),b));return new Da(d.indexId,d.collectionGroup,y,g)})(a,u))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:J(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Jc(e),o=la(e);return this.Wn(e).next(s=>i.j(GE,IDBKeyRange.bound(t,t)).next(a=>R.forEach(a,u=>o.put(VM(u.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return R.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?R.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),R.forEach(a,u=>this.Gn(e,i,u).next(l=>{let d=this.zn(o,u);return l.isEqual(d)?R.resolve():this.jn(e,o,u,l,d)}))))})}Jn(e,t,r,i){return ca(e).put(i.An(this.uid,this.Qn(r,t.key),t.key))}Hn(e,t,r,i){return ca(e).delete(i.Rn(this.uid,this.Qn(r,t.key),t.key))}Gn(e,t,r){let i=ca(e),o=new Se(mi);return i.X({index:PN,range:IDBKeyRange.only([r.indexId,this.uid,gp(this.Qn(r,t))])},(s,a)=>{o=o.add(new Ao(r.indexId,t,$M(a.arrayValue),$M(a.directionalValue)))}).next(()=>o)}zn(e,t){let r=new Se(mi),i=this.qn(t,e);if(i==null)return r;let o=BE(t);if(o!=null){let s=e.data.field(o.fieldPath);if(Il(s))for(let a of s.arrayValue.values||[])r=r.add(new Ao(t.indexId,e.key,this.Bn(a),i))}else r=r.add(new Ao(t.indexId,e.key,op,i));return r}jn(e,t,r,i,o){k(qM,"Updating index entries for document '%s'",t.key);let s=[];return(function(u,l,d,h,g){let y=u.getIterator(),I=l.getIterator(),b=aa(y),S=aa(I);for(;b||S;){let O=!1,q=!1;if(b&&S){let V=d(b,S);V<0?q=!0:V>0&&(O=!0)}else b!=null?q=!0:O=!0;O?(h(S),S=aa(I)):q?(g(b),b=aa(y)):(b=aa(y),S=aa(I))}})(i,o,mi,a=>{s.push(this.Jn(e,t,r,a))},a=>{s.push(this.Hn(e,t,r,a))}),R.waitFor(s)}Wn(e){let t=1;return la(e).X({index:xN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>mi(s,a)).filter((s,a,u)=>!a||mi(s,u[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=mi(s,e),u=mi(s,t);if(a===0)i[0]=e.En();else if(a>0&&u<0)i.push(s),i.push(s.En());else if(u>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Yn(i[s],i[s+1]))return[];let a=i[s].Rn(this.uid,op,B.empty()),u=i[s+1].Rn(this.uid,op,B.empty());o.push(IDBKeyRange.bound(a,u))}return o}Yn(e,t){return mi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(GM)}getMinOffset(e,t){return R.mapArray(this.Fn(t),r=>this.Mn(e,r).next(i=>i||H(44426))).next(GM)}};function zM(n){return it(n,yl)}function ca(n){return it(n,sl)}function Jc(n){return it(n,Gw)}function la(n){return it(n,ol)}function GM(n){G(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Hw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new yn(e.readTime,e.documentKey,t)}var WM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xx=41943040,zt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function Px(n,e,t){let r=n.store(Mn),i=n.store(Ca),o=[],s=IDBKeyRange.only(t.batchId),a=0,u=r.X({range:s},(d,h,g)=>(a++,g.delete()));o.push(u.next(()=>{G(a===1,47070,{batchId:t.batchId})}));let l=[];for(let d of t.mutations){let h=RN(e,d.key.path,t.batchId);o.push(i.delete(h)),l.push(d.key)}return R.waitFor(o).next(()=>l)}function Bp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw H(14731);e=n.noDocument}return JSON.stringify(e).length}zt.DEFAULT_COLLECTION_PERCENTILE=10,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zt.DEFAULT=new zt(xx,zt.DEFAULT_COLLECTION_PERCENTILE,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zt.DISABLED=new zt(-1,0,0);var Up=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static yt(e,t,r,i){G(e.uid!=="",64387);let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return yi(e).X({index:Ro,range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=ma(e),s=yi(e);return s.add({}).next(a=>{G(typeof a=="number",49019);let u=new Dl(a,t,r,i),l=(function(y,I,b){let S=b.baseMutations.map(q=>Al(y.gt,q)),O=b.mutations.map(q=>Al(y.gt,q));return{userId:I,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:S,mutations:O}})(this.serializer,this.userId,u),d=[],h=new Se((g,y)=>J(g.canonicalString(),y.canonicalString()));for(let g of i){let y=RN(this.userId,g.key.path,a);h=h.add(g.key.path.popLast()),d.push(s.put(l)),d.push(o.put(y,w$))}return h.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Zn[a]=u.keys()}),R.waitFor(d).next(()=>u)})}lookupMutationBatch(e,t){return yi(e).get(t).next(r=>r?(G(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),bo(this.serializer,r)):null)}Xn(e,t){return this.Zn[t]?R.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Zn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return yi(e).X({index:Ro,range:i},(s,a,u)=>{a.userId===this.userId&&(G(a.batchId>=r,47524,{er:r}),o=bo(this.serializer,a)),u.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=wi;return yi(e).X({index:Ro,range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,wi],[this.userId,Number.POSITIVE_INFINITY]);return yi(e).j(Ro,t).next(r=>r.map(i=>bo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=cp(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return ma(e).X({range:i},(s,a,u)=>{let[l,d,h]=s,g=Jn(d);if(l===this.userId&&t.path.isEqual(g))return yi(e).get(h).next(y=>{if(!y)throw H(61480,{tr:s,batchId:h});G(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:h}),o.push(bo(this.serializer,y))});u.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Se(J),i=[];return t.forEach(o=>{let s=cp(this.userId,o.path),a=IDBKeyRange.lowerBound(s),u=ma(e).X({range:a},(l,d,h)=>{let[g,y,I]=l,b=Jn(y);g===this.userId&&o.path.isEqual(b)?r=r.add(I):h.done()});i.push(u)}),R.waitFor(i).next(()=>this.nr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=cp(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Se(J);return ma(e).X({range:s},(u,l,d)=>{let[h,g,y]=u,I=Jn(g);h===this.userId&&r.isPrefixOf(I)?I.length===i&&(a=a.add(y)):d.done()}).next(()=>this.nr(e,a))}nr(e,t){let r=[],i=[];return t.forEach(o=>{i.push(yi(e).get(o).next(s=>{if(s===null)throw H(35274,{batchId:o});G(s.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:s.userId,batchId:o}),r.push(bo(this.serializer,s))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Px(e.ce,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.rr(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();let r=IDBKeyRange.lowerBound((function(s){return[s]})(this.userId)),i=[];return ma(e).X({range:r},(o,s,a)=>{if(o[0]===this.userId){let u=Jn(o[1]);i.push(u)}else a.done()}).next(()=>{G(i.length===0,56720,{ir:i.map(o=>o.canonicalString())})})})}containsKey(e,t){return Ox(e,this.userId,t)}sr(e){return kx(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:wi,lastStreamToken:""})}};function Ox(n,e,t){let r=cp(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ma(n).X({range:o,Z:!0},(a,u,l)=>{let[d,h,g]=a;d===e&&h===i&&(s=!0),l.done()}).next(()=>s)}function yi(n){return it(n,Mn)}function ma(n){return it(n,Ca)}function kx(n){return it(n,gl)}var ka=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var RI=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next(t=>{let r=new ka(t.highestTargetId);return t.highestTargetId=r.next(),this.lr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(t=>Q.fromTimestamp(new Me(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.cr(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.lr(e,i)))}addTargetData(e,t){return this.hr(e,t).next(()=>this.cr(e).next(r=>(r.targetCount+=1,this.Pr(t,r),this.lr(e,r))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>da(e).delete(t.targetId)).next(()=>this.cr(e)).next(r=>(G(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r)))}removeTargets(e,t,r){let i=0,o=[];return da(e).X((s,a)=>{let u=rl(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,o.push(this.removeTargetData(e,u)))}).next(()=>R.waitFor(o)).next(()=>i)}forEachTarget(e,t){return da(e).X((r,i)=>{let o=rl(i);t(o)})}cr(e){return KM(e).get(Cp).next(t=>(G(t!==null,2888),t))}lr(e,t){return KM(e).put(Cp,t)}hr(e,t){return da(e).put(Rx(this.serializer,t))}Pr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.cr(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ko(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return da(e).X({range:i,index:NN},(s,a,u)=>{let l=rl(a);Bl(t,l.target)&&(o=l,u.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=_i(e);return t.forEach(s=>{let a=Rt(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),R.waitFor(i)}removeMatchingKeys(e,t,r){let i=_i(e);return R.forEach(t,o=>{let s=Rt(o.path);return R.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=_i(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=_i(e),o=ae();return i.X({range:r,Z:!0},(s,a,u)=>{let l=Jn(s[1]),d=new B(l);o=o.add(d)}).next(()=>o)}containsKey(e,t){let r=Rt(t.path),i=IDBKeyRange.bound([r],[IN(r)],!1,!0),o=0;return _i(e).X({index:zw,Z:!0,range:i},([s,a],u,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}Et(e,t){return da(e).get(t).next(r=>r?rl(r):null)}};function da(n){return it(n,Ta)}function KM(n){return it(n,xo)}function _i(n){return it(n,ba)}var QM="LruGarbageCollector",DH=1048576;function YM([n,e],[t,r]){let i=J(n,t);return i===0?J(e,r):i}var MI=class{constructor(e){this.Tr=e,this.buffer=new Se(YM),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();YM(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},$p=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){k(QM,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vi(t)?k(QM,"Ignoring IndexedDB error during garbage collection: ",t):yield Fi(t)}yield this.Rr(3e5)}))}},NI=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(cn.ue);let r=new MI(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(WM)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WM):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,o,s,a,u,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(o=h,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),fa()<=kn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${h} documents in `+(l-u)+`ms
Total Duration: ${l-d}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:h})))}};function Fx(n,e){return new NI(n,e)}var xI=class{constructor(e,t){this.db=e,this.garbageCollector=Fx(this,t)}mr(e){let t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,(r,i)=>t(i))}addReference(e,t,r){return sp(e,r)}removeReference(e,t,r){return sp(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return sp(e,t)}Sr(e,t){return(function(i,o){let s=!1;return kx(i).ee(a=>Ox(i,a,o).next(u=>(u&&(s=!0),R.resolve(!u)))).next(()=>s)})(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.wr(e,(s,a)=>{if(a<=t){let u=this.Sr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,Q.min()),_i(e).delete((function(h){return[0,Rt(h.path)]})(s))))});i.push(u)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return sp(e,t)}wr(e,t){let r=_i(e),i,o=cn.ue;return r.X({index:zw},([s,a],{path:u,sequenceNumber:l})=>{s===0?(o!==cn.ue&&t(new B(Jn(i)),o),o=l,i=u):o=cn.ue}).next(()=>{o!==cn.ue&&t(new B(Jn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function sp(n,e){return _i(n).put((function(r,i){return{targetId:0,path:Rt(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}var Hp=class{constructor(){this.changes=new xn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var PI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return wo(e).put(r)}removeEntry(e,t,r){return wo(e).delete((function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Fp(s),a[a.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=et.newInvalidDocument(t);return wo(e).X({index:lp,range:IDBKeyRange.only(el(t))},(i,o)=>{r=this.Dr(t,o)}).next(()=>r)}vr(e,t){let r={size:0,document:et.newInvalidDocument(t)};return wo(e).X({index:lp,range:IDBKeyRange.only(el(t))},(i,o)=>{r={document:this.Dr(t,o),size:Bp(o)}}).next(()=>r)}getEntries(e,t){let r=Gt();return this.Cr(e,t,(i,o)=>{let s=this.Dr(i,o);r=r.insert(i,s)}).next(()=>r)}Fr(e,t){let r=Gt(),i=new Oe(B.comparator);return this.Cr(e,t,(o,s)=>{let a=this.Dr(o,s);r=r.insert(o,a),i=i.insert(o,Bp(s))}).next(()=>({documents:r,Mr:i}))}Cr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Se(JM);t.forEach(u=>i=i.add(u));let o=IDBKeyRange.bound(el(i.first()),el(i.last())),s=i.getIterator(),a=s.getNext();return wo(e).X({index:lp,range:o},(u,l,d)=>{let h=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&JM(a,h)<0;)r(a,null),a=s.getNext();a&&a.isEqual(h)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?d.G(el(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Fp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wo(e).j(IDBKeyRange.bound(a,u,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let d=Gt();for(let h of l){let g=this.Dr(B.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);g.isFoundDocument()&&($l(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let o=Gt(),s=XM(t,r),a=XM(t,yn.max());return wo(e).X({index:MN,range:IDBKeyRange.bound(s,a,!0)},(u,l,d)=>{let h=this.Dr(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(h.key,h),o.size===i&&d.done()}).next(()=>o)}newChangeBuffer(e){return new OI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ZM(e).get(zE).next(t=>(G(!!t,20021),t))}br(e,t){return ZM(e).put(zE,t)}Dr(e,t){if(t){let r=EH(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Q.min())))return r}return et.newInvalidDocument(e)}};function Vx(n){return new PI(n)}var OI=class extends Hp{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new xn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Se((o,s)=>J(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.Nr.get(o);if(t.push(this.Or.removeEntry(e,o,a.readTime)),s.isValidDocument()){let u=kM(this.Or.serializer,s);i=i.add(o.path.popLast());let l=Bp(u);r+=l-a.size,t.push(this.Or.addEntry(e,o,u))}else if(r-=a.size,this.trackRemovals){let u=kM(this.Or.serializer,s.convertToNoDocument(Q.min()));t.push(this.Or.addEntry(e,o,u))}}),i.forEach(o=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Or.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next(r=>(this.Nr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Or.Fr(e,t).next(({documents:r,Mr:i})=>(i.forEach((o,s)=>{this.Nr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function ZM(n){return it(n,ml)}function wo(n){return it(n,Dp)}function el(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function XM(n,e){let t=e.documentKey.path.toArray();return[n,Fp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function JM(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=J(t[o],r[o]),i)return i;return i=J(t.length,r.length),i||(i=J(t[t.length-2],r[r.length-2]),i||J(t[t.length-1],r[r.length-1]))}var kI=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var qp=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&cl(r.mutation,i,ln.empty(),Me.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ae()){let i=er();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=nl();return o.forEach((a,u)=>{s=s.insert(a,u.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=er();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ae()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Gt(),s=ul(),a=(function(){return ul()})();return t.forEach((u,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Pn)?o=o.insert(l.key,l):d!==void 0?(s.set(l.key,d.mutation.getFieldMask()),cl(d.mutation,l,d.mutation.getFieldMask(),Me.now())):s.set(l.key,ln.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((l,d)=>s.set(l,d)),t.forEach((l,d)=>{var h;return a.set(l,new kI(d,(h=s.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=ul(),i=new Oe((s,a)=>s-a),o=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let d=r.get(u)||ln.empty();d=a.applyToLocalView(l,d),r.set(u,d);let h=(i.get(a.batchId)||ae()).add(u);i=i.insert(a.batchId,h)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,d=u.value,h=sx();d.forEach(g=>{if(!o.has(g)){let y=hx(t.get(g),r.get(g));y!==null&&h.set(g,y),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,h))}return R.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):R.resolve(er()),a=wa,u=o;return s.next(l=>R.forEach(l,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(d)?R.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{u=u.insert(d,g)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,u,l,ae())).next(d=>({batchId:a,changes:ox(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=nl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=nl();return this.indexManager.getCollectionParents(e,o).next(a=>R.forEach(a,u=>{let l=(function(h,g){return new Nn(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((h,g)=>{s=s.insert(h,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((u,l)=>{let d=l.getKey();s.get(d)===null&&(s=s.insert(d,et.newInvalidDocument(d)))});let a=nl();return s.forEach((u,l)=>{let d=o.get(u);d!==void 0&&cl(d.mutation,l,ln.empty(),Me.now()),$l(t,l)&&(a=a.insert(u,l))}),a})}};var FI=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return R.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:We(i.createTime)}})(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:nD(i.bundledQuery),readTime:We(i.readTime)}})(t)),R.resolve()}};var VI=class{constructor(){this.overlays=new Oe(B.comparator),this.kr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=er();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.wt(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=er(),o=t.length+1,s=new B(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Oe((l,d)=>l-d),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=o.get(l.largestBatchId);d===null&&(d=er(),o=o.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=er(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return R.resolve(a)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Cl(t,r));let o=this.kr.get(t);o===void 0&&(o=ae(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}};var LI=class{constructor(){this.sessionToken=Ke.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var Ml=class{constructor(){this.qr=new Se(Ze.Qr),this.$r=new Se(Ze.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Ze(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Ze(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new B(new pe([])),r=new Ze(t,e),i=new Ze(t,e+1),o=[];return this.$r.forEachInRange([r,i],s=>{this.Wr(s),o.push(s.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new B(new pe([])),r=new Ze(t,e),i=new Ze(t,e+1),o=ae();return this.$r.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ze(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ze=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return B.comparator(e.key,t.key)||J(e.Hr,t.Hr)}static Ur(e,t){return J(e.Hr,t.Hr)||B.comparator(e.key,t.key)}};var jI=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Se(Ze.Qr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Dl(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.Yr=this.Yr.add(new Ze(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(s)}lookupMutationBatch(e,t){return R.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?wi:this.er-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ze(t,0),i=new Ze(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,i],s=>{let a=this.Zr(s.Hr);o.push(a)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Se(J);return t.forEach(i=>{let o=new Ze(i,0),s=new Ze(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,s],a=>{r=r.add(a.Hr)})}),R.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let s=new Ze(new B(o),0),a=new Se(J);return this.Yr.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.Hr)),!0)},s),R.resolve(this.ei(a))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){G(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return R.forEach(t.mutations,i=>{let o=new Ze(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Ze(t,0),i=this.Yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var BI=class{constructor(e){this.ni=e,this.docs=(function(){return new Oe(B.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():et.newInvalidDocument(t))}getEntries(e,t){let r=Gt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():et.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Gt(),s=t.path,a=new B(s.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:d}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||Hw(TN(d),r)<=0||(i.has(d.key)||$l(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,i){H(9500)}ri(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new UI(this)}getSize(e){return R.resolve(this.size)}},UI=class extends Hp{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var $I=class{constructor(e){this.persistence=e,this.ii=new xn(t=>ko(t),Bl),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.si=0,this.oi=new Ml,this.targetCount=0,this._i=ka.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),R.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new ka(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.hr(t),R.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ii.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),R.waitFor(o).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.oi.containsKey(t))}};var Nl=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new cn(0),this.ci=!1,this.ci=!0,this.li=new LI,this.referenceDelegate=e(this),this.hi=new $I(this),this.indexManager=new SI,this.remoteDocumentCache=(function(i){return new BI(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new kp(t),this.Ti=new FI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new jI(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new HI(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return R.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},HI=class extends Ep{constructor(e){super(),this.currentSequenceNumber=e}},zp=class n{constructor(e){this.persistence=e,this.Ai=new Ml,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw H(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.mi,r=>{let i=B.fromPath(r);return this.fi(e,i).next(o=>{o||t.removeEntry(i,Q.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return R.or([()=>R.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Gp=class n{constructor(e,t){this.persistence=e,this.gi=new xn(r=>Rt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Fx(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return R.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(o=>o?R.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,s=>this.Sr(e,s,t).next(a=>{a||(r++,o.removeEntry(s,Q.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),R.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fp(e.data.value)),t}Sr(e,t,r){return R.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return R.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var qI=class{constructor(e){this.serializer=e}q(e,t,r,i){let o=new Ip("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(jl)})(e),(function(u){u.createObjectStore(gl,{keyPath:I$}),u.createObjectStore(Mn,{keyPath:fM,autoIncrement:!0}).createIndex(Ro,hM,{unique:!0}),u.createObjectStore(Ca)})(e),eN(e),(function(u){u.createObjectStore(Co)})(e));let s=R.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(ba),u.deleteObjectStore(Ta),u.deleteObjectStore(xo)})(e),eN(e)),s=s.next(()=>(function(u){let l=u.store(xo),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Q.min().toTimestamp(),targetCount:0};return l.put(Cp,d)})(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>(function(u,l){return l.store(Mn).j().next(h=>{u.deleteObjectStore(Mn),u.createObjectStore(Mn,{keyPath:fM,autoIncrement:!0}).createIndex(Ro,hM,{unique:!0});let g=l.store(Mn),y=h.map(I=>g.put(I));return R.waitFor(y)})})(e,o))),s=s.next(()=>{(function(u){u.createObjectStore(Sa,{keyPath:M$})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.pi(o))),r<6&&i>=6&&(s=s.next(()=>((function(u){u.createObjectStore(ml)})(e),this.yi(o)))),r<7&&i>=7&&(s=s.next(()=>this.wi(o))),r<8&&i>=8&&(s=s.next(()=>this.Si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.bi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(u){u.createObjectStore(_g,{keyPath:N$})})(e),(function(u){u.createObjectStore(Eg,{keyPath:x$})})(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(u){let l=u.createObjectStore(Ig,{keyPath:j$});l.createIndex(WE,B$,{unique:!1}),l.createIndex(ON,U$,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>(function(u){let l=u.createObjectStore(Dp,{keyPath:D$});l.createIndex(lp,C$),l.createIndex(MN,T$)})(e)).next(()=>this.Di(e,o)).next(()=>e.deleteObjectStore(Co))),r<14&&i>=14&&(s=s.next(()=>this.Ci(e,o))),r<15&&i>=15&&(s=s.next(()=>(function(u){u.createObjectStore(Gw,{keyPath:P$,autoIncrement:!0}).createIndex(GE,O$,{unique:!1}),u.createObjectStore(ol,{keyPath:k$}).createIndex(xN,F$,{unique:!1}),u.createObjectStore(sl,{keyPath:V$}).createIndex(PN,L$,{unique:!1})})(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore(ol).clear()}).next(()=>{t.objectStore(sl).clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(u){u.createObjectStore(Ww,{keyPath:$$})})(e)})),r<18&&i>=18&&pm()&&(s=s.next(()=>{t.objectStore(ol).clear()}).next(()=>{t.objectStore(sl).clear()})),s}yi(e){let t=0;return e.store(Co).X((r,i)=>{t+=Bp(i)}).next(()=>{let r={byteSize:t};return e.store(ml).put(zE,r)})}pi(e){let t=e.store(gl),r=e.store(Mn);return t.j().next(i=>R.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,wi],[o.userId,o.lastAcknowledgedBatchId]);return r.j(Ro,s).next(a=>R.forEach(a,u=>{G(u.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});let l=bo(this.serializer,u);return Px(e,o.userId,l).next(()=>{})}))}))}wi(e){let t=e.store(ba),r=e.store(Co);return e.store(xo).get(Cp).next(i=>{let o=[];return r.X((s,a)=>{let u=new pe(s),l=(function(h){return[0,Rt(h)]})(u);o.push(t.get(l).next(d=>d?R.resolve():(h=>t.put({targetId:0,path:Rt(h),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>R.waitFor(o))})}Si(e,t){e.createObjectStore(yl,{keyPath:R$});let r=t.store(yl),i=new Rl,o=s=>{if(i.add(s)){let a=s.lastSegment(),u=s.popLast();return r.put({collectionId:a,parent:Rt(u)})}};return t.store(Co).X({Z:!0},(s,a)=>{let u=new pe(s);return o(u.popLast())}).next(()=>t.store(Ca).X({Z:!0},([s,a,u],l)=>{let d=Jn(a);return o(d.popLast())}))}bi(e){let t=e.store(Ta);return t.X((r,i)=>{let o=rl(i),s=Rx(this.serializer,o);return t.put(s)})}Di(e,t){let r=t.store(Co),i=[];return r.X((o,s)=>{let a=t.store(Dp),u=(function(h){return h.document?new B(pe.fromString(h.document.name).popFirst(5)):h.noDocument?B.fromSegments(h.noDocument.path):h.unknownDocument?B.fromSegments(h.unknownDocument.path):H(36783)})(s).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>R.waitFor(i))}Ci(e,t){let r=t.store(Mn),i=Vx(this.serializer),o=new Nl(zp.Vi,this.serializer.gt);return r.j().next(s=>{let a=new Map;return s.forEach(u=>{var l;let d=(l=a.get(u.userId))!==null&&l!==void 0?l:ae();bo(this.serializer,u).keys().forEach(h=>d=d.add(h)),a.set(u.userId,d)}),R.forEach(a,(u,l)=>{let d=new Xe(l),h=Vp.yt(this.serializer,d),g=o.getIndexManager(d),y=Up.yt(d,this.serializer,g,o.referenceDelegate);return new qp(i,y,h,g).recalculateAndSaveOverlaysForDocumentKeys(new vl(t,cn.ue),u).next()})})}};function eN(n){n.createObjectStore(ba,{keyPath:S$}).createIndex(zw,A$,{unique:!0}),n.createObjectStore(Ta,{keyPath:"targetId"}).createIndex(NN,b$,{unique:!0}),n.createObjectStore(xo)}var vi="IndexedDbPersistence",SE=18e5,AE=5e3,RE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Lx="main",zI=class n{constructor(e,t,r,i,o,s,a,u,l,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Fi=o,this.window=s,this.document=a,this.Mi=l,this.xi=d,this.Oi=h,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=g=>Promise.resolve(),!n.C())throw new P(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xI(this,i),this.Qi=t+Lx,this.serializer=new kp(u),this.$i=new bi(this.Qi,this.Oi,new qI(this.serializer)),this.li=new EI,this.hi=new RI(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Vx(this.serializer),this.Ti=new _I,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,d===!1&&ze(vi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(M.FAILED_PRECONDITION,RE);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new cn(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=t=>x(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.Ki())})))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ap(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(t=>{t||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Yi(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(Vi(e))return k(vi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k(vi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return tl(e).get(sa).next(t=>R.resolve(this.Xi(t)))}es(e){return ap(e).delete(this.clientId)}ts(){return x(this,null,function*(){if(this.isPrimary&&!this.ns(this.ki,SE)){this.ki=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=it(t,Sa);return r.j().next(i=>{let o=this.rs(i,SE),s=i.filter(a=>o.indexOf(a)===-1);return R.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.ss(t.clientId))}})}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?R.resolve(!0):tl(e).get(sa).next(t=>{if(t!==null&&this.ns(t.leaseTimestampMs,AE)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new P(M.FAILED_PRECONDITION,RE);return!1}}return!(!this.networkEnabled||!this.inForeground)||ap(e).j().next(r=>this.rs(r,AE).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k(vi,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return x(this,null,function*(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),yield this.$i.runTransaction("shutdown","readwrite",[jl,Sa],e=>{let t=new vl(e,cn.ue);return this.Yi(t).next(()=>this.es(t))}),this.$i.close(),this.hs()})}rs(e,t){return e.filter(r=>this.ns(r.updateTimeMs,t)&&!this._s(r.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>ap(e).j().next(t=>this.rs(t,SE).map(r=>r.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Up.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new AI(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return Vp.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,r){k(vi,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=(function(u){return u===18?z$:u===17?LN:u===16?q$:u===15?Kw:u===14?VN:u===13?FN:u===12?H$:u===11?kN:void H(60245)})(this.Oi),s;return this.$i.runTransaction(e,i,o,a=>(s=new vl(a,this.ui?this.ui.next():cn.ue),t==="readwrite-primary"?this.Ji(s).next(u=>!!u||this.Hi(s)).next(u=>{if(!u)throw ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new P(M.FAILED_PRECONDITION,bN);return r(s)}).next(u=>this.Zi(s).next(()=>u)):this.Ts(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ts(e){return tl(e).get(sa).next(t=>{if(t!==null&&this.ns(t.leaseTimestampMs,AE)&&!this._s(t.ownerId)&&!this.Xi(t)&&!(this.xi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(M.FAILED_PRECONDITION,RE)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return tl(e).put(sa,t)}static C(){return bi.C()}Yi(e){let t=tl(e);return t.get(sa).next(r=>this.Xi(r)?(k(vi,"Releasing primary lease."),t.delete(sa)):R.resolve())}ns(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground=this.document.visibilityState==="visible")}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ni=()=>{this.us();let t=/(?:Version|Mobile)\/1[456]/;hm()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{let r=((t=this.Ui)===null||t===void 0?void 0:t.getItem(this.ss(e)))!==null;return k(vi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ze(vi,"Failed to get zombied client id.",r),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){ze("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch{}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function tl(n){return it(n,jl)}function ap(n){return it(n,Sa)}function iD(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var GI=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=ae(),i=ae();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var WI=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Wp=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return hm()?8:SN(_u())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ps(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ys(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new WI;return this.ws(e,t,s).next(a=>{if(o.result=a,this.Rs)return this.Ss(e,t,s,a.size)})}).next(()=>o.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(fa()<=kn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",ha(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),R.resolve()):(fa()<=kn.DEBUG&&k("QueryEngine","Query:",ha(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(fa()<=kn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",ha(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kt(t))):R.resolve())}ps(e,t){if(TM(t))return R.resolve(null);let r=kt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Np(t,null,"F"),r=kt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ae(...o);return this.gs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.bs(t,a);return this.Ds(t,l,s,u.readTime)?this.ps(e,Np(t,null,"F")):this.vs(e,l,t,u)}))})))}ys(e,t,r,i){return TM(t)||i.isEqual(Q.min())?R.resolve(null):this.gs.getDocuments(e,r).next(o=>{let s=this.bs(t,o);return this.Ds(t,s,r,i)?R.resolve(null):(fa()<=kn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ha(t)),this.vs(e,s,t,CN(i,wa)).next(a=>a))})}bs(e,t){let r=new Se(rx(e));return t.forEach((i,o)=>{$l(e,o)&&(r=r.add(o))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,t,r){return fa()<=kn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",ha(t)),this.gs.getDocumentsMatchingQuery(e,t,yn.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var oD="LocalStore",CH=3e8,KI=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new Oe(J),this.Ms=new xn(o=>ko(o),Bl),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qp(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function jx(n,e,t,r){return new KI(n,e,t,r)}function Bx(n,e){return x(this,null,function*(){let t=U(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],u=ae();for(let l of i){s.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}for(let l of o){a.push(l.batchId);for(let d of l.mutations)u=u.add(d.key)}return t.localDocuments.getDocuments(r,u).next(l=>({Bs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function TH(n,e){let t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return(function(a,u,l,d){let h=l.batch,g=h.keys(),y=R.resolve();return g.forEach(I=>{y=y.next(()=>d.getEntry(u,I)).next(b=>{let S=l.docVersions.get(I);G(S!==null,48541),b.version.compareTo(S)<0&&(h.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),d.addEntry(b)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,h))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let u=ae();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Ux(n){let e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function bH(n,e){let t=U(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let a=[];e.targetChanges.forEach((d,h)=>{let g=i.get(h);if(!g)return;a.push(t.hi.removeMatchingKeys(o,d.removedDocuments,h).next(()=>t.hi.addMatchingKeys(o,d.addedDocuments,h)));let y=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?y=y.withResumeToken(Ke.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(h,y),(function(b,S,O){return b.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=CH?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(g,y,d)&&a.push(t.hi.updateTargetData(o,y))});let u=Gt(),l=ae();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push($x(o,s,e.documentUpdates).next(d=>{u=d.Ls,l=d.ks})),!r.isEqual(Q.min())){let d=t.hi.getLastRemoteSnapshotVersion(o).next(h=>t.hi.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return R.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,u,l)).next(()=>u)}).then(o=>(t.Fs=i,o))}function $x(n,e,t){let r=ae(),i=ae();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Gt();return t.forEach((a,u)=>{let l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Q.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):k(oD,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{Ls:s,ks:i}})}function SH(n,e){let t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=wi),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Fa(n,e){let t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(o=>o?(i=o,R.resolve(i)):t.hi.allocateTargetId(r).next(s=>(i=new Oa(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}function Va(n,e,t){return x(this,null,function*(){let r=U(n),i=r.Fs.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Vi(s))throw s;k(oD,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function Kp(n,e,t){let r=U(n),i=Q.min(),o=ae();return r.persistence.runTransaction("Execute query","readwrite",s=>(function(u,l,d){let h=U(u),g=h.Ms.get(d);return g!==void 0?R.resolve(h.Fs.get(g)):h.hi.getTargetData(l,d)})(r,s,kt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(s,a.targetId).next(u=>{o=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(s,e,t?i:Q.min(),t?o:ae())).next(a=>(zx(r,nx(e),a),{documents:a,qs:o})))}function Hx(n,e){let t=U(n),r=U(t.hi),i=t.Fs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.Et(o,e).next(s=>s?s.target:null))}function qx(n,e){let t=U(n),r=t.xs.get(e)||Q.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Os.getAllFromCollectionGroup(i,e,CN(r,wa),Number.MAX_SAFE_INTEGER)).then(i=>(zx(t,e,i),i))}function zx(n,e,t){let r=n.xs.get(e)||Q.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.xs.set(e,r)}function AH(n,e,t,r){return x(this,null,function*(){let i=U(n),o=ae(),s=Gt();for(let l of t){let d=e.Qs(l.metadata.name);l.document&&(o=o.add(d));let h=e.$s(l);h.setReadTime(e.Us(l.metadata.readTime)),s=s.insert(d,h)}let a=i.Os.newChangeBuffer({trackRemovals:!0}),u=yield Fa(i,(function(d){return kt(za(pe.fromString(`__bundle__/docs/${d}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>$x(l,a,s).next(d=>(a.apply(l),d)).next(d=>i.hi.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.hi.addMatchingKeys(l,o,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ls,d.ks)).next(()=>d.Ls)))})}function RH(r,i){return x(this,arguments,function*(n,e,t=ae()){let o=yield Fa(n,kt(nD(e.bundledQuery))),s=U(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let u=We(e.readTime);if(o.snapshotVersion.compareTo(u)>=0)return s.Ti.saveNamedQuery(a,e);let l=o.withResumeToken(Ke.EMPTY_BYTE_STRING,u);return s.Fs=s.Fs.insert(l.targetId,l),s.hi.updateTargetData(a,l).next(()=>s.hi.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.hi.addMatchingKeys(a,t,o.targetId)).next(()=>s.Ti.saveNamedQuery(a,e))})})}var Gx="firestore_clients";function tN(n,e){return`${Gx}_${n}_${e}`}var Wx="firestore_mutations";function nN(n,e,t){let r=`${Wx}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var Kx="firestore_targets";function ME(n,e){return`${Kx}_${n}_${e}`}var Xn="SharedClientState",Qp=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ks(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(ze(Xn,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ll=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ks(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(ze(Xn,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Yp=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ks(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=Jw();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=AN(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(ze(Xn,`Failed to parse client data for instance '${e}': ${t}`),null)}},QI=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Ks(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ze(Xn,`Failed to parse online state: ${e}`),null)}},xl=class{constructor(){this.activeTargetIds=Jw()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},dl=class{constructor(e,t,r,i,o){this.window=e,this.Fi=t,this.persistenceKey=r,this.js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Js=this.Hs.bind(this),this.Ys=new Oe(J),this.started=!1,this.Zs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=tN(this.persistenceKey,this.js),this.eo=(function(u){return`firestore_sequence_number_${u}`})(this.persistenceKey),this.Ys=this.Ys.insert(this.js,new xl),this.no=new RegExp(`^${Gx}_${s}_([^_]*)$`),this.ro=new RegExp(`^${Wx}_${s}_(\\d+)(?:_(.*))?$`),this.io=new RegExp(`^${Kx}_${s}_(\\d+)$`),this.so=(function(u){return`firestore_online_state_${u}`})(this.persistenceKey),this.oo=(function(u){return`firestore_bundle_loaded_v2_${u}`})(this.persistenceKey),this.window.addEventListener("storage",this.Js)}static C(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.Ps();for(let r of e){if(r===this.js)continue;let i=this.getItem(tN(this.persistenceKey,r));if(i){let o=Yp.Ks(r,i);o&&(this.Ys=this.Ys.insert(o.clientId,o))}}this._o();let t=this.storage.getItem(this.so);if(t){let r=this.ao(t);r&&this.uo(r)}for(let r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.eo,JSON.stringify(e))}getAllActiveQueryTargets(){return this.co(this.Ys)}isActiveQueryTarget(e){let t=!1;return this.Ys.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.lo(e,"pending")}updateMutationState(e,t,r){this.lo(e,t,r),this.ho(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(ME(this.persistenceKey,e));if(i){let o=ll.Ks(e,i);o&&(r=o.state)}}return t&&this.Po.Gs(e),this._o(),r}removeLocalQueryTarget(e){this.Po.zs(e),this._o()}isLocalQueryTarget(e){return this.Po.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ME(this.persistenceKey,e))}updateQueryState(e,t,r){this.To(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.ho(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Io(e)}notifyBundleLoaded(e){this.Eo(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k(Xn,"READ",e,t),t}setItem(e,t){k(Xn,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){k(Xn,"REMOVE",e),this.storage.removeItem(e)}Hs(e){let t=e;if(t.storageArea===this.storage){if(k(Xn,"EVENT",t.key,t.newValue),t.key===this.Xs)return void ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fi.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(t.key!==null){if(this.no.test(t.key)){if(t.newValue==null){let r=this.Ao(t.key);return this.Ro(r,null)}{let r=this.Vo(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){let r=this.mo(t.key,t.newValue);if(r)return this.fo(r)}}else if(this.io.test(t.key)){if(t.newValue!==null){let r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(t.key===this.so){if(t.newValue!==null){let r=this.ao(t.newValue);if(r)return this.uo(r)}}else if(t.key===this.eo){let r=(function(o){let s=cn.ue;if(o!=null)try{let a=JSON.parse(o);G(typeof a=="number",30636,{wo:o}),s=a}catch(a){ze(Xn,"Failed to read sequence number from WebStorage",a)}return s})(t.newValue);r!==cn.ue&&this.sequenceNumberHandler(r)}else if(t.key===this.oo){let r=this.So(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.bo(i)))}}}else this.Zs.push(t)}))}}get Po(){return this.Ys.get(this.js)}_o(){this.setItem(this.Xs,this.Po.Ws())}lo(e,t,r){let i=new Qp(this.currentUser,e,t,r),o=nN(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Ws())}ho(e){let t=nN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Io(e){let t={clientId:this.js,onlineState:e};this.storage.setItem(this.so,JSON.stringify(t))}To(e,t,r){let i=ME(this.persistenceKey,e),o=new ll(e,t,r);this.setItem(i,o.Ws())}Eo(e){let t=JSON.stringify(Array.from(e));this.setItem(this.oo,t)}Ao(e){let t=this.no.exec(e);return t?t[1]:null}Vo(e,t){let r=this.Ao(e);return Yp.Ks(r,t)}mo(e,t){let r=this.ro.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Qp.Ks(new Xe(o),i,t)}po(e,t){let r=this.io.exec(e),i=Number(r[1]);return ll.Ks(i,t)}ao(e){return QI.Ks(e)}So(e){return JSON.parse(e)}fo(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Do(e.batchId,e.state,e.error);k(Xn,`Ignoring mutation for non-active user ${e.user.uid}`)})}yo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Ys.insert(e,t):this.Ys.remove(e),i=this.co(this.Ys),o=this.co(r),s=[],a=[];return o.forEach(u=>{i.has(u)||s.push(u)}),i.forEach(u=>{o.has(u)||a.push(u)}),this.syncEngine.Co(s,a).then(()=>{this.Ys=r})}uo(e){this.Ys.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}co(e){let t=Jw();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Zp=class{constructor(){this.Fo=new xl,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new xl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var YI=class{xo(e){}shutdown(){}};var rN="ConnectivityMonitor",Xp=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){k(rN,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){k(rN,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var up=null;function ZI(){return up===null?up=(function(){return 268435456+Math.round(2147483648*Math.random())})():up++,"0x"+up.toString(16)}var NE="RestConnection",MH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},XI=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===QE?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let s=ZI(),a=this.Go(e,t.toUriEncodedString());k(NE,`Sending RPC '${e}' ${s}:`,a,r);let u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,o);let{host:l}=new URL(a),d=fm(l);return this.jo(e,a,u,r,d).then(h=>(k(NE,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Kt(NE,`RPC '${e}' ${s} failed with error: `,h,"url: ",a,"request:",r),h})}Jo(e,t,r,i,o,s){return this.Wo(e,t,r,i,o)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+qa})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Go(e,t){let r=MH[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var JI=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var St="WebChannelConnection",ew=class extends XI{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,o){let s=ZI();return new Promise((a,u)=>{let l=new IE;l.setWithCredentials(!0),l.listenOnce(wE.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Zc.NO_ERROR:let h=l.getResponseJson();k(St,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case Zc.TIMEOUT:k(St,`RPC '${e}' ${s} timed out`),u(new P(M.DEADLINE_EXCEEDED,"Request time out"));break;case Zc.HTTP_ERROR:let g=l.getStatus();if(k(St,`RPC '${e}' ${s} failed with status:`,g,"response text:",l.getResponseText()),g>0){let y=l.getResponseJson();Array.isArray(y)&&(y=y[0]);let I=y?.error;if(I&&I.status&&I.message){let b=(function(O){let q=O.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(q)>=0?q:M.UNKNOWN})(I.status);u(new P(b,I.message))}else u(new P(M.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new P(M.UNAVAILABLE,"Connection failed."));break;default:H(9055,{c_:e,streamId:s,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{k(St,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);k(St,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",d,r,15)})}P_(e,t,r){let i=ZI(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=TE(),a=CE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let d=o.join("");k(St,`Creating RPC '${e}' stream ${i}: ${d}`,u);let h=s.createWebChannel(d,u);this.T_(h);let g=!1,y=!1,I=new JI({Ho:S=>{y?k(St,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(k(St,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),k(St,`RPC '${e}' stream ${i} sending:`,S),h.send(S))},Yo:()=>h.close()}),b=(S,O,q)=>{S.listen(O,V=>{try{q(V)}catch(Y){setTimeout(()=>{throw Y},0)}})};return b(h,oa.EventType.OPEN,()=>{y||(k(St,`RPC '${e}' stream ${i} transport opened.`),I.s_())}),b(h,oa.EventType.CLOSE,()=>{y||(y=!0,k(St,`RPC '${e}' stream ${i} transport closed`),I.__(),this.I_(h))}),b(h,oa.EventType.ERROR,S=>{y||(y=!0,Kt(St,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),I.__(new P(M.UNAVAILABLE,"The operation could not be completed")))}),b(h,oa.EventType.MESSAGE,S=>{var O;if(!y){let q=S.data[0];G(!!q,16349);let V=q,Y=V?.error||((O=V[0])===null||O===void 0?void 0:O.error);if(Y){k(St,`RPC '${e}' stream ${i} received error:`,Y);let ee=Y.status,te=(function(E){let D=Ye[E];if(D!==void 0)return mx(D)})(ee),w=Y.message;te===void 0&&(te=M.INTERNAL,w="Unknown error status: "+ee+" with message "+Y.message),y=!0,I.__(new P(te,w)),h.close()}else k(St,`RPC '${e}' stream ${i} received:`,q),I.a_(q)}}),b(a,DE.STAT_EVENT,S=>{S.stat===rp.PROXY?k(St,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===rp.NOPROXY&&k(St,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.o_()},0),I}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function Qx(){return typeof window<"u"?window:null}function mp(){return typeof document<"u"?document:null}function Hl(n){return new pI(n,!0)}var Pl=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var iN="PersistentStream",Jp=class{constructor(e,t,r,i,o,s,a,u){this.Fi=e,this.w_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Pl(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return x(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return x(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return x(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(ze(t.toString()),ze("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new P(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>x(this,null,function*(){this.state=0,this.start()}))}G_(e){return k(iN,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(k(iN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},tw=class extends Jp{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=hH(this.serializer,e),r=(function(o){if(!("targetChange"in o))return Q.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Q.min():s.readTime?We(s.readTime):Q.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=yI(this.serializer),t.addTarget=(function(o,s){let a,u=s.target;if(a=Rp(u)?{documents:Dx(o,u)}:{query:Cx(o,u).Vt},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=yx(o,s.resumeToken);let l=gI(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(Q.min())>0){a.readTime=Pa(o,s.snapshotVersion.toTimestamp());let l=gI(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);let r=gH(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=yI(this.serializer),t.removeTarget=e,this.k_(t)}},nw=class extends Jp{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return G(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,G(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){G(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=pH(e.writeResults,e.commitTime),r=We(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=yI(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Al(this.serializer,r))};this.k_(t)}};var rw=class{},iw=class extends rw{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new P(M.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,mI(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(M.UNKNOWN,o.toString())})}Jo(e,t,r,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Jo(e,mI(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(M.UNKNOWN,s.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},ow=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ze(t),this._a=!1):k("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var jo="RemoteStore",sw=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(s=>{r.enqueueAndForget(()=>x(this,null,function*(){ji(this)&&(k(jo,"Restarting streams for network reachability change."),yield(function(u){return x(this,null,function*(){let l=U(u);l.Ia.add(4),yield Ga(l),l.Aa.set("Unknown"),l.Ia.delete(4),yield ql(l)})})(this))}))}),this.Aa=new ow(r,i)}};function ql(n){return x(this,null,function*(){if(ji(n))for(let e of n.da)yield e(!0)})}function Ga(n){return x(this,null,function*(){for(let e of n.da)yield e(!1)})}function Tg(n,e){let t=U(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),uD(t)?aD(t):Ka(t).x_()&&sD(t,e))}function La(n,e){let t=U(n),r=Ka(t);t.Ta.delete(e),r.x_()&&Yx(t,e),t.Ta.size===0&&(r.x_()?r.B_():ji(t)&&t.Aa.set("Unknown"))}function sD(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ka(n).H_(e)}function Yx(n,e){n.Ra.$e(e),Ka(n).Y_(e)}function aD(n){n.Ra=new hI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Ka(n).start(),n.Aa.aa()}function uD(n){return ji(n)&&!Ka(n).M_()&&n.Ta.size>0}function ji(n){return U(n).Ia.size===0}function Zx(n){n.Ra=void 0}function NH(n){return x(this,null,function*(){n.Aa.set("Online")})}function xH(n){return x(this,null,function*(){n.Ta.forEach((e,t)=>{sD(n,e)})})}function PH(n,e){return x(this,null,function*(){Zx(n),uD(n)?(n.Aa.la(e),aD(n)):n.Aa.set("Unknown")})}function OH(n,e,t){return x(this,null,function*(){if(n.Aa.set("Online"),e instanceof Pp&&e.state===2&&e.cause)try{yield(function(i,o){return x(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.Ta.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.Ta.delete(a),i.Ra.removeTarget(a))})})(n,e)}catch(r){k(jo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield eg(n,r)}else if(e instanceof Ea?n.Ra.Ye(e):e instanceof xp?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Q.min()))try{let r=yield Ux(n.localStore);t.compareTo(r)>=0&&(yield(function(o,s){let a=o.Ra.Pt(s);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let d=o.Ta.get(l);d&&o.Ta.set(l,d.withResumeToken(u.resumeToken,s))}}),a.targetMismatches.forEach((u,l)=>{let d=o.Ta.get(u);if(!d)return;o.Ta.set(u,d.withResumeToken(Ke.EMPTY_BYTE_STRING,d.snapshotVersion)),Yx(o,u);let h=new Oa(d.target,u,l,d.sequenceNumber);sD(o,h)}),o.remoteSyncer.applyRemoteEvent(a)})(n,t))}catch(r){k(jo,"Failed to raise snapshot:",r),yield eg(n,r)}})}function eg(n,e,t){return x(this,null,function*(){if(!Vi(e))throw e;n.Ia.add(1),yield Ga(n),n.Aa.set("Offline"),t||(t=()=>Ux(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(null,null,function*(){k(jo,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield ql(n)}))})}function Xx(n,e){return e().catch(t=>eg(n,t,e))}function Wa(n){return x(this,null,function*(){let e=U(n),t=Oi(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:wi;for(;kH(e);)try{let i=yield SH(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,FH(e,i)}catch(i){yield eg(e,i)}Jx(e)&&eP(e)})}function kH(n){return ji(n)&&n.Pa.length<10}function FH(n,e){n.Pa.push(e);let t=Oi(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Jx(n){return ji(n)&&!Oi(n).M_()&&n.Pa.length>0}function eP(n){Oi(n).start()}function VH(n){return x(this,null,function*(){Oi(n).na()})}function LH(n){return x(this,null,function*(){let e=Oi(n);for(let t of n.Pa)e.X_(t.mutations)})}function jH(n,e,t){return x(this,null,function*(){let r=n.Pa.shift(),i=lI.from(r,e,t);yield Xx(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Wa(n)})}function BH(n,e){return x(this,null,function*(){e&&Oi(n).Z_&&(yield(function(r,i){return x(this,null,function*(){if((function(s){return gx(s)&&s!==M.ABORTED})(i.code)){let o=r.Pa.shift();Oi(r).N_(),yield Xx(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Wa(r)}})})(n,e)),Jx(n)&&eP(n)})}function oN(n,e){return x(this,null,function*(){let t=U(n);t.asyncQueue.verifyOperationInProgress(),k(jo,"RemoteStore received new credentials");let r=ji(t);t.Ia.add(3),yield Ga(t),r&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield ql(t)})}function aw(n,e){return x(this,null,function*(){let t=U(n);e?(t.Ia.delete(2),yield ql(t)):e||(t.Ia.add(2),yield Ga(t),t.Aa.set("Unknown"))})}function Ka(n){return n.Va||(n.Va=(function(t,r,i){let o=U(t);return o.ia(),new tw(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:NH.bind(null,n),e_:xH.bind(null,n),n_:PH.bind(null,n),J_:OH.bind(null,n)}),n.da.push(e=>x(null,null,function*(){e?(n.Va.N_(),uD(n)?aD(n):n.Aa.set("Unknown")):(yield n.Va.stop(),Zx(n))}))),n.Va}function Oi(n){return n.ma||(n.ma=(function(t,r,i){let o=U(t);return o.ia(),new nw(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:VH.bind(null,n),n_:BH.bind(null,n),ea:LH.bind(null,n),ta:jH.bind(null,n)}),n.da.push(e=>x(null,null,function*(){e?(n.ma.N_(),yield Wa(n)):(yield n.ma.stop(),n.Pa.length>0&&(k(jo,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var uw=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Qa(n,e){if(ze("AsyncQueue",`${e}: ${n}`),Vi(n))return new P(M.UNAVAILABLE,`${e}: ${n}`);throw n}var tg=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=nl(),this.sortedSet=new Oe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var ng=class{constructor(){this.fa=new Oe(B.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):H(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},ja=class n{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,tg.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ul(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var cw=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},lw=class{constructor(){this.queries=sN(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=U(t),o=i.queries;i.queries=sN(),o.forEach((s,a)=>{for(let u of a.wa)u.onError(r)})})(this,new P(M.ABORTED,"Firestore shutting down"))}};function sN(){return new xn(n=>tx(n),Ul)}function cD(n,e){return x(this,null,function*(){let t=U(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Sa()&&e.ba()&&(r=2):(o=new cw,r=e.ba()?0:1);try{switch(r){case 0:o.ya=yield t.onListen(i,!0);break;case 1:o.ya=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=Qa(s,`Initialization of query '${ha(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.wa.push(e),e.va(t.onlineState),o.ya&&e.Ca(o.ya)&&dD(t)})}function lD(n,e){return x(this,null,function*(){let t=U(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.wa.indexOf(e);s>=0&&(o.wa.splice(s,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function UH(n,e){let t=U(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.wa)a.Ca(i)&&(r=!0);s.ya=i}}r&&dD(t)}function $H(n,e,t){let r=U(n),i=r.queries.get(e);if(i)for(let o of i.wa)o.onError(t);r.queries.delete(e)}function dD(n){n.Da.forEach(e=>{e.next()})}var dw,aN;(aN=dw||(dw={})).Fa="default",aN.Cache="cache";var Ol=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ja(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=ja.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==dw.Cache}};var fw=class{constructor(e,t){this.qa=e,this.byteLength=t}Qa(){return"metadata"in this.qa}};var rg=class{constructor(e){this.serializer=e}Qs(e){return nr(this.serializer,e)}$s(e){return e.metadata.exists?wx(this.serializer,e.document,!1):et.newNoDocument(this.Qs(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return We(e)}},hw=class{constructor(e,t){this.$a=e,this.serializer=t,this.Ua=[],this.Ka=[],this.collectionGroups=new Set,this.progress=tP(e)}get queries(){return this.Ua}get documents(){return this.Ka}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Ua.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Ka.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=pe.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Ka[this.Ka.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){let t=new Map,r=new rg(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Qs(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ae()).add(o);t.set(s,a)}}return t}za(e){return x(this,null,function*(){let t=yield AH(e,new rg(this.serializer),this.Ka,this.$a.id),r=this.Ga(this.documents);for(let i of this.Ua)yield RH(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,ja:this.collectionGroups,Ja:t}})}};function tP(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var ig=class{constructor(e){this.key=e}},og=class{constructor(e){this.key=e}},sg=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ae(),this.mutatedKeys=ae(),this.Xa=rx(e),this.eu=new tg(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new ng,i=t?t.eu:this.eu,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let g=i.get(d),y=$l(this.query,h)?h:null,I=!!g&&this.mutatedKeys.has(g.key),b=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),S=!1;g&&y?g.data.isEqual(y.data)?I!==b&&(r.track({type:3,doc:y}),S=!0):this.iu(g,y)||(r.track({type:2,doc:y}),S=!0,(u&&this.Xa(y,u)>0||l&&this.Xa(y,l)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),S=!0):g&&!y&&(r.track({type:1,doc:g}),S=!0,(u||l)&&(a=!0)),S&&(y?(s=s.add(y),o=b?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{eu:s,ru:r,Ds:a,mutatedKeys:o}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let s=e.ru.pa();s.sort((d,h)=>(function(y,I){let b=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H(20277,{At:S})}};return b(y)-b(I)})(d.type,h.type)||this.Xa(d.doc,h.doc)),this.su(r),i=i!=null&&i;let a=t&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,l=u!==this.Ya;return this.Ya=u,s.length!==0||l?{snapshot:new ja(this.query,e.eu,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new ng,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=ae(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new og(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new ig(r))}),t}uu(e){this.Ha=e.qs,this.Za=ae();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return ja.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Bi="SyncEngine",pw=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},gw=class{constructor(e){this.key=e,this.lu=!1}},mw=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new xn(a=>tx(a),Ul),this.Tu=new Map,this.Iu=new Set,this.du=new Oe(B.comparator),this.Eu=new Map,this.Au=new Ml,this.Ru={},this.Vu=new Map,this.mu=ka.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function HH(n,e,t=!0){return x(this,null,function*(){let r=bg(n),i,o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=yield nP(r,e,t,!0),i})}function qH(n,e){return x(this,null,function*(){let t=bg(n);yield nP(t,e,!0,!1)})}function nP(n,e,t,r){return x(this,null,function*(){let i=yield Fa(n.localStore,kt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield fD(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&Tg(n.remoteStore,i),a})}function fD(n,e,t,r,i){return x(this,null,function*(){n.gu=(h,g,y)=>(function(b,S,O,q){return x(this,null,function*(){let V=S.view.nu(O);V.Ds&&(V=yield Kp(b.localStore,S.query,!1).then(({documents:w})=>S.view.nu(w,V)));let Y=q&&q.targetChanges.get(S.targetId),ee=q&&q.targetMismatches.get(S.targetId)!=null,te=S.view.applyChanges(V,b.isPrimaryClient,Y,ee);return yw(b,S.targetId,te._u),te.snapshot})})(n,h,g,y);let o=yield Kp(n.localStore,e,!0),s=new sg(e,o.qs),a=s.nu(o.documents),u=bl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);yw(n,t,l._u);let d=new pw(e,t,s);return n.Pu.set(e,d),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),l.snapshot})}function zH(n,e,t){return x(this,null,function*(){let r=U(n),i=r.Pu.get(e),o=r.Tu.get(i.targetId);if(o.length>1)return r.Tu.set(i.targetId,o.filter(s=>!Ul(s,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Va(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&La(r.remoteStore,i.targetId),Ba(r,i.targetId)}).catch(Fi))):(Ba(r,i.targetId),yield Va(r.localStore,i.targetId,!0))})}function GH(n,e){return x(this,null,function*(){let t=U(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),La(t.remoteStore,r.targetId))})}function WH(n,e,t){return x(this,null,function*(){let r=mD(n);try{let i=yield(function(s,a){let u=U(s),l=Me.now(),d=a.reduce((y,I)=>y.add(I.key),ae()),h,g;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let I=Gt(),b=ae();return u.Os.getEntries(y,d).next(S=>{I=S,I.forEach((O,q)=>{q.isValidDocument()||(b=b.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,I)).next(S=>{h=S;let O=[];for(let q of a){let V=sH(q,h.get(q.key).overlayedDocument);V!=null&&O.push(new Pn(q.key,V,KN(V.value.mapValue),qe.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,O,a)}).next(S=>{g=S;let O=S.applyToLocalDocumentSet(h,b);return u.documentOverlayCache.saveOverlays(y,S.batchId,O)})}).then(()=>({batchId:g.batchId,changes:ox(h)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(s,a,u){let l=s.Ru[s.currentUser.toKey()];l||(l=new Oe(J)),l=l.insert(a,u),s.Ru[s.currentUser.toKey()]=l})(r,i.batchId,t),yield Br(r,i.changes),yield Wa(r.remoteStore)}catch(i){let o=Qa(i,"Failed to persist write");t.reject(o)}})}function rP(n,e){return x(this,null,function*(){let t=U(n);try{let r=yield bH(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Eu.get(o);s&&(G(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.lu=!0:i.modifiedDocuments.size>0?G(s.lu,14607):i.removedDocuments.size>0&&(G(s.lu,42227),s.lu=!1))}),yield Br(t,r,e)}catch(r){yield Fi(r)}})}function uN(n,e,t){let r=U(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(s,a){let u=U(s);u.onlineState=a;let l=!1;u.queries.forEach((d,h)=>{for(let g of h.wa)g.va(a)&&(l=!0)}),l&&dD(u)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function KH(n,e,t){return x(this,null,function*(){let r=U(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),o=i&&i.key;if(o){let s=new Oe(B.comparator);s=s.insert(o,et.newNoDocument(o,Q.min()));let a=ae().add(o),u=new Tl(Q.min(),new Map,new Oe(J),s,a);yield rP(r,u),r.du=r.du.remove(o),r.Eu.delete(e),gD(r)}else yield Va(r.localStore,e,!1).then(()=>Ba(r,e,t)).catch(Fi)})}function QH(n,e){return x(this,null,function*(){let t=U(n),r=e.batch.batchId;try{let i=yield TH(t.localStore,e);pD(t,r,null),hD(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Br(t,i)}catch(i){yield Fi(i)}})}function YH(n,e,t){return x(this,null,function*(){let r=U(n);try{let i=yield(function(s,a){let u=U(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(h=>(G(h!==null,37113),d=h.keys(),u.mutationQueue.removeMutationBatch(l,h))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})})(r.localStore,e);pD(r,e,t),hD(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Br(r,i)}catch(i){yield Fi(i)}})}function ZH(n,e){return x(this,null,function*(){let t=U(n);ji(t.remoteStore)||k(Bi,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield(function(s){let a=U(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))})(t.localStore);if(r===wi)return void e.resolve();let i=t.Vu.get(r)||[];i.push(e),t.Vu.set(r,i)}catch(r){let i=Qa(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function hD(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function pD(n,e,t){let r=U(n),i=r.Ru[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function Ba(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||iP(n,r)})}function iP(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(La(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),gD(n))}function yw(n,e,t){for(let r of t)r instanceof ig?(n.Au.addReference(r.key,e),XH(n,r)):r instanceof og?(k(Bi,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||iP(n,r.key)):H(19791,{yu:r})}function XH(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(k(Bi,"New document in limbo: "+t),n.Iu.add(r),gD(n))}function gD(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new B(pe.fromString(e)),r=n.mu.next();n.Eu.set(r,new gw(t)),n.du=n.du.insert(t,r),Tg(n.remoteStore,new Oa(kt(za(t.path)),r,"TargetPurposeLimboResolution",cn.ue))}}function Br(n,e,t){return x(this,null,function*(){let r=U(n),i=[],o=[],s=[];r.Pu.isEmpty()||(r.Pu.forEach((a,u)=>{s.push(r.gu(u,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:(d=t?.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(l){i.push(l);let h=GI.Es(u.targetId,l);o.push(h)}}))}),yield Promise.all(s),r.hu.J_(i),yield(function(u,l){return x(this,null,function*(){let d=U(u);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>R.forEach(l,g=>R.forEach(g.Is,y=>d.persistence.referenceDelegate.addReference(h,g.targetId,y)).next(()=>R.forEach(g.ds,y=>d.persistence.referenceDelegate.removeReference(h,g.targetId,y)))))}catch(h){if(!Vi(h))throw h;k(oD,"Failed to update sequence numbers: "+h)}for(let h of l){let g=h.targetId;if(!h.fromCache){let y=d.Fs.get(g),I=y.snapshotVersion,b=y.withLastLimboFreeSnapshotVersion(I);d.Fs=d.Fs.insert(g,b)}}})})(r.localStore,o))})}function JH(n,e){return x(this,null,function*(){let t=U(n);if(!t.currentUser.isEqual(e)){k(Bi,"User change. New user:",e.toKey());let r=yield Bx(t.localStore,e);t.currentUser=e,(function(o,s){o.Vu.forEach(a=>{a.forEach(u=>{u.reject(new P(M.CANCELLED,s))})}),o.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Br(t,r.Bs)}})}function eq(n,e){let t=U(n),r=t.Eu.get(e);if(r&&r.lu)return ae().add(r.key);{let i=ae(),o=t.Tu.get(e);if(!o)return i;for(let s of o){let a=t.Pu.get(s);i=i.unionWith(a.view.tu)}return i}}function tq(n,e){return x(this,null,function*(){let t=U(n),r=yield Kp(t.localStore,e.query,!0),i=e.view.uu(r);return t.isPrimaryClient&&yw(t,e.targetId,i._u),i})}function nq(n,e){return x(this,null,function*(){let t=U(n);return qx(t.localStore,e).then(r=>Br(t,r))})}function rq(n,e,t,r){return x(this,null,function*(){let i=U(n),o=yield(function(a,u){let l=U(a),d=U(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Xn(h,u).next(g=>g?l.localDocuments.getDocuments(h,g):R.resolve(null)))})(i.localStore,e);o!==null?(t==="pending"?yield Wa(i.remoteStore):t==="acknowledged"||t==="rejected"?(pD(i,e,r||null),hD(i,e),(function(a,u){U(U(a).mutationQueue).rr(u)})(i.localStore,e)):H(6720,"Unknown batchState",{wu:t}),yield Br(i,o)):k(Bi,"Cannot apply mutation batch with id: "+e)})}function iq(n,e){return x(this,null,function*(){let t=U(n);if(bg(t),mD(t),e===!0&&t.fu!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield cN(t,r.toArray());t.fu=!0,yield aw(t.remoteStore,!0);for(let o of i)Tg(t.remoteStore,o)}else if(e===!1&&t.fu!==!1){let r=[],i=Promise.resolve();t.Tu.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(Ba(t,s),Va(t.localStore,s,!0))),La(t.remoteStore,s)}),yield i,yield cN(t,r),(function(s){let a=U(s);a.Eu.forEach((u,l)=>{La(a.remoteStore,l)}),a.Au.jr(),a.Eu=new Map,a.du=new Oe(B.comparator)})(t),t.fu=!1,yield aw(t.remoteStore,!1)}})}function cN(n,e,t){return x(this,null,function*(){let r=U(n),i=[],o=[];for(let s of e){let a,u=r.Tu.get(s);if(u&&u.length!==0){a=yield Fa(r.localStore,kt(u[0]));for(let l of u){let d=r.Pu.get(l),h=yield tq(r,d);h.snapshot&&o.push(h.snapshot)}}else{let l=yield Hx(r.localStore,s);a=yield Fa(r.localStore,l),yield fD(r,oP(l),s,!1,a.resumeToken)}i.push(a)}return r.hu.J_(o),i})}function oP(n){return ex(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function oq(n){return(function(t){return U(U(t).persistence).Ps()})(U(n).localStore)}function sq(n,e,t,r){return x(this,null,function*(){let i=U(n);if(i.fu)return void k(Bi,"Ignoring unexpected query state notification.");let o=i.Tu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield qx(i.localStore,nx(o[0])),a=Tl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ke.EMPTY_BYTE_STRING);yield Br(i,s,a);break}case"rejected":yield Va(i.localStore,e,!0),Ba(i,e,r);break;default:H(64155,t)}})}function aq(n,e,t){return x(this,null,function*(){let r=bg(n);if(r.fu){for(let i of e){if(r.Tu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k(Bi,"Adding an already active target "+i);continue}let o=yield Hx(r.localStore,i),s=yield Fa(r.localStore,o);yield fD(r,oP(o),s.targetId,!1,s.resumeToken),Tg(r.remoteStore,s)}for(let i of t)r.Tu.has(i)&&(yield Va(r.localStore,i,!1).then(()=>{La(r.remoteStore,i),Ba(r,i)}).catch(Fi))}})}function bg(n){let e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=rP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=eq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=KH.bind(null,e),e.hu.J_=UH.bind(null,e.eventManager),e.hu.pu=$H.bind(null,e.eventManager),e}function mD(n){let e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=YH.bind(null,e),e}function uq(n,e,t){let r=U(n);(function(o,s,a){return x(this,null,function*(){try{let u=yield s.getMetadata();if(yield(function(y,I){let b=U(y),S=We(I.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",O=>b.Ti.getBundleMetadata(O,I.id)).then(O=>!!O&&O.createTime.compareTo(S)>=0)})(o.localStore,u))return yield s.close(),a._completeWith((function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}})(u)),Promise.resolve(new Set);a._updateProgress(tP(u));let l=new hw(u,s.serializer),d=yield s.Su();for(;d;){let g=yield l.Wa(d);g&&a._updateProgress(g),d=yield s.Su()}let h=yield l.za(o.localStore);return yield Br(o,h.Ja,void 0),yield(function(y,I){let b=U(y);return b.persistence.runTransaction("Save bundle","readwrite",S=>b.Ti.saveBundleMetadata(S,I))})(o.localStore,u),a._completeWith(h.progress),Promise.resolve(h.ja)}catch(u){return Kt(Bi,`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var yD=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=Hl(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,r){return null}Fu(t,r){return null}vu(t){return jx(this.persistence,new Wp,t.initialUser,this.serializer)}Du(t){return new Nl(zp.Vi,this.serializer)}bu(t){return new Zp}terminate(){return x(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),vw=class extends yD{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){G(this.persistence.referenceDelegate instanceof Gp,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new $p(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?zt.withCacheSize(this.cacheSizeBytes):zt.DEFAULT;return new Nl(r=>Gp.Vi(r,t),this.serializer)}},ag=class n extends yD{constructor(e,t,r){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield cm(n.prototype,this,"initialize").call(this,e),yield this.Mu.initialize(this,e),yield mD(this.Mu.syncEngine),yield Wa(this.Mu.remoteStore),yield this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}vu(e){return jx(this.persistence,new Wp,e.initialUser,this.serializer)}Cu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new $p(r,e.asyncQueue,t)}Fu(e,t){let r=new qE(t,this.persistence);return new HE(e.asyncQueue,r)}Du(e){let t=iD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?zt.withCacheSize(this.cacheSizeBytes):zt.DEFAULT;return new zI(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Qx(),mp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Zp}},_w=class n extends ag{constructor(e,t){super(e,t,!1),this.Mu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield cm(n.prototype,this,"initialize").call(this,e);let t=this.Mu.syncEngine;this.sharedClientState instanceof dl&&(this.sharedClientState.syncEngine={Do:rq.bind(null,t),vo:sq.bind(null,t),Co:aq.bind(null,t),Ps:oq.bind(null,t),bo:nq.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.ji(r=>x(this,null,function*(){yield iq(this.Mu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}bu(e){let t=Qx();if(!dl.C(t))throw new P(M.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=iD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new dl(t,e.asyncQueue,r,e.clientId,e.initialUser)}},vD=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>uN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=JH.bind(null,this.syncEngine),yield aw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return(function(){return new lw})()}createDatastore(t){let r=Hl(t.databaseInfo.databaseId),i=(function(s){return new ew(s)})(t.databaseInfo);return(function(s,a,u,l){return new iw(s,a,u,l)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,s,a,u){return new sw(i,o,s,a,u)})(this.localStore,this.datastore,t.asyncQueue,r=>uN(this.syncEngine,r,0),(function(){return Xp.C()?new Xp:new YI})())}createSyncEngine(t,r){return(function(o,s,a,u,l,d,h){let g=new mw(o,s,a,u,l,d);return h&&(g.fu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){var t,r;yield(function(o){return x(this,null,function*(){let s=U(o);k(jo,"RemoteStore shutting down."),s.Ia.add(5),yield Ga(s),s.Ea.shutdown(),s.Aa.set("Unknown")})})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function lN(n,e=10240){let t=0;return{read(){return x(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Ua=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ze("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Ew=class{constructor(e,t){this.Nu=e,this.serializer=t,this.metadata=new rt,this.buffer=new Uint8Array,this.Bu=(function(){return new TextDecoder("utf-8")})(),this.Lu().then(r=>{r&&r.Qa()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))},r=>this.metadata.reject(r))}close(){return this.Nu.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}Su(){return x(this,null,function*(){return yield this.getMetadata(),this.Lu()})}Lu(){return x(this,null,function*(){let e=yield this.ku();if(e===null)return null;let t=this.Bu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);let i=yield this.Qu(r);return new fw(JSON.parse(i),e.length+r)})}$u(){return this.buffer.findIndex(e=>e===123)}ku(){return x(this,null,function*(){for(;this.$u()<0&&!(yield this.Uu()););if(this.buffer.length===0)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Qu(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.Uu())&&this.qu("Reached the end of bundle when more is expected.");let t=this.Bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}qu(e){throw this.Nu.cancel(),new Error(`Invalid bundle format: ${e}`)}Uu(){return x(this,null,function*(){let e=yield this.Nu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Iw=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(M.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield(function(i,o){return x(this,null,function*(){let s=U(i),a={documents:o.map(h=>Sl(s.serializer,h))},u=yield s.Jo("BatchGetDocuments",s.serializer.databaseId,pe.emptyPath(),a,o.length),l=new Map;u.forEach(h=>{let g=fH(s.serializer,h);l.set(g.key.toString(),g)});let d=[];return o.forEach(h=>{let g=l.get(h.toString());G(!!g,55234,{key:h}),d.push(g)}),d})})(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Pi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new wl(i,this.precondition(i)))}),yield(function(r,i){return x(this,null,function*(){let o=U(r),s={writes:i.map(a=>Al(o.serializer,a))};yield o.Wo("Commit",o.serializer.databaseId,pe.emptyPath(),s)})})(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw H(50498,{Wu:e.constructor.name});t=Q.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(M.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Q.min())?qe.exists(!1):qe.updateTime(t):qe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Q.min()))throw new P(M.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qe.updateTime(t)}return qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var ww=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.Gu=r.maxAttempts,this.F_=new Pl(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(()=>x(this,null,function*(){let e=new Iw(this.datastore),t=this.Ju(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Hu(i)}))}).catch(r=>{this.Hu(r)})}))}Ju(e){try{let t=this.updateFunction(e);return!Ll(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!gx(t)}return!1}};var ki="FirestoreClient",Dw=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Xe.UNAUTHENTICATED,this.clientId=fl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>x(this,null,function*(){k(ki,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k(ki,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new rt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Qa(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function xE(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k(ki,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(null,null,function*(){r.isEqual(i)||(yield Bx(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{Kt("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{k("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Kt("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function dN(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield _D(n);k(ki,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>oN(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>oN(e.remoteStore,i)),n._onlineComponents=e})}function _D(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k(ki,"Using user provided OfflineComponentProvider");try{yield xE(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===M.FAILED_PRECONDITION||i.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Kt("Error using user provided cache. Falling back to memory cache: "+t),yield xE(n,new yD)}}else k(ki,"Using default OfflineComponentProvider"),yield xE(n,new vw(void 0));return n._offlineComponents})}function Sg(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k(ki,"Using user provided OnlineComponentProvider"),yield dN(n,n._uninitializedComponentsProvider._online)):(k(ki,"Using default OnlineComponentProvider"),yield dN(n,new vD))),n._onlineComponents})}function sP(n){return _D(n).then(e=>e.persistence)}function ED(n){return _D(n).then(e=>e.localStore)}function aP(n){return Sg(n).then(e=>e.remoteStore)}function ID(n){return Sg(n).then(e=>e.syncEngine)}function cq(n){return Sg(n).then(e=>e.datastore)}function $a(n){return x(this,null,function*(){let e=yield Sg(n),t=e.eventManager;return t.onListen=HH.bind(null,e.syncEngine),t.onUnlisten=zH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=GH.bind(null,e.syncEngine),t})}function lq(n){return n.asyncQueue.enqueue(()=>x(null,null,function*(){let e=yield sP(n),t=yield aP(n);return e.setNetworkEnabled(!0),(function(i){let o=U(i);return o.Ia.delete(0),ql(o)})(t)}))}function dq(n){return n.asyncQueue.enqueue(()=>x(null,null,function*(){let e=yield sP(n),t=yield aP(n);return e.setNetworkEnabled(!1),(function(i){return x(this,null,function*(){let o=U(i);o.Ia.add(0),yield Ga(o),o.Aa.set("Offline")})})(t)}))}function fq(n,e){let t=new rt;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return(function(i,o,s){return x(this,null,function*(){try{let a=yield(function(l,d){let h=U(l);return h.persistence.runTransaction("read document","readonly",g=>h.localDocuments.getDocument(g,d))})(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(M.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=Qa(a,`Failed to get document '${o} from cache`);s.reject(u)}})})(yield ED(n),e,t)})),t.promise}function uP(n,e,t={}){let r=new rt;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return(function(o,s,a,u,l){let d=new Ua({next:g=>{d.Ou(),s.enqueueAndForget(()=>lD(o,h));let y=g.docs.has(a);!y&&g.fromCache?l.reject(new P(M.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&u&&u.source==="server"?l.reject(new P(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),h=new Ol(za(a.path),d,{includeMetadataChanges:!0,ka:!0});return cD(o,h)})(yield $a(n),n.asyncQueue,e,t,r)})),r.promise}function hq(n,e){let t=new rt;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return(function(i,o,s){return x(this,null,function*(){try{let a=yield Kp(i,o,!0),u=new sg(o,a.qs),l=u.nu(a.documents),d=u.applyChanges(l,!1);s.resolve(d.snapshot)}catch(a){let u=Qa(a,`Failed to execute query '${o} against cache`);s.reject(u)}})})(yield ED(n),e,t)})),t.promise}function cP(n,e,t={}){let r=new rt;return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return(function(o,s,a,u,l){let d=new Ua({next:g=>{d.Ou(),s.enqueueAndForget(()=>lD(o,h)),g.fromCache&&u.source==="server"?l.reject(new P(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),h=new Ol(a,d,{includeMetadataChanges:!0,ka:!0});return cD(o,h)})(yield $a(n),n.asyncQueue,e,t,r)})),r.promise}function pq(n,e){let t=new Ua(e);return n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return(function(i,o){U(i).Da.add(o),o.next()})(yield $a(n),t)})),()=>{t.Ou(),n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return(function(i,o){U(i).Da.delete(o)})(yield $a(n),t)}))}}function gq(n,e,t,r){let i=(function(s,a){let u;return u=typeof s=="string"?Bw().encode(s):s,(function(d,h){return new Ew(d,h)})((function(d,h){if(d instanceof Uint8Array)return lN(d,h);if(d instanceof ArrayBuffer)return lN(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(u),a)})(t,Hl(e));n.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){uq(yield ID(n),i,r)}))}function mq(n,e){return n.asyncQueue.enqueue(()=>x(null,null,function*(){return(function(r,i){let o=U(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Ti.getNamedQuery(s,i))})(yield ED(n),e)}))}function lP(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var fN=new Map;var dP="firestore.googleapis.com",hN=!0,ug=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dP,this.ssl=hN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:hN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<DH)throw new P(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$w("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(M.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Bo=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ug({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ug(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new PE;switch(r.type){case"firstParty":return new VE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=fN.get(t);r&&(k("ComponentProvider","Removing Datastore"),fN.delete(t),r.terminate())})(this),Promise.resolve()}};function fP(n,e,t,r={}){var i;n=me(n,Bo);let o=fm(e),s=n._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;o&&(KC(`https://${u}`),YC("Firestore",!0)),s.host!==dP&&s.host!==u&&Kt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=Object.assign(Object.assign({},s),{host:u,ssl:o,emulatorOptions:r});if(!fd(l,a)&&(n._setSettings(l),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=Xe.MOCK_USER;else{d=QC(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new P(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Xe(g)}n._authCredentials=new OE(new yp(d,h))}}var ht=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Te=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Vl(t,n._jsonSchema))return new n(e,r||null,new B(pe.fromString(t.referencePath)))}};Te._jsonSchemaVersion="firestore/documentReference/1.0",Te._jsonSchema={type:Je("string",Te._jsonSchemaVersion),referencePath:Je("string")};var rr=class n extends ht{constructor(e,t,r){super(e,t,za(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Te(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function wD(n,e,...t){if(n=je(n),Uw("collection","path",e),n instanceof Bo){let r=pe.fromString(e,...t);return aM(r),new rr(n,null,r)}{if(!(n instanceof Te||n instanceof rr))throw new P(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return aM(r),new rr(n.firestore,null,r)}}function hP(n,e){if(n=me(n,Bo),Uw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ht(n,null,(function(r){return new Nn(pe.emptyPath(),r)})(e))}function zl(n,e,...t){if(n=je(n),arguments.length===1&&(e=fl.newId()),Uw("doc","path",e),n instanceof Bo){let r=pe.fromString(e,...t);return sM(r),new Te(n,null,new B(r))}{if(!(n instanceof Te||n instanceof rr))throw new P(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(pe.fromString(e,...t));return sM(r),new Te(n.firestore,n instanceof rr?n.converter:null,new B(r))}}function DD(n,e){return n=je(n),e=je(e),(n instanceof Te||n instanceof rr)&&(e instanceof Te||e instanceof rr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function CD(n,e){return n=je(n),e=je(e),n instanceof ht&&e instanceof ht&&n.firestore===e.firestore&&Ul(n._query,e._query)&&n.converter===e.converter}var pN="AsyncQueue",cg=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Pl(this,"async_queue_retry"),this.oc=()=>{let r=mp();r&&k(pN,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=mp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=mp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new rt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return x(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Vi(e))throw e;k(pN,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ze("INTERNAL UNHANDLED ERROR: ",gN(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=uw.createAndSchedule(this,e,t,r,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&H(47125,{hc:gN(this.tc)})}verifyOperationInProgress(){}Pc(){return x(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function gN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Cw(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}var Tw=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new rt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var pP=-1,Ue=class extends Bo{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new cg,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new cg(e),this._firestoreClient=void 0,yield e}})}};function pt(n){if(n._terminated)throw new P(M.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||gP(n),n._firestoreClient}function gP(n){var e,t,r;let i=n._freezeSettings(),o=(function(a,u,l,d){return new KE(a,u,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,lP(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Dw(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(a){let u=a?._online.build();return{_offline:a?._offline.build(u),_online:u}})(n._componentsProvider))}function mP(n,e){Kt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return vP(n,vD.provider,{build:r=>new ag(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function yP(n){return x(this,null,function*(){Kt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();vP(n,vD.provider,{build:t=>new _w(t,e.cacheSizeBytes)})})}function vP(n,e,t){if((n=me(n,Ue))._firestoreClient||n._terminated)throw new P(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(M.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},gP(n)}function _P(n){if(n._initialized&&!n._terminated)throw new P(M.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new rt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>x(null,null,function*(){try{yield(function(r){return x(this,null,function*(){if(!bi.C())return Promise.resolve();let i=r+Lx;yield bi.delete(i)})})(iD(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function EP(n){return(function(t){let r=new rt;return t.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return ZH(yield ID(t),r)})),r.promise})(pt(n=me(n,Ue)))}function IP(n){return lq(pt(n=me(n,Ue)))}function wP(n){return dq(pt(n=me(n,Ue)))}function DP(n,e){let t=pt(n=me(n,Ue)),r=new Tw;return gq(t,n._databaseId,e,r),r}function CP(n,e){return mq(pt(n=me(n,Ue)),e).then(t=>t?new ht(n,null,t.query):null)}var dn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ke.fromBase64String(e))}catch(t){throw new P(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vl(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};dn._jsonSchemaVersion="firestore/bytes/1.0",dn._jsonSchema={type:Je("string",dn._jsonSchemaVersion),bytes:Je("string")};var On=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Lr=class{constructor(e){this._methodName=e}};var ir=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Vl(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};ir._jsonSchemaVersion="firestore/geoPoint/1.0",ir._jsonSchema={type:Je("string",ir._jsonSchemaVersion),latitude:Je("number"),longitude:Je("number")};var Di=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vl(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new P(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Di._jsonSchemaVersion="firestore/vectorValue/1.0",Di._jsonSchema={type:Je("string",Di._jsonSchemaVersion),vectorValues:Je("object")};var yq=/^__.*__$/,bw=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Pn(e,this.data,this.fieldMask,t,this.fieldTransforms):new xi(e,this.data,t,this.fieldTransforms)}},lg=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Pn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function TP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H(40011,{Ec:n})}}var dg=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return fg(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(TP(this.Ec)&&yq.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},Sw=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Hl(e)}Dc(e,t,r,i=!1){return new dg({Ec:e,methodName:t,bc:r,path:Ge.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ho(n){let e=n._freezeSettings(),t=Hl(n._databaseId);return new Sw(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ag(n,e,t,r,i,o={}){let s=n.Dc(o.merge||o.mergeFields?2:0,e,t,i);SD("Data must be an object, but it was:",s,r);let a=AP(r,s),u,l;if(o.merge)u=new ln(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let h of o.mergeFields){let g=xw(e,h,t);if(!s.contains(g))throw new P(M.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);MP(d,g)||d.push(g)}u=new ln(d),l=s.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,l=s.fieldTransforms;return new bw(new At(a),u,l)}var kl=class n extends Lr{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function bP(n,e,t){return new dg({Ec:3,bc:e.settings.bc,methodName:n._methodName,mc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Aw=class n extends Lr{_toFieldTransform(e){return new Fo(e.path,new Mi)}isEqual(e){return e instanceof n}},Rw=class n extends Lr{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){let t=bP(this,e,!0),r=this.vc.map(o=>qo(o,t)),i=new Fr(r);return new Fo(e.path,i)}isEqual(e){return e instanceof n&&fd(this.vc,e.vc)}},Mw=class n extends Lr{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){let t=bP(this,e,!0),r=this.vc.map(o=>qo(o,t)),i=new Vr(r);return new Fo(e.path,i)}isEqual(e){return e instanceof n&&fd(this.vc,e.vc)}},Nw=class n extends Lr{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){let t=new Ni(e.serializer,ux(e.serializer,this.Cc));return new Fo(e.path,t)}isEqual(e){return e instanceof n&&this.Cc===e.Cc}};function TD(n,e,t,r){let i=n.Dc(1,e,t);SD("Data must be an object, but it was:",i,r);let o=[],s=At.empty();Li(r,(u,l)=>{let d=AD(e,u,t);l=je(l);let h=i.gc(d);if(l instanceof kl)o.push(d);else{let g=qo(l,h);g!=null&&(o.push(d),s.set(d,g))}});let a=new ln(o);return new lg(s,a,i.fieldTransforms)}function bD(n,e,t,r,i,o){let s=n.Dc(1,e,t),a=[xw(e,r,t)],u=[i];if(o.length%2!=0)throw new P(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(xw(e,o[g])),u.push(o[g+1]);let l=[],d=At.empty();for(let g=a.length-1;g>=0;--g)if(!MP(l,a[g])){let y=a[g],I=u[g];I=je(I);let b=s.gc(y);if(I instanceof kl)l.push(y);else{let S=qo(I,b);S!=null&&(l.push(y),d.set(y,S))}}let h=new ln(l);return new lg(d,h,s.fieldTransforms)}function SP(n,e,t,r=!1){return qo(t,n.Dc(r?4:3,e))}function qo(n,e){if(RP(n=je(n)))return SD("Unsupported field value:",e,n),AP(n,e);if(n instanceof Lr)return(function(r,i){if(!TP(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let o=[],s=0;for(let a of r){let u=qo(a,i.yc(s));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),s++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=je(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ux(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Me.fromDate(r);return{timestampValue:Pa(i.serializer,o)}}if(r instanceof Me){let o=new Me(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Pa(i.serializer,o)}}if(r instanceof ir)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dn)return{bytesValue:yx(i.serializer,r._byteString)};if(r instanceof Te){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.wc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:tD(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Di)return(function(s,a){return{mapValue:{fields:{[Qw]:{stringValue:Yw},[Aa]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw a.wc("VectorValues must only contain numeric values.");return eD(a.serializer,l)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${vg(r)}`)})(n,e)}function AP(n,e){let t={};return jN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,(r,i)=>{let o=qo(i,e.Vc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function RP(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Me||n instanceof ir||n instanceof dn||n instanceof Te||n instanceof Lr||n instanceof Di)}function SD(n,e,t){if(!RP(t)||!wN(t)){let r=vg(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function xw(n,e,t){if((e=je(e))instanceof On)return e._internalPath;if(typeof e=="string")return AD(n,e);throw fg("Field path arguments must be of type string or ",n,!1,void 0,t)}var vq=new RegExp("[~\\*/\\[\\]]");function AD(n,e,t){if(e.search(vq)>=0)throw fg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new On(...e.split("."))._internalPath}catch{throw fg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fg(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(o||s)&&(u+=" (found",o&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new P(M.INVALID_ARGUMENT,a+n+u)}function MP(n,e){return n.some(t=>t.isEqual(e))}var Uo=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Te(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Pw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Rg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Pw=class extends Uo{data(){return super.data()}};function Rg(n,e){return typeof e=="string"?AD(n,e):e instanceof On?e._internalPath:e._delegate._internalPath}function NP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Fl=class{},$o=class extends Fl{};function Ur(n,e,...t){let r=[];e instanceof Fl&&r.push(e),r=r.concat(t),(function(o){let s=o.filter(u=>u instanceof Ow).length,a=o.filter(u=>u instanceof hg).length;if(s>1||s>0&&a>0)throw new P(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var hg=class n extends $o{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return UP(e._query,t),new ht(e.firestore,e.converter,uI(e._query,t))}_parse(e){let t=Ho(e.firestore);return(function(o,s,a,u,l,d,h){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new P(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){yN(h,d);let I=[];for(let b of h)I.push(mN(u,o,b));g={arrayValue:{values:I}}}else g=mN(u,o,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||yN(h,d),g=SP(a,s,h,d==="in"||d==="not-in");return fe.create(l,d,g)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function xP(n,e,t){let r=e,i=Rg("where",n);return hg._create(i,r,t)}var Ow=class n extends Fl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ce.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let s=i,a=o.getFlattenedFilters();for(let u of a)UP(s,u),s=uI(s,u)})(e._query,t),new ht(e.firestore,e.converter,uI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var kw=class n extends $o{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,o,s){if(i.startAt!==null)throw new P(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oo(o,s)})(e._query,this._field,this._direction);return new ht(e.firestore,e.converter,(function(i,o){let s=i.explicitOrderBy.concat([o]);return new Nn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function PP(n,e="asc"){let t=e,r=Rg("orderBy",n);return kw._create(r,t)}var pg=class n extends $o{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new ht(e.firestore,e.converter,Np(e._query,this._limit,this._limitType))}};function OP(n){return DN("limit",n),pg._create("limit",n,"F")}function kP(n){return DN("limitToLast",n),pg._create("limitToLast",n,"L")}var gg=class n extends $o{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=BP(e,this.type,this._docOrFields,this._inclusive);return new ht(e.firestore,e.converter,(function(i,o){return new Nn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)})(e._query,t))}};function FP(...n){return gg._create("startAt",n,!0)}function VP(...n){return gg._create("startAfter",n,!1)}var mg=class n extends $o{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=BP(e,this.type,this._docOrFields,this._inclusive);return new ht(e.firestore,e.converter,(function(i,o){return new Nn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)})(e._query,t))}};function LP(...n){return mg._create("endBefore",n,!1)}function jP(...n){return mg._create("endAt",n,!0)}function BP(n,e,t,r){if(t[0]=je(t[0]),t[0]instanceof Uo)return(function(o,s,a,u,l){if(!u)throw new P(M.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of _a(o))if(h.field.isKeyField())d.push(Po(s,u.key));else{let g=u.data.field(h.field);if(wg(g))throw new P(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=h.field.canonicalString();throw new P(M.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new sr(d,l)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Ho(n.firestore);return(function(s,a,u,l,d,h){let g=s.explicitOrderBy;if(d.length>g.length)throw new P(M.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let I=0;I<d.length;I++){let b=d[I];if(g[I].field.isKeyField()){if(typeof b!="string")throw new P(M.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof b}`);if(!Xw(s)&&b.indexOf("/")!==-1)throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${b}' contains a slash.`);let S=s.path.child(pe.fromString(b));if(!B.isDocumentKey(S))throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let O=new B(S);y.push(Po(a,O))}else{let S=SP(u,l,b);y.push(S)}}return new sr(y,h)})(n._query,n.firestore._databaseId,i,e,t,r)}}function mN(n,e,t){if(typeof(t=je(t))=="string"){if(t==="")throw new P(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xw(e)&&t.indexOf("/")!==-1)throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(pe.fromString(t));if(!B.isDocumentKey(r))throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Po(n,new B(r))}if(t instanceof Te)return Po(n,t._key);throw new P(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vg(t)}.`)}function yN(n,e){if(!Array.isArray(n)||n.length===0)throw new P(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function UP(n,e){let t=(function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new P(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Ha=class{convertValue(e,t="none"){switch(Ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Li(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Aa].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Le(s.doubleValue));return new Di(o)}convertGeoPoint(e){return new ir(Le(e.latitude),Le(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Dg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(_l(e));default:return null}}convertTimestamp(e){let t=Or(e);return new Me(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=pe.fromString(e);G(Ax(r),9688,{name:e});let i=new Si(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||ze(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Mg(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Fw=class extends Ha{constructor(e){super(),this.firestore=e}convertBytes(e){return new dn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Te(this.firestore,null,t)}};var Pr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ft=class n extends Uo{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ci(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Rg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new P(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ft._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ft._jsonSchema={type:Je("string",Ft._jsonSchemaVersion),bundleSource:Je("string","DocumentSnapshot"),bundleName:Je("string"),bundle:Je("string")};var Ci=class extends Ft{data(e={}){return super.data(e)}},Wt=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Pr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ci(this._firestore,this._userDataWriter,r.key,r,new Pr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let u=new Ci(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Pr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let u=new Ci(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Pr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:_q(a.type),doc:u,oldIndex:l,newIndex:d}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new P(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=fl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function _q(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H(61501,{type:n})}}function RD(n,e){return n instanceof Ft&&e instanceof Ft?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Wt&&e instanceof Wt&&n._firestore===e._firestore&&CD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function $P(n){n=me(n,Te);let e=me(n.firestore,Ue);return uP(pt(e),n._key).then(t=>PD(e,n,t))}Wt._jsonSchemaVersion="firestore/querySnapshot/1.0",Wt._jsonSchema={type:Je("string",Wt._jsonSchemaVersion),bundleSource:Je("string","QuerySnapshot"),bundleName:Je("string"),bundle:Je("string")};var jr=class extends Ha{constructor(e){super(),this.firestore=e}convertBytes(e){return new dn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Te(this.firestore,null,t)}};function HP(n){n=me(n,Te);let e=me(n.firestore,Ue),t=pt(e),r=new jr(e);return fq(t,n._key).then(i=>new Ft(e,r,n._key,i,new Pr(i!==null&&i.hasLocalMutations,!0),n.converter))}function qP(n){n=me(n,Te);let e=me(n.firestore,Ue);return uP(pt(e),n._key,{source:"server"}).then(t=>PD(e,n,t))}function zP(n){n=me(n,ht);let e=me(n.firestore,Ue),t=pt(e),r=new jr(e);return NP(n._query),cP(t,n._query).then(i=>new Wt(e,r,n,i))}function GP(n){n=me(n,ht);let e=me(n.firestore,Ue),t=pt(e),r=new jr(e);return hq(t,n._query).then(i=>new Wt(e,r,n,i))}function WP(n){n=me(n,ht);let e=me(n.firestore,Ue),t=pt(e),r=new jr(e);return cP(t,n._query,{source:"server"}).then(i=>new Wt(e,r,n,i))}function MD(n,e,t){n=me(n,Te);let r=me(n.firestore,Ue),i=Mg(n.converter,e,t);return Ya(r,[Ag(Ho(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,qe.none())])}function ND(n,e,t,...r){n=me(n,Te);let i=me(n.firestore,Ue),o=Ho(i),s;return s=typeof(e=je(e))=="string"||e instanceof On?bD(o,"updateDoc",n._key,e,t,r):TD(o,"updateDoc",n._key,e),Ya(i,[s.toMutation(n._key,qe.exists(!0))])}function KP(n){return Ya(me(n.firestore,Ue),[new Pi(n._key,qe.none())])}function QP(n,e){let t=me(n.firestore,Ue),r=zl(n),i=Mg(n.converter,e);return Ya(t,[Ag(Ho(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,qe.exists(!1))]).then(()=>r)}function xD(n,...e){var t,r,i;n=je(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Cw(e[s])||(o=e[s++]);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Cw(e[s])){let h=e[s];e[s]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[s+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[s+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let u,l,d;if(n instanceof Te)l=me(n.firestore,Ue),d=za(n._key.path),u={next:h=>{e[s]&&e[s](PD(l,n,h))},error:e[s+1],complete:e[s+2]};else{let h=me(n,ht);l=me(h.firestore,Ue),d=h._query;let g=new jr(l);u={next:y=>{e[s]&&e[s](new Wt(l,g,h,y))},error:e[s+1],complete:e[s+2]},NP(n._query)}return(function(g,y,I,b){let S=new Ua(b),O=new Ol(y,S,I);return g.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return cD(yield $a(g),O)})),()=>{S.Ou(),g.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return lD(yield $a(g),O)}))}})(pt(l),d,a,u)}function YP(n,e){return pq(pt(n=me(n,Ue)),Cw(e)?e:{next:e})}function Ya(n,e){return(function(r,i){let o=new rt;return r.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){return WH(yield ID(r),i,o)})),o.promise})(pt(n),e)}function PD(n,e,t){let r=t.docs.get(e._key),i=new jr(n);return new Ft(n,i,e._key,r,new Pr(t.hasPendingWrites,t.fromCache),e.converter)}var Eq={maxAttempts:5};var yg=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ho(e)}set(e,t,r){this._verifyNotCommitted();let i=Ii(e,this._firestore),o=Mg(i.converter,t,r),s=Ag(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,qe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Ii(e,this._firestore),s;return s=typeof(t=je(t))=="string"||t instanceof On?bD(this._dataReader,"WriteBatch.update",o._key,t,r,i):TD(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Ii(e,this._firestore);return this._mutations=this._mutations.concat(new Pi(t._key,qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ii(n,e){if((n=je(n)).firestore!==e)throw new P(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Vw=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ho(e)}get(e){let t=Ii(e,this._firestore),r=new Fw(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return H(24041);let o=i[0];if(o.isFoundDocument())return new Uo(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new Uo(this._firestore,r,t._key,null,t.converter);throw H(18433,{doc:o})})}set(e,t,r){let i=Ii(e,this._firestore),o=Mg(i.converter,t,r),s=Ag(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,s),this}update(e,t,r,...i){let o=Ii(e,this._firestore),s;return s=typeof(t=je(t))=="string"||t instanceof On?bD(this._dataReader,"Transaction.update",o._key,t,r,i):TD(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,s),this}delete(e){let t=Ii(e,this._firestore);return this._transaction.delete(t._key),this}};var Lw=class extends Vw{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Ii(e,this._firestore),r=new jr(this._firestore);return super.get(e).then(i=>new Ft(this._firestore,r,t._key,i._document,new Pr(!1,!1),t.converter))}};function ZP(n,e,t){n=me(n,Ue);let r=Object.assign(Object.assign({},Eq),t);return(function(o){if(o.maxAttempts<1)throw new P(M.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(o,s,a){let u=new rt;return o.asyncQueue.enqueueAndForget(()=>x(null,null,function*(){let l=yield cq(o);new ww(o.asyncQueue,l,a,s,u).zu()})),u.promise})(pt(n),i=>e(new Lw(n,i)),r)}function XP(){return new kl("deleteField")}function JP(){return new Aw("serverTimestamp")}function eO(...n){return new Rw("arrayUnion",n)}function tO(...n){return new Mw("arrayRemove",n)}function nO(n){return new Nw("increment",n)}(function(e,t=!0){(function(i){qa=i})(eT),Eu(new zi("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new Ue(new kE(r.getProvider("auth-internal")),new LE(s,r.getProvider("app-check-internal")),(function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Si(l.options.projectId,d)})(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Gr(nM,rM,e),Gr(nM,rM,"esm2017")})();var Iq="@firebase/firestore-compat",wq="0.3.53";function jD(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function rO(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function iO(){if(!BN())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Ng=class n{constructor(e){this._delegate=e}static fromBase64String(e){return iO(),new n(dn.fromBase64String(e))}static fromUint8Array(e){return rO(),new n(dn.fromUint8Array(e))}toBase64(){return iO(),this._delegate.toBase64()}toUint8Array(){return rO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function OD(n){return Dq(n,["next","error","complete"])}function Dq(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var kD=class{enableIndexedDbPersistence(e,t){return mP(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return yP(e._delegate)}clearIndexedDbPersistence(e){return _P(e._delegate)}},xg=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Si||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Kt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){fP(this._delegate,e,t,r)}enableNetwork(){return IP(this._delegate)}disableNetwork(){return wP(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,$w("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return EP(this._delegate)}onSnapshotsInSync(e){return YP(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ja(this,wD(this._delegate,e))}catch(t){throw Vt(t,"collection()","Firestore.collection()")}}doc(e){try{return new ar(this,zl(this._delegate,e))}catch(t){throw Vt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ko(this,hP(this._delegate,e))}catch(t){throw Vt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return ZP(this._delegate,t=>e(new Pg(this,t)))}batch(){return pt(this._delegate),new Og(new yg(this._delegate,e=>Ya(this._delegate,e)))}loadBundle(e){return DP(this._delegate,e)}namedQuery(e){return CP(this._delegate,e).then(t=>t?new Ko(this,t):null)}},Za=class extends Ha{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ng(new dn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return ar.forKey(t,this.firestore,null)}};function Cq(n){vN(n)}var Pg=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Za(e)}get(e){let t=zo(e);return this._delegate.get(t).then(r=>new Go(this._firestore,new Ft(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=zo(e);return r?(jD("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=zo(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=zo(e);return this._delegate.delete(t),this}},Og=class{constructor(e){this._delegate=e}set(e,t,r){let i=zo(e);return r?(jD("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=zo(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=zo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Xa=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Ci(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Wo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new Za(e),t),i.set(t,o)),o}};Xa.INSTANCES=new WeakMap;var ar=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Za(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Te(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new Te(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ja(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ja(this.firestore,wD(this._delegate,e))}catch(t){throw Vt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=je(e),e instanceof Te?DD(this._delegate,e):!1}set(e,t){t=jD("DocumentReference.set",t);try{return t?MD(this._delegate,e,t):MD(this._delegate,e)}catch(r){throw Vt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?ND(this._delegate,e):ND(this._delegate,e,t,...r)}catch(i){throw Vt(i,"updateDoc()","DocumentReference.update()")}}delete(){return KP(this._delegate)}onSnapshot(...e){let t=oO(e),r=sO(e,i=>new Go(this.firestore,new Ft(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return xD(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=HP(this._delegate):e?.source==="server"?t=qP(this._delegate):t=$P(this._delegate),t.then(r=>new Go(this.firestore,new Ft(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Xa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Vt(n,e,t){return n.message=n.message.replace(e,t),n}function oO(n){for(let e of n)if(typeof e=="object"&&!OD(e))return e;return{}}function sO(n,e){var t,r;let i;return OD(n[0])?i=n[0]:OD(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Go=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ar(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return RD(this._delegate,e._delegate)}},Wo=class extends Go{data(e){let t=this._delegate.data(e);return this._delegate._converter||EN(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Ko=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Za(e)}where(e,t,r){try{return new n(this.firestore,Ur(this._delegate,xP(e,t,r)))}catch(i){throw Vt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Ur(this._delegate,PP(e,t)))}catch(r){throw Vt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Ur(this._delegate,OP(e)))}catch(t){throw Vt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Ur(this._delegate,kP(e)))}catch(t){throw Vt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Ur(this._delegate,FP(...e)))}catch(t){throw Vt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Ur(this._delegate,VP(...e)))}catch(t){throw Vt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Ur(this._delegate,LP(...e)))}catch(t){throw Vt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Ur(this._delegate,jP(...e)))}catch(t){throw Vt(t,"endAt()","Query.endAt()")}}isEqual(e){return CD(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=GP(this._delegate):e?.source==="server"?t=WP(this._delegate):t=zP(this._delegate),t.then(r=>new Gl(this.firestore,new Wt(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=oO(e),r=sO(e,i=>new Gl(this.firestore,new Wt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return xD(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Xa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},FD=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Wo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Gl=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ko(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Wo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new FD(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Wo(this._firestore,r))})}isEqual(e){return RD(this._delegate,e._delegate)}},Ja=class n extends Ko{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new ar(this.firestore,e):null}doc(e){try{return e===void 0?new ar(this.firestore,zl(this._delegate)):new ar(this.firestore,zl(this._delegate,e))}catch(t){throw Vt(t,"doc()","CollectionReference.doc()")}}add(e){return QP(this._delegate,e).then(t=>new ar(this.firestore,t))}isEqual(e){return DD(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Xa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function zo(n){return me(n,Te)}var VD=class n{constructor(...e){this._delegate=new On(...e)}static documentId(){return new n(Ge.keyField().canonicalString())}isEqual(e){return e=je(e),e instanceof On?this._delegate._internalPath.isEqual(e._internalPath):!1}};var LD=class n{static serverTimestamp(){let e=JP();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=XP();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=eO(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=tO(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=nO(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Tq={Firestore:xg,GeoPoint:ir,Timestamp:Me,Blob:Ng,Transaction:Pg,WriteBatch:Og,DocumentReference:ar,DocumentSnapshot:Go,Query:Ko,QueryDocumentSnapshot:Wo,QuerySnapshot:Gl,CollectionReference:Ja,FieldPath:VD,FieldValue:LD,setLogLevel:Cq,CACHE_SIZE_UNLIMITED:pP};function bq(n,e){n.INTERNAL.registerComponent(new zi("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Tq)))}function Sq(n){bq(n,(e,t)=>new xg(e,t,new kD)),n.registerVersion(Iq,wq)}Sq(Fn);function Aq(n,e=Ru){return new ie(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function aO(n,e){return Aq(n,e)}function Rq(n,e){return aO(n,e).pipe(Yi(void 0),xu(),X(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function $D(n,e){return aO(n,e).pipe(X(t=>({payload:t,type:"query"})))}var kg=class{ref;afs;injector=F(Fe);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=lO(r,t);return new Vg(i,o,this.afs)}snapshotChanges(){return Rq(this.ref,this.afs.schedulers.outsideAngular).pipe(qt(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(X(({payload:t})=>e.idField?ce(j({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return ve(this.ref.get(e)).pipe(qt(this.injector))}};function Fg(n,e){return $D(n,e).pipe(Yi(void 0),xu(),X(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let l=o.find(h=>h.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(h=>h.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),s}))}function uO(n,e,t){return Fg(n,t).pipe(Qi((r,i)=>Mq(r,i.map(o=>o.payload),e),[]),Vm(),X(r=>r.map(i=>({type:i.type,payload:i}))))}function Mq(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=Nq(n,r))}),n}function BD(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function Nq(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return BD(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return BD(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return BD(n,e.oldIndex,1);break}return n}function cO(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Vg=class{ref;query;afs;injector=F(Fe);constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Fg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(X(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Yi(void 0),xu(),ct(([r,i])=>i.length>0||!r),X(([,r])=>r),qt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Qi((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=cO(e);return uO(this.query,t,this.afs.schedulers.outsideAngular).pipe(qt(this.injector))}valueChanges(e={}){return $D(this.query,this.afs.schedulers.outsideAngular).pipe(X(t=>t.payload.docs.map(r=>e.idField?ce(j({},r.data()),{[e.idField]:r.id}):r.data())),qt(this.injector))}get(e){return ve(this.query.get(e)).pipe(qt(this.injector))}add(e){return this.ref.add(e)}doc(e){return new kg(this.ref.doc(e),this.afs)}},UD=class{query;afs;injector=F(Fe);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Fg(this.query,this.afs.schedulers.outsideAngular).pipe(qt(this.injector)):Fg(this.query,this.afs.schedulers.outsideAngular).pipe(X(t=>t.filter(r=>e.indexOf(r.type)>-1)),ct(t=>t.length>0),qt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Qi((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=cO(e);return uO(this.query,t,this.afs.schedulers.outsideAngular).pipe(qt(this.injector))}valueChanges(e={}){return $D(this.query,this.afs.schedulers.outsideAngular).pipe(X(r=>r.payload.docs.map(i=>e.idField?j({[e.idField]:i.id},i.data()):i.data())),qt(this.injector))}get(e){return ve(this.query.get(e)).pipe(qt(this.injector))}},xq=new z("angularfire2.enableFirestorePersistence"),Pq=new z("angularfire2.firestore.persistenceSettings"),Oq=new z("angularfire2.firestore.settings"),kq=new z("angularfire2.firestore.use-emulator");function lO(n,e=t=>t){return{query:e(n),ref:n}}var dO=(()=>{class n{schedulers;firestore;persistenceEnabled$;ngZone=F(be);constructor(t,r,i,o,s,a,u,l,d,h,g,y,I,b,S,O,q){this.schedulers=u;let V=ep(t,a,r),Y=d;h&&_E(V,a,g,I,b,S,y,O),[this.firestore,this.persistenceEnabled$]=tp(`${V.name}.firestore`,"AngularFirestore",V.name,()=>{let ee=a.runOutsideAngular(()=>V.firestore());if(o&&ee.settings(o),Y&&ee.useEmulator(...Y),i&&!lh(s)){let te=()=>{try{return ve(ee.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(w){return typeof console<"u"&&console.warn(w),Z(!1)}};return[ee,a.runOutsideAngular(te)]}else return[ee,Z(!1)]},[o,Y,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=lO(i,r),a=this.ngZone.run(()=>o);return new Vg(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new UD(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.ngZone.run(()=>r);return new kg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)($(Xh),$(Jh,8),$(xq,8),$(Oq,8),$(bn),$(be),$(Kc),$(Pq,8),$(kq,8),$(JR,8),$(hE,8),$(pE,8),$(gE,8),$(mE,8),$(yE,8),$(vE,8),$(ia,8))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var fO=(()=>{class n{firestore;constructor(t){this.firestore=t}getEvents(){return this.firestore.collection("local_events").valueChanges({idField:"id"})}static \u0275fac=function(r){return new(r||n)($(dO))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Lq(n,e){if(n&1&&(Re(0,"option"),Ht(1),Ve()),n&2){let t=e.$implicit;Qe(),br(t)}}function jq(n,e){if(n&1&&(Re(0,"option"),Ht(1),Ve()),n&2){let t=e.$implicit;Qe(),br(t)}}function Bq(n,e){if(n&1&&gn(0,"app-event-card",7),n&2){let t=e.$implicit;rn("event",t)}}var hO=(()=>{class n{eventService;events=[];categories=[];cities=[];selectedCategory="";selectedCity="";constructor(t){this.eventService=t}ngOnInit(){this.eventService.getEvents().pipe(X(t=>t.sort((r,i)=>r.data.localeCompare(i.data)))).subscribe(t=>{this.events=t,this.categories=Array.from(new Set(t.flatMap(r=>r.categoria))),this.cities=Array.from(new Set(t.map(r=>r.citta)))})}filteredEvents(){let t=this.events;return this.selectedCategory&&(t=t.filter(r=>r.categoria.includes(this.selectedCategory))),this.selectedCity&&(t=t.filter(r=>r.citta===this.selectedCity)),t}static \u0275fac=function(r){return new(r||n)(_e(fO))};static \u0275cmp=nn({type:n,selectors:[["app-event-list"]],decls:11,vars:5,consts:()=>{let t;t=$localize`Categoria`;let r;return r=$localize`Citt`,[t,r,[1,"flex","flex-wrap","gap-4","mb-4"],[1,"p-2","rounded","border",3,"ngModelChange","ngModel"],["value",""],[4,"ngFor","ngForOf"],[3,"event",4,"ngFor","ngForOf"],[3,"event"]]},template:function(r,i){r&1&&(Re(0,"div",2)(1,"select",3),hc("ngModelChange",function(s){return oh(i.selectedCategory,s)||(i.selectedCategory=s),s}),Re(2,"option",4),on(3,0),Ve(),ci(4,Lq,2,1,"option",5),Ve(),Re(5,"select",3),hc("ngModelChange",function(s){return oh(i.selectedCity,s)||(i.selectedCity=s),s}),Re(6,"option",4),on(7,1),Ve(),ci(8,jq,2,1,"option",5),Ve()(),Re(9,"div"),ci(10,Bq,1,1,"app-event-card",6),Ve()),r&2&&(Qe(),fc("ngModel",i.selectedCategory),Qe(3),rn("ngForOf",i.categories),Qe(),fc("ngModel",i.selectedCity),Qe(3),rn("ngForOf",i.cities),Qe(2),rn("ngForOf",i.filteredEvents()))},dependencies:[fi,Hs,Qh,OR,FR,Kh,MR,iE,VR],encapsulation:2})}return n})();var pO=[{path:"",component:fR},{path:"list",component:hO},{path:"**",redirectTo:""}];var gO={production:!0};gO.production&&void 0;b_(dR,{providers:[Y_(pO)]});
